<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>넥슨 매출액 추적</title>
    <script src="https://code.highcharts.com/stock/highstock.js"></script>
    <script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/highcharts-more.js"></script>
    <script src="https://code.highcharts.com/modules/heatmap.js"></script>
    <style>
        :root {
            --claude-orange: #E57B53;
            --bg-dark: #1a1a1a;
            --bg-medium: #252525;
            --bg-light: #2d2d2d;
            --bg-hover: #3a3a3a;
            --border-color: #3a3a3a;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --text-muted: #888888;
            --text-dim: #666666;
        }

        [data-theme="light"] {
            --bg-dark: #ffffff;
            --bg-medium: #f5f5f5;
            --bg-light: #ebebeb;
            --bg-hover: #d8d8d8;
            --border-color: #d0d0d0;
            --text-primary: #1a1a1a;
            --text-secondary: #333333;
            --text-muted: #666666;
            --text-dim: #999999;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-weight: 300;
            line-height: 1.3;
            height: 100vh;
            overflow: hidden;
            background: var(--bg-dark);
            color: var(--text-secondary);
        }

        .container {
            display: flex;
            height: 100vh;
        }

        /* 아이콘 사이드바 */
        .icon-sidebar {
            width: 48px;
            min-width: 48px;
            background: var(--bg-dark);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px 0;
        }

        .icon-sidebar-item {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 4px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.15s;
            color: var(--text-muted);
        }

        .icon-sidebar-item:hover {
            background: rgba(229, 123, 83, 0.15);
            color: var(--claude-orange);
        }

        .icon-sidebar-item.active {
            background: rgba(229, 123, 83, 0.2);
            color: var(--claude-orange);
        }

        .icon-sidebar-item svg {
            width: 20px;
            height: 20px;
        }

        .icon-sidebar-spacer {
            flex: 1;
        }

        /* 중앙 패널 */
        .center-panel {
            flex: 1;
            min-width: 0;  /* flex 아이템 축소 허용 */
            background: var(--bg-dark);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chart-header {
            padding: 16px 8px 0;
        }

        .search-title-container {
            position: relative;
        }

        .chart-search-input {
            width: 450px;
            padding: 12px 16px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 15px;
            outline: none;
            background: var(--bg-medium);
            color: var(--text-primary);
        }

        .chart-search-input::placeholder {
            color: var(--text-dim);
        }

        .chart-search-input:focus {
            border-color: var(--claude-orange);
        }

        .chart-title {
            font-size: 20px;
            font-weight: 500;
            color: var(--text-primary);
            margin: 0;
            margin-left: 16px;
            padding: 8px 0;
            display: none;
            cursor: pointer;
        }

        .chart-title:hover {
            color: var(--claude-orange);
        }

        .chart-container {
            height: 55vh;
            min-height: 500px;
            padding: 8px;
            flex-shrink: 0;
        }

        #stockChart {
            width: 100%;
            height: 100%;
        }

        .table-container {
            flex: 1;
            min-width: 0;  /* flex 아이템 축소 허용 */
            width: 100%;   /* 부모 너비에 맞춤 */
            overflow-x: auto;
            overflow-y: auto;
            padding: 8px;
            min-height: 500px;
        }

        .data-table {
            width: 100%;
            min-width: max-content;
            border-collapse: collapse;
            font-size: 12px;
        }

        .data-table th,
        .data-table td {
            border: 1px solid var(--border-color);
            padding: 6px 8px;
            text-align: center;
            white-space: nowrap;
            min-width: 45px;
            box-sizing: border-box;
        }

        .data-table th {
            background: var(--bg-medium);
            font-weight: 300;
            color: var(--text-muted);
            position: sticky;
            top: 0;
        }

        .data-table th.period-header {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .data-table th.period-header:hover {
            background: var(--bg-hover);
            color: var(--claude-orange);
        }

        .data-table th:first-child {
            text-align: left;
            width: 80px;
        }

        .data-table td:first-child {
            text-align: left;
            font-weight: 400;
            color: var(--text-muted);
        }

        .data-table td.source-name {
            cursor: pointer;
            color: var(--text-secondary);
        }

        .data-table td.source-name:hover {
            text-decoration: underline;
            color: var(--claude-orange);
        }

        .source-detail-container {
            padding: 16px;
            background: var(--bg-medium);
            margin-top: 10px;
            border-radius: 4px;
            display: none;
        }

        .source-detail-container.active {
            display: block;
        }

        .source-detail h4 {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 12px;
        }

        .source-detail ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .source-detail li {
            padding: 6px 0;
            padding-left: 16px;
            position: relative;
            font-size: 13px;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-color);
        }

        .source-detail li:last-child {
            border-bottom: none;
        }

        .source-detail li::before {
            content: '•';
            position: absolute;
            left: 0;
            color: var(--text-muted);
        }

        .source-item {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 6px 0;
            padding-left: 0;
            position: relative;
        }

        .source-item:hover {
            color: var(--claude-orange);
        }

        .source-item::before {
            display: none;
        }

        .source-item-date {
            flex-shrink: 0;
            width: 40px;
            font-size: 11px;
            color: var(--text-muted);
        }

        .source-item-title {
            flex: 1;
            max-width: calc(75% - 40px);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .source-item-revenue {
            position: absolute;
            left: 80%;
            font-size: 10px;
            color: var(--text-secondary);
            max-width: 18%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .data-table td.has-data {
            cursor: pointer;
            color: var(--claude-orange);
            font-weight: 400;
            text-align: center;
            padding: 4px 8px;
        }

        .data-table td.has-data:hover {
            background: rgba(229, 123, 83, 0.1);
        }

        .cell-preview {
            font-size: 10px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100px;
            display: inline-block;
            vertical-align: middle;
        }

        .cell-badge {
            background: var(--claude-orange);
            color: white;
            font-size: 9px;
            padding: 1px 4px;
            border-radius: 8px;
            margin-left: 4px;
            vertical-align: middle;
        }

        /* 테이블 헤더 - 기간 선택 버튼 */
        .period-selector {
            display: inline-flex;
            gap: 2px;
        }

        .period-btn {
            width: 28px;
            height: 24px;
            border: 1px solid var(--border-color);
            background: var(--bg-light);
            color: var(--text-muted);
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 500;
            transition: all 0.15s;
            padding: 0;
        }

        .period-btn:hover {
            background: var(--bg-hover);
            color: var(--text-secondary);
        }

        .period-btn.active {
            background: var(--claude-orange);
            color: #fff;
            border-color: var(--claude-orange);
        }

        /* 출처 관리 버튼 및 패널 */
        .source-manager-container {
            position: relative;
            display: inline-block;
            margin-left: 8px;
        }

        .source-manager-btn {
            height: 24px;
            padding: 0 8px;
            border: 1px solid var(--border-color);
            background: var(--bg-light);
            color: var(--text-muted);
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 500;
            transition: all 0.15s;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .source-manager-btn:hover {
            background: var(--bg-hover);
            color: var(--text-secondary);
        }

        .source-manager-btn.active {
            background: var(--claude-orange);
            color: #fff;
            border-color: var(--claude-orange);
        }

        .source-manager-panel {
            position: absolute;
            top: 100%;
            left: 0;
            margin-top: 4px;
            background: var(--bg-light);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 12px;
            min-width: 200px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
            z-index: 1000;
            display: none;
        }

        .source-manager-panel.visible {
            display: block;
        }

        .source-manager-section {
            margin-bottom: 12px;
        }

        .source-manager-section:last-child {
            margin-bottom: 0;
        }

        .source-manager-section-title {
            font-size: 10px;
            font-weight: 600;
            color: var(--text-muted);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .source-checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 4px 0;
            cursor: pointer;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .source-checkbox-item:hover {
            color: var(--text-primary);
        }

        .source-checkbox-item input[type="checkbox"] {
            accent-color: var(--claude-orange);
            cursor: pointer;
        }

        .source-checkbox-item.custom {
            justify-content: space-between;
        }

        .source-checkbox-item .delete-btn {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 14px;
            padding: 0 4px;
            line-height: 1;
        }

        .source-checkbox-item .delete-btn:hover {
            color: #e74c3c;
        }

        .source-manager-divider {
            height: 1px;
            background: var(--border-color);
            margin: 8px 0;
        }

        .upload-btn {
            width: 100%;
            padding: 8px 12px;
            border: 1px dashed var(--border-color);
            background: transparent;
            color: var(--text-secondary);
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            transition: all 0.15s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .upload-btn:hover {
            border-color: var(--claude-orange);
            color: var(--claude-orange);
            background: rgba(229, 123, 83, 0.1);
        }

        /* 파일 업로드 모달 */
        .upload-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            padding-left: 200px;
            padding-bottom: 100px;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s;
        }

        .upload-modal-overlay.visible {
            opacity: 1;
            visibility: visible;
        }

        .upload-modal {
            background: var(--bg-medium);
            border: 1px solid var(--border-color);
            border-radius: 2px;
            padding: 24px;
            width: 400px;
            max-width: 90vw;
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
        }

        .upload-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .upload-modal-title {
            font-size: 13px;
            font-weight: 400;
            color: var(--text-primary);
        }

        .upload-modal-close {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 20px;
            line-height: 1;
        }

        .upload-modal-close:hover {
            color: var(--text-primary);
        }

        .upload-form-group {
            margin-bottom: 16px;
        }

        .upload-form-label {
            display: block;
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 6px;
        }

        .upload-form-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            background: var(--bg-light);
            color: var(--text-primary);
            border-radius: 2px;
            font-size: 13px;
        }

        .upload-form-input:focus {
            outline: none;
            border-color: var(--claude-orange);
        }

        .upload-dropzone {
            border: 1px solid var(--border-color);
            border-radius: 2px;
            padding: 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.15s;
        }

        .upload-dropzone:hover,
        .upload-dropzone.dragover {
            border-color: var(--claude-orange);
            background: rgba(229, 123, 83, 0.1);
        }

        .upload-dropzone-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .upload-dropzone-text {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .upload-dropzone-hint {
            font-size: 11px;
            color: var(--text-muted);
        }

        .upload-file-info {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 12px;
            background: var(--bg-light);
            border-radius: 2px;
            margin-top: 12px;
        }

        .upload-file-name {
            flex: 1;
            font-size: 12px;
            color: var(--text-secondary);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .upload-file-remove {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 16px;
        }

        .upload-file-remove:hover {
            color: #e74c3c;
        }

        .upload-format-info {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 8px;
            padding: 8px;
            background: var(--bg-light);
            border-radius: 2px;
        }

        .upload-modal-actions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        .upload-modal-btn {
            padding: 8px 16px;
            border-radius: 2px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.15s;
        }

        .upload-modal-btn.cancel {
            background: var(--bg-light);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
        }

        .upload-modal-btn.cancel:hover {
            background: var(--bg-hover);
        }

        .upload-modal-btn.submit {
            background: var(--claude-orange);
            border: 1px solid var(--claude-orange);
            color: #fff;
        }

        .upload-modal-btn.submit:hover {
            background: #d06a44;
        }

        .upload-modal-btn.submit:disabled {
            background: var(--bg-light);
            border-color: var(--border-color);
            color: var(--text-muted);
            cursor: not-allowed;
        }

        /* 우측 패널 */
        .right-panel {
            flex: 1;
            background: var(--bg-dark);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-width: 280px;
            max-width: 450px;
            padding-right: 0;
            margin-right: 0;
            transition: width 0.2s ease, min-width 0.2s ease, max-width 0.2s ease;
        }

        .right-panel.collapsed {
            display: none;
            min-width: 0;
            max-width: 0;
            width: 0 !important;
            overflow: hidden;
        }

        /* 접힌 상태의 리사이저 - 펼치기 힌트 표시 */
        .resizer-horizontal.panel-collapsed::after {
            content: '◀';
            position: absolute;
            right: -8px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--claude-orange);
            font-size: 10px;
            pointer-events: none;
        }

        .detail-container {
            height: 100%;
            width: 100%;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            padding-right: 0;
        }

        /* 탭 스타일 */
        .detail-tabs {
            display: flex;
            gap: 6px;
            padding: 12px 12px 0;
            background: var(--bg-medium);
            flex-shrink: 0;
        }

        .detail-tab {
            padding: 10px 24px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            position: relative;
            border-radius: 8px 8px 0 0;
            transition: all 0.2s ease;
            border: none;
            box-shadow: 0 -2px 8px rgba(0,0,0,0.2);
        }

        /* 탭 공통 스타일 */
        .detail-tab {
            background: var(--bg-light);
            color: var(--claude-orange);
        }

        .detail-tab:hover {
            background: var(--bg-hover);
            transform: translateY(-2px);
        }

        .detail-tab.active {
            background: var(--claude-orange);
            color: #fff;
            box-shadow: 0 -4px 12px rgba(229, 123, 83, 0.4);
        }

        .detail-tab-content {
            flex: 1;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
        }

        /* 스크롤바 빈 공간 제거 */
        .detail-tab-content::-webkit-scrollbar {
            width: 6px;
            background: var(--bg-dark);
        }

        .detail-tab-content::-webkit-scrollbar-track {
            background: transparent;
        }

        .detail-tab-content::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }
        .detail-tab-content::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .detail-placeholder {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            font-size: 13px;
        }

        .detail-header {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-medium);
        }

        .detail-source {
            font-size: 11px;
            color: var(--text-muted);
            margin-bottom: 4px;
        }

        .detail-date {
            font-size: 11px;
            color: var(--text-dim);
        }

        .detail-chart {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
            min-height: 180px;
        }

        #detailChart {
            width: 100%;
            height: 160px;
        }

        .detail-charts {
            display: flex;
            flex-direction: column;
            gap: 12px;
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .detail-chart-item {
            height: 220px;
        }

        /* 기간별 차트 뷰 스타일 */
        .period-charts-view {
            padding: 16px;
        }

        .period-charts-header {
            margin-bottom: 16px;
        }

        .period-charts-title {
            font-size: 16px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .period-charts-subtitle {
            font-size: 12px;
            color: var(--text-muted);
        }

        .period-charts-total {
            font-size: 13px;
            color: var(--text-secondary);
            padding: 8px 12px;
            background: var(--bg-medium);
            border-radius: 4px;
            margin-bottom: 16px;
        }

        .period-chart-item {
            margin-bottom: 16px;
            background: var(--bg-medium);
            border-radius: 6px;
            padding: 12px;
        }

        .period-chart-item h4 {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .period-chart-container {
            height: 180px;
        }

        .period-events-list {
            margin-top: 16px;
            border-top: 1px solid var(--border-color);
            padding-top: 12px;
        }

        .period-events-title {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .period-event-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 0;
            cursor: pointer;
            border-bottom: 1px solid var(--border-color);
            font-size: 12px;
        }

        .period-event-item:last-child {
            border-bottom: none;
        }

        .period-event-item:hover {
            color: var(--claude-orange);
        }

        .period-event-source {
            background: var(--claude-orange);
            color: white;
            font-size: 9px;
            padding: 2px 6px;
            border-radius: 4px;
            flex-shrink: 0;
        }

        .period-event-date {
            color: var(--text-muted);
            font-size: 11px;
            flex-shrink: 0;
            width: 45px;
        }

        .period-event-title {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            color: var(--text-secondary);
        }

        .detail-content {
            padding: 16px;
            padding-right: 10px;
        }

        .detail-title {
            font-size: 14px;
            font-weight: 400;
            color: var(--text-primary);
            margin-bottom: 12px;
            line-height: 1.4;
        }

        .detail-summary {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .detail-summary ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .detail-summary li {
            padding: 6px 0;
            padding-left: 16px;
            position: relative;
        }

        .detail-summary li::before {
            content: '•';
            position: absolute;
            left: 0;
            color: var(--text-muted);
        }

        /* 분석 섹션 */
        .detail-analysis {
            margin-top: 20px;
            padding-top: 16px;
            border-top: 1px solid var(--border-color);
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.7;
        }

        .detail-analysis h4 {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            margin: 16px 0 8px 0;
        }

        .detail-analysis h5 {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            margin: 12px 0 6px 0;
        }

        .detail-analysis p {
            margin: 8px 0;
        }

        .detail-analysis strong {
            color: var(--text-primary);
            font-weight: 600;
        }

        .detail-analysis ul {
            list-style: none;
            padding: 0;
            margin: 8px 0;
        }

        .detail-analysis li {
            padding: 4px 0 4px 16px;
            position: relative;
        }

        .detail-analysis li::before {
            content: '▸';
            position: absolute;
            left: 0;
            color: var(--text-muted);
            font-size: 10px;
        }

        .analysis-table {
            width: 100%;
            border-collapse: collapse;
            margin: 12px 0;
            font-size: 11px;
        }

        .analysis-table th,
        .analysis-table td {
            border: 1px solid var(--border-color);
            padding: 6px 8px;
            text-align: left;
        }

        .analysis-table th {
            background: var(--bg-medium);
            font-weight: 500;
            color: var(--text-primary);
        }

        .analysis-table td {
            color: var(--text-secondary);
        }

        /* 팝오버 */
        .popover {
            position: fixed;
            background: var(--bg-light);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 8px;
            max-width: 250px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
            z-index: 1000;
            display: none;
        }

        .popover.visible {
            display: block;
        }

        .popover-title {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 6px;
            padding-bottom: 4px;
            border-bottom: 1px solid var(--border-color);
        }

        .popover-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 11px;
            color: var(--text-secondary);
            padding: 6px 8px;
            cursor: pointer;
            border-radius: 4px;
            transition: background 0.15s;
        }

        .popover-item:hover {
            color: var(--claude-orange);
            background: rgba(229, 123, 83, 0.15);
        }

        .popover-date {
            font-size: 10px;
            color: var(--text-muted);
            flex-shrink: 0;
            width: 40px;
        }

        .popover-title-text {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* 셀 카운트 스타일 */
        .cell-count {
            font-size: 11px;
            color: var(--claude-orange);
            font-weight: 400;
            cursor: pointer;
        }

        .cell-count:hover {
            text-decoration: underline;
        }

        /* 스크롤바 공통 - 오버레이 방식 */
        .source-list,
        .table-container,
        .detail-container,
        .detail-tab-content {
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
        }

        /* 스크롤바 스타일 - Webkit */
        .source-list::-webkit-scrollbar,
        .table-container::-webkit-scrollbar,
        .detail-container::-webkit-scrollbar,
        .detail-tab-content::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        .source-list::-webkit-scrollbar-track,
        .table-container::-webkit-scrollbar-track,
        .detail-container::-webkit-scrollbar-track,
        .detail-tab-content::-webkit-scrollbar-track {
            background: transparent;
        }

        .source-list::-webkit-scrollbar-thumb,
        .table-container::-webkit-scrollbar-thumb,
        .detail-container::-webkit-scrollbar-thumb,
        .detail-tab-content::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }
        .source-list::-webkit-scrollbar-thumb:hover,
        .table-container::-webkit-scrollbar-thumb:hover,
        .detail-container::-webkit-scrollbar-thumb:hover,
        .detail-tab-content::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Highcharts 커스텀 */
        .highcharts-button-box {
            fill: var(--bg-light);
        }

        .highcharts-button text {
            fill: var(--text-secondary) !important;
            font-weight: 300 !important;
        }

        .highcharts-button-pressed .highcharts-button-box {
            fill: var(--claude-orange) !important;
        }

        .highcharts-button-pressed text {
            fill: #fff !important;
        }

        /* Highcharts 햄버거 메뉴 버튼 축소 */
        .highcharts-exporting-group {
            transform: scale(0.6);
            transform-origin: top right;
            opacity: 0.4;
            transition: opacity 0.2s;
        }

        .highcharts-exporting-group:hover {
            opacity: 0.8;
        }

        .highcharts-button-symbol {
            stroke: var(--text-muted) !important;
            stroke-width: 1.5px !important;
        }

        .highcharts-menu {
            background: var(--bg-light) !important;
            border: 1px solid var(--border-color) !important;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3) !important;
        }

        .highcharts-menu-item {
            color: var(--text-secondary) !important;
            font-size: 11px !important;
        }

        .highcharts-menu-item:hover {
            background: var(--bg-hover) !important;
            color: var(--claude-orange) !important;
        }

        /* 메인 콘텐츠 영역 (중앙+우측+하단) */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* 상단 영역 (중앙+우측) */
        .upper-area {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        /* 리사이저 공통 스타일 */
        .resizer {
            background: var(--border-color);
            flex-shrink: 0;
            transition: background 0.15s;
            position: relative;
        }

        .resizer:hover {
            background: rgba(229, 123, 83, 0.5);
        }

        .resizer.active {
            background: var(--claude-orange);
        }

        /* 수평 리사이저 (좌우 조절) */
        .resizer-horizontal {
            width: 5px;
            cursor: col-resize;
        }

        /* 전망 탭 스타일 */
        .forecast-container {
            padding: 16px;
            padding-right: 10px;
        }

        .forecast-header {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .forecast-title {
            font-weight: 400;
        }

        .forecast-period {
            font-size: 11px;
            color: var(--text-muted);
        }

        .forecast-content {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .forecast-section h4 {
            font-size: 12px;
            font-weight: 400;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .forecast-section ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .forecast-section li {
            padding: 4px 0;
            padding-left: 16px;
            position: relative;
        }

        .forecast-section li::before {
            content: '•';
            position: absolute;
            left: 0;
            color: var(--text-muted);
        }

        /* 산업 분석 스타일 */
        .industry-analysis-view {
            padding: 24px;
            height: 100%;
            overflow-y: auto;
        }

        /* 도넛 차트 스타일 */
        .donut-chart-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 40px;
            width: 100%;
        }

        .donut-chart-svg {
            transform: rotate(-90deg);
        }

        .donut-center-text {
            text-anchor: middle;
            fill: var(--text-primary);
        }

        .donut-center-value {
            font-size: 24px;
            font-weight: 700;
        }

        .donut-center-label {
            font-size: 12px;
            fill: var(--text-secondary);
        }

        .donut-legend {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .donut-legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .donut-legend-color {
            width: 14px;
            height: 14px;
            border-radius: 3px;
            flex-shrink: 0;
        }

        .donut-legend-label {
            min-width: 80px;
        }

        .donut-legend-value {
            font-weight: 600;
            color: var(--text-primary);
        }

        /* 파이 차트 스타일 */
        .pie-chart-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 40px;
            width: 100%;
        }

        .pie-legend {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .pie-legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .pie-legend-color {
            width: 14px;
            height: 14px;
            border-radius: 3px;
            flex-shrink: 0;
        }

        .pie-legend-label {
            min-width: 60px;
        }

        .pie-legend-value {
            font-weight: 600;
            color: var(--text-primary);
        }

        /* 레이더 차트 스타일 */
        .radar-chart-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 40px;
            width: 100%;
        }

        .radar-legend {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .radar-legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .radar-legend-color {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .radar-legend-label {
            min-width: 40px;
        }

        .radar-legend-value {
            font-weight: 600;
            color: var(--text-primary);
        }

        .industry-section {
            margin-bottom: 24px;
            background: var(--card-bg);
            border-radius: 8px;
            padding: 24px;
        }

        .industry-section-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .industry-section-title::before {
            content: '';
            width: 4px;
            height: 16px;
            background: var(--claude-orange);
            border-radius: 2px;
        }

        .industry-chart-container {
            height: 320px;
            margin-top: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .industry-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }

        .industry-tab {
            padding: 6px 12px;
            cursor: pointer;
            border-radius: 4px;
            font-size: 12px;
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
            transition: all 0.2s ease;
        }

        .industry-tab:hover {
            background: var(--bg-tertiary);
        }

        .industry-tab.active {
            background: var(--claude-orange);
            color: white;
            border-color: var(--claude-orange);
        }

        /* 산업 분석 개선 - 선택기 스타일 */
        .industry-selector {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 8px;
            margin-bottom: 16px;
            padding: 12px;
            background: var(--bg-secondary);
            border-radius: 8px;
        }

        #industryItems, #intraItems {
            display: contents;
        }

        .industry-selector-item {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 10px;
            background: var(--bg-tertiary);
            border-radius: 6px;
            font-size: 12px;
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .industry-selector-item .remove-btn {
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-muted);
            border-radius: 50%;
            transition: all 0.2s;
        }

        .industry-selector-item .remove-btn:hover {
            background: rgba(193,95,60,0.2);
            color: var(--claude-crail);
        }

        .industry-add-btn {
            padding: 6px 12px;
            background: transparent;
            border: 1px dashed var(--border-color);
            border-radius: 6px;
            font-size: 12px;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
        }

        .industry-add-btn:hover {
            border-color: var(--claude-orange);
            color: var(--claude-orange);
        }

        .industry-dropdown-wrapper {
            position: relative;
            display: inline-block;
        }

        .industry-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            min-width: 160px;
            max-height: 200px;
            overflow-y: auto;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 100;
            display: none;
        }

        .industry-dropdown.show {
            display: block;
        }

        .industry-dropdown-item {
            padding: 10px 12px;
            font-size: 12px;
            color: var(--text-primary);
            cursor: pointer;
            transition: background 0.2s;
        }

        .industry-dropdown-item:hover {
            background: var(--bg-hover);
        }

        .industry-dropdown-item.disabled {
            color: var(--text-muted);
            cursor: not-allowed;
            opacity: 0.5;
        }

        /* 차트와 테이블 가로 배치 */
        .industry-content-row {
            display: flex;
            gap: 20px;
            margin-top: 12px;
        }

        .industry-chart-wrapper {
            flex: 1;
            min-width: 0;
        }

        .industry-chart-wrapper .industry-chart-container {
            height: 280px;
        }

        .industry-table-wrapper {
            flex: 0 0 320px;
            max-height: 320px;
            overflow-y: auto;
        }

        /* 데이터 테이블 스타일 */
        .industry-data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }

        .industry-data-table thead {
            position: sticky;
            top: 0;
            background: var(--bg-secondary);
        }

        .industry-data-table th {
            padding: 10px 12px;
            text-align: left;
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-color);
        }

        .industry-data-table td {
            padding: 10px 12px;
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-subtle);
        }

        .industry-data-table tr:hover td {
            background: var(--bg-hover);
        }

        .industry-data-table .value-positive {
            color: #22c55e;
        }

        .industry-data-table .value-negative {
            color: #ef4444;
        }

        .industry-data-table .rank-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            font-size: 11px;
            font-weight: 600;
        }

        .industry-data-table .rank-1 {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: white;
        }

        .industry-data-table .rank-2 {
            background: linear-gradient(135deg, #C0C0C0, #A0A0A0);
            color: white;
        }

        .industry-data-table .rank-3 {
            background: linear-gradient(135deg, #CD7F32, #B8860B);
            color: white;
        }

        .industry-data-table .rank-other {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
        }

        /* 반응형 */
        @media (max-width: 900px) {
            .industry-content-row {
                flex-direction: column;
            }
            .industry-table-wrapper {
                flex: none;
                max-height: 250px;
            }
        }

        .industry-bar-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }

        .industry-bar-label {
            width: 80px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .industry-bar-wrapper {
            flex: 1;
            height: 24px;
            background: var(--bg-secondary);
            border-radius: 4px;
            overflow: hidden;
            margin: 0 12px;
        }

        .industry-bar {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .industry-bar-value {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-primary);
            min-width: 60px;
            text-align: right;
        }

        .industry-analysis-header {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        /* 사용자 매뉴얼 스타일 */
        .manual-view {
            padding: 16px;
            height: 100%;
            overflow-y: auto;
        }
        .manual-header {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }
        .manual-section {
            margin-bottom: 20px;
            background: var(--bg-medium);
            border-radius: 2px;
            padding: 16px;
        }
        .manual-section-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .manual-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
            padding: 8px;
            border-radius: 2px;
        }
        .manual-item:last-child {
            margin-bottom: 0;
        }
        .manual-icon {
            width: 32px;
            height: 32px;
            background: rgba(229,123,83,0.15);
            border-radius: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--claude-orange);
            flex-shrink: 0;
        }
        .manual-icon svg {
            width: 16px;
            height: 16px;
        }
        .manual-content h4 {
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 4px;
            color: var(--text-primary);
        }
        .manual-content p {
            font-size: 12px;
            color: var(--text-muted);
            line-height: 1.5;
        }
        .manual-shortcut {
            display: inline-block;
            padding: 2px 6px;
            background: var(--bg-light);
            border-radius: 2px;
            font-size: 11px;
            font-family: monospace;
        }

        /* 매뉴얼 목차 (우측 패널) */
        .manual-toc {
            padding: 16px;
            height: 100%;
            overflow-y: auto;
        }
        .manual-toc-header {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .manual-toc-header svg {
            width: 20px;
            height: 20px;
            color: var(--claude-orange);
        }
        .manual-toc-item {
            padding: 14px 16px;
            margin-bottom: 8px;
            background: var(--bg-medium);
            border-radius: 2px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .manual-toc-item:hover {
            background: var(--bg-light);
        }
        .manual-toc-item.active {
            background: #555;
            color: white;
        }
        .manual-toc-text {
            flex: 1;
        }
        .manual-toc-title {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 2px;
        }
        .manual-toc-desc {
            font-size: 11px;
            opacity: 0.7;
        }

        /* 매뉴얼 상세 (중앙 패널) */
        .manual-detail {
            padding: 24px;
            height: 100%;
            overflow-y: auto;
        }
        .manual-detail-header {
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }
        .manual-detail-icon {
            font-size: 32px;
            margin-bottom: 12px;
        }
        .manual-detail-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }
        .manual-detail-desc {
            font-size: 14px;
            color: var(--text-muted);
            line-height: 1.6;
        }
        .manual-detail-section {
            margin-bottom: 32px;
        }
        .manual-detail-subtitle {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 12px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .manual-detail-subtitle::before {
            content: '';
            width: 4px;
            height: 18px;
            background: var(--claude-orange);
            border-radius: 2px;
        }
        .manual-detail-text {
            font-size: 14px;
            line-height: 1.7;
            color: var(--text-secondary);
            margin-bottom: 16px;
        }
        .manual-detail-list {
            list-style: none;
            padding: 0;
            margin: 0 0 16px 0;
        }
        .manual-detail-list li {
            padding: 8px 0;
            padding-left: 20px;
            position: relative;
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.5;
        }
        .manual-detail-list li::before {
            content: '•';
            position: absolute;
            left: 0;
            color: var(--claude-orange);
            font-weight: bold;
        }
        .manual-illustration {
            background: var(--bg-medium);
            border-radius: 2px;
            padding: 24px;
            margin: 16px 0;
            border: 1px solid var(--border-color);
        }
        .manual-illustration svg {
            width: 100%;
            max-width: 500px;
            height: auto;
            display: block;
            margin: 0 auto;
        }
        .illustration-caption {
            text-align: center;
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 12px;
        }
        .manual-tip {
            background: rgba(229,123,83,0.1);
            border-left: 3px solid var(--claude-orange);
            padding: 12px 16px;
            border-radius: 0 2px 2px 0;
            margin: 16px 0;
        }
        .manual-tip-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--claude-orange);
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .manual-tip-text {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.5;
        }
        .manual-welcome {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            padding: 40px;
        }
        .manual-welcome-icon {
            font-size: 64px;
            margin-bottom: 24px;
        }
        .manual-welcome-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 12px;
        }
        .manual-welcome-text {
            font-size: 14px;
            color: var(--text-muted);
            line-height: 1.6;
            max-width: 400px;
        }

        /* 캘린더 스타일 */
        .calendar-view { padding: 16px; height: 100%; display: flex; flex-direction: column; }
        .calendar-header { display: flex; align-items: center; gap: 16px; margin-bottom: 16px; }
        .calendar-title { font-size: 18px; font-weight: 600; }
        .calendar-nav { display: flex; gap: 8px; }
        .calendar-nav-btn { background: var(--bg-medium); border: none; padding: 8px 12px;
                            border-radius: 2px; cursor: pointer; color: var(--text-primary); }
        .calendar-nav-btn:hover { background: var(--bg-light); }

        /* 필터 검색창 */
        .calendar-filter { display: flex; gap: 12px; margin-bottom: 16px; flex-wrap: wrap; }
        .calendar-filter-input { width: 300px; padding: 8px 12px;
                                 background: var(--bg-medium); border: 1px solid var(--border-color);
                                 border-radius: 2px; color: var(--text-primary); }
        .calendar-filter-input::placeholder { color: var(--text-muted); }
        .calendar-filter-select { padding: 8px 12px; background: var(--bg-medium);
                                  border: 1px solid var(--border-color); border-radius: 2px;
                                  color: var(--text-primary); cursor: pointer; }

        /* 출처 범례 */
        .calendar-legend { display: flex; gap: 16px; margin-bottom: 16px; flex-wrap: wrap; }
        .calendar-legend-item { display: flex; align-items: center; gap: 6px; font-size: 12px; }
        .calendar-legend-color { width: 12px; height: 12px; border-radius: 2px; }

        /* 캘린더 그리드 */
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); flex: 1; gap: 1px;
                         background: var(--border-color); border: 1px solid var(--border-color); border-radius: 2px; overflow: hidden; }
        .calendar-day-header { background: var(--bg-medium); padding: 8px; text-align: center;
                               font-size: 12px; font-weight: 500; color: var(--text-muted); }
        .calendar-day { background: var(--bg-dark); padding: 4px; min-height: 100px; overflow: hidden; }
        .calendar-day.other-month { background: var(--bg-darker); opacity: 0.5; }
        .calendar-day-number { font-size: 12px; color: var(--text-muted); margin-bottom: 4px; }
        .calendar-day.today .calendar-day-number { background: var(--claude-orange);
                                                    color: white; border-radius: 50%;
                                                    width: 24px; height: 24px; display: flex;
                                                    align-items: center; justify-content: center; }
        .calendar-day.sunday .calendar-day-number { color: #EA4335; }
        .calendar-day.saturday .calendar-day-number { color: #4285F4; }

        /* Claude 8색 팔레트 */
        :root {
            --claude-crail: #C15F3C;      /* 메인 러스트 오렌지 - 실적발표 */
            --claude-sage: #7D8471;       /* 세이지 그린 - 뉴스 */
            --claude-tan: #D4A574;        /* 탄 - 보고서 */
            --claude-lavender: #9B8AA6;   /* 라벤더 - 컨퍼런스 */
            --claude-coffee: #A67B5B;     /* 커피 브라운 - 배당 */
        }

        /* 이벤트 아이템 (Claude 팔레트) */
        .calendar-event { font-size: 10px; padding: 2px 4px; margin-bottom: 2px;
                          border-radius: 2px; white-space: nowrap; overflow: hidden;
                          text-overflow: ellipsis; cursor: pointer;
                          background: transparent; color: var(--text-primary);
                          display: flex; align-items: center; gap: 4px; }
        .calendar-event:hover { background: var(--bg-light); }
        .calendar-event::before { content: '●'; font-size: 8px; flex-shrink: 0; }
        .calendar-event.source-earnings::before { color: var(--claude-crail); }
        .calendar-event.source-news::before { color: var(--claude-sage); }
        .calendar-event.source-report::before { color: var(--claude-tan); }
        .calendar-event.source-conference::before { color: var(--claude-lavender); }
        .calendar-event.source-dividend::before { color: var(--claude-coffee); }

        /* 미니 캘린더 */
        .mini-calendar { padding: 20px; border-bottom: 1px solid var(--border-color); }
        .mini-calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .mini-calendar-title { font-size: 16px; font-weight: 500; }
        .mini-calendar-nav-group { display: flex; gap: 8px; }
        .mini-calendar-nav { background: none; border: none; color: var(--text-muted); cursor: pointer; padding: 4px 8px; font-size: 14px; }
        .mini-calendar-nav:hover { color: var(--text-primary); }
        .mini-calendar-weekdays { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; font-size: 12px; color: var(--text-muted); text-align: center; margin-bottom: 8px; }
        .mini-calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; font-size: 14px; }
        .mini-calendar-day { text-align: center; padding: 8px; border-radius: 50%; cursor: pointer; color: var(--text-muted); width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; margin: 0 auto; }
        .mini-calendar-day:hover { background: var(--bg-light); }
        .mini-calendar-day.current-month { color: var(--text-primary); }
        .mini-calendar-day.today { background: #DA7756; color: white; }
        .mini-calendar-day.selected { border: 1px solid #DA7756; }
        .mini-calendar-day.has-event::after { content: ''; display: block; width: 4px; height: 4px; background: #DA7756; border-radius: 50%; margin: 2px auto 0; }

        /* 캘린더 통계 섹션 */
        .calendar-stats { padding: 16px; }
        .stats-header { font-size: 13px; font-weight: 600; margin-bottom: 12px; color: var(--text-primary); }
        .stats-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid var(--border-color); }
        .stats-label { color: var(--text-muted); font-size: 12px; }
        .stats-value { font-weight: 500; font-size: 12px; }
        .stats-divider { height: 1px; background: var(--border-color); margin: 16px 0; }
        .stats-company { display: flex; justify-content: space-between; padding: 6px 0; font-size: 12px; }
        .stats-count { color: var(--text-muted); }
        .upcoming-event { display: flex; align-items: flex-start; gap: 8px; padding: 8px 0; }
        .upcoming-dot { font-size: 10px; margin-top: 2px; }
        .upcoming-info { flex: 1; }
        .upcoming-title { font-size: 12px; margin-bottom: 2px; }
        .upcoming-date { font-size: 11px; color: var(--text-muted); }

        /* 파이 차트 */
        .pie-chart-container { text-align: center; margin: 16px 0; }
        .pie-chart { width: 140px; height: 140px; }
        .pie-chart-legend { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin-top: 12px; }
        .pie-legend-item { display: flex; align-items: center; gap: 4px; font-size: 11px; color: var(--text-muted); }
        .pie-legend-color { width: 10px; height: 10px; border-radius: 2px; }

        /* 이벤트 모달 */
        .calendar-event-modal { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
                                background: var(--bg-dark); border: 1px solid var(--border-color);
                                border-radius: 2px; padding: 20px; min-width: 300px; z-index: 1000;
                                box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        .calendar-modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0;
                                  background: rgba(0,0,0,0.5); z-index: 999; }
        .calendar-modal-header { font-size: 16px; font-weight: 600; margin-bottom: 12px; }
        .calendar-modal-close { position: absolute; top: 12px; right: 12px; background: none;
                                border: none; color: var(--text-muted); cursor: pointer; font-size: 18px; }

        /* 알림 모달 */
        .notification-modal {
            position: fixed;
            width: 360px;
            max-height: 480px;
            background: var(--bg-medium);
            border: 1px solid var(--border-color);
            border-radius: 2px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
        }
        .notification-header h3 {
            font-size: 14px;
            font-weight: 400;
            color: var(--text-primary);
            margin: 0;
            letter-spacing: 0.5px;
        }
        .notification-mark-read {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .notification-mark-read:hover {
            color: var(--claude-orange);
        }
        .notification-tabs {
            display: flex;
            gap: 4px;
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
        }
        .notification-tab {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 2px;
            cursor: pointer;
            background: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-muted);
            transition: all 0.15s;
        }
        .notification-tab:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }
        .notification-tab.active {
            background: #555;
            border-color: #555;
            color: #fff;
        }
        .notification-list {
            overflow-y: auto;
            max-height: 320px;
            flex: 1;
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
        }
        .notification-list::-webkit-scrollbar {
            width: 6px;
        }
        .notification-list::-webkit-scrollbar-track {
            background: transparent;
        }
        .notification-list::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }
        .notification-list::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        .notification-settings {
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
        }
        .notification-settings::-webkit-scrollbar {
            width: 6px;
        }
        .notification-settings::-webkit-scrollbar-track {
            background: transparent;
        }
        .notification-settings::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }
        .notification-settings::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        .notification-item {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: background 0.15s;
        }
        .notification-item:hover {
            background: var(--bg-hover);
        }
        .notification-item.unread {
            border-left: 3px solid var(--claude-orange);
            background: rgba(229, 123, 83, 0.05);
        }
        .notification-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 4px;
        }
        .notification-item-title {
            font-size: 13px;
            font-weight: 400;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .notification-item-title .dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--claude-orange);
            flex-shrink: 0;
        }
        .notification-item.unread .notification-item-title .dot {
            display: inline-block;
        }
        .notification-item:not(.unread) .notification-item-title .dot {
            display: none;
        }
        .notification-item-time {
            font-size: 11px;
            color: var(--text-dim);
            flex-shrink: 0;
        }
        .notification-item-desc {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 2px;
            padding-left: 12px;
        }
        .notification-empty {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-muted);
        }
        .notification-empty svg {
            width: 48px;
            height: 48px;
            margin-bottom: 12px;
            opacity: 0.5;
        }
        .notification-empty h4 {
            font-size: 14px;
            font-weight: 400;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        .notification-empty p {
            font-size: 12px;
            line-height: 1.5;
            margin-bottom: 16px;
        }
        .notification-empty button {
            background: var(--claude-orange);
            color: #fff;
            border: none;
            padding: 8px 16px;
            border-radius: 2px;
            font-size: 12px;
            cursor: pointer;
        }
        .notification-empty button:hover {
            opacity: 0.9;
        }
        /* 알림 설정 */
        .notification-settings {
            padding: 16px;
            overflow-y: auto;
            max-height: 320px;
        }
        .notification-settings-section {
            margin-bottom: 20px;
        }
        .notification-settings-section h4 {
            font-size: 12px;
            font-weight: 400;
            color: var(--text-primary);
            margin-bottom: 12px;
        }
        .notification-company-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 8px;
        }
        .notification-company-tag {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            background: var(--bg-light);
            border: 1px solid var(--border-color);
            border-radius: 2px;
            font-size: 12px;
            color: var(--text-secondary);
        }
        .notification-company-tag .remove {
            cursor: pointer;
            color: var(--text-dim);
            font-size: 14px;
            line-height: 1;
        }
        .notification-company-tag .remove:hover {
            color: var(--claude-orange);
        }
        .notification-add-company {
            position: relative;
            display: inline-block;
        }
        .notification-add-btn {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            background: transparent;
            border: 1px dashed var(--border-color);
            border-radius: 2px;
            font-size: 12px;
            color: var(--text-muted);
            cursor: pointer;
        }
        .notification-add-btn:hover {
            border-color: var(--claude-orange);
            color: var(--claude-orange);
        }
        .notification-company-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            margin-top: 4px;
            background: var(--bg-dark);
            border: 1px solid var(--border-color);
            border-radius: 2px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 10;
            min-width: 140px;
            max-height: 200px;
            overflow-y: auto;
        }
        .notification-company-dropdown-item {
            padding: 8px 12px;
            font-size: 12px;
            cursor: pointer;
            color: var(--text-secondary);
        }
        .notification-company-dropdown-item:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }
        .notification-company-remove {
            cursor: pointer;
            color: var(--text-dim);
            font-size: 16px;
            line-height: 1;
            padding: 2px 4px;
        }
        .notification-company-remove:hover {
            color: var(--claude-orange);
        }
        .notification-toggle-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
        }
        .notification-toggle-label {
            font-size: 12px;
            color: var(--text-secondary);
        }
        .notification-toggle {
            position: relative;
            width: 28px;
            height: 14px;
            background: var(--bg-light);
            border-radius: 2px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .notification-toggle.active {
            background: #555;
        }
        .notification-toggle::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 10px;
            height: 10px;
            background: #fff;
            border-radius: 2px;
            transition: left 0.2s;
        }
        .notification-toggle.active::after {
            left: 16px;
        }
        .notification-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 8px;
            height: 8px;
            background: #e74c3c;
            border-radius: 50%;
            display: none;
        }
        .notification-badge.show {
            display: block;
        }
        .notification-email-input {
            margin-top: 8px;
        }
        .notification-email-input input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-main);
            color: var(--text-primary);
            font-size: 12px;
        }
        .notification-select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-main);
            color: var(--text-primary);
            font-size: 12px;
            cursor: pointer;
        }
        .notification-radio-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 4px;
        }
        .notification-radio-item {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 4px 0;
        }
        .notification-radio-item input[type="radio"] {
            appearance: none;
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border: 2px solid #666;
            border-radius: 50%;
            background: transparent;
            cursor: pointer;
            position: relative;
            flex-shrink: 0;
        }
        .notification-radio-item input[type="radio"]:checked {
            border-color: #4a9eff;
        }
        .notification-radio-item input[type="radio"]:checked::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            background: #4a9eff;
            border-radius: 50%;
        }
        .notification-radio-item label {
            font-size: 12px;
            color: var(--text-primary);
            cursor: pointer;
        }
        .notification-quiet-hours {
            margin-top: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--text-secondary);
        }
        .notification-quiet-hours input {
            padding: 6px 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-main);
            color: var(--text-primary);
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 아이콘 사이드바 -->
        <div class="icon-sidebar">
            <div class="icon-sidebar-item active" title="차트" onclick="showChartView()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                </svg>
            </div>
            <div class="icon-sidebar-item" title="비교분석" onclick="showIndustryAnalysis()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
            </div>
            <div class="icon-sidebar-item" title="보고서">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                    <polyline points="10 9 9 9 8 9"></polyline>
                </svg>
            </div>
            <div class="icon-sidebar-item" title="검색">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
            </div>
            <div class="icon-sidebar-spacer"></div>
            <div class="icon-sidebar-item" title="캘린더" onclick="showCalendar()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
            </div>
            <div class="icon-sidebar-item" title="매뉴얼" onclick="showUserManual()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                    <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                </svg>
            </div>
            <div class="icon-sidebar-item" title="왓치리스트" onclick="showWatchlist()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                </svg>
            </div>
            <div class="icon-sidebar-item" title="알람" onclick="showNotifications()" style="position: relative;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                    <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                </svg>
                <div class="notification-badge" id="notificationBadge"></div>
            </div>
            <div class="icon-sidebar-item" title="테마 변경" onclick="toggleTheme()" id="themeToggleBtn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" id="themeIcon">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
            </div>
        </div>

        <!-- 메인 콘텐츠 영역 -->
        <div class="main-content">
            <!-- 상단 영역 (중앙+우측) -->
            <div class="upper-area" id="upperArea">
                <!-- 중앙 패널 -->
                <div class="center-panel" id="centerPanel">
                    <div class="chart-header">
                        <div class="search-title-container">
                            <input type="text" class="chart-search-input" id="chartSearchInput"
                                   placeholder="검색어를 입력하세요 (예: 넥슨의 매출액)" />
                            <h2 class="chart-title" id="chartTitle"></h2>
                        </div>
                    </div>
                    <div class="chart-container">
                        <div id="stockChart"></div>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="dataTable">
                            <!-- 테이블 내용 -->
                        </table>
                        <div class="source-detail-container" id="sourceDetailContainer">
                            <!-- 출처 클릭 시 보고서 목록 표시 -->
                        </div>
                    </div>
                </div>

                <!-- 중앙-우측 리사이저 -->
                <!-- 중앙-우측 리사이저 -->
                <div class="resizer resizer-horizontal" id="resizerCenter"></div>

                <!-- 우측 패널 -->
                <div class="right-panel" id="rightPanel">
                    <div class="detail-container" id="detailContainer">
                        <div class="detail-placeholder" id="detailPlaceholder">
                            항목을 선택하세요
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 팝오버 -->
    <div class="popover" id="popover">
        <div class="popover-title" id="popoverTitle"></div>
        <div class="popover-content" id="popoverContent"></div>
    </div>

    <script>
        // 알림 데이터
        const notificationData = [
            { id: 'n1', type: 'company', title: '넥슨 4분기 실적 공시', company: '넥슨', date: '2026-01-30 14:30', read: false },
            { id: 'n2', type: 'company', title: '크래프톤 신작 발표', company: '크래프톤', date: '2026-01-30 10:15', read: false },
            { id: 'n3', type: 'reply', title: '회원님의 분석글에 댓글', content: '좋은 분석이네요!', author: 'user123', date: '2026-01-29 18:20', read: true },
            { id: 'n4', type: 'company', title: '엔씨소프트 배당 공시', company: '엔씨소프트', date: '2026-01-29 09:00', read: true },
            { id: 'n5', type: 'reply', title: '회원님의 댓글에 답글', content: '동의합니다', author: 'investor99', date: '2026-01-28 15:45', read: true },
            { id: 'n6', type: 'company', title: '넷마블 IR 일정 등록', company: '넷마블', date: '2026-01-28 11:00', read: true }
        ];

        // 알림 설정
        const notificationSettings = {
            companies: {
                '넥슨': true,
                '크래프톤': true,
                '엔씨소프트': true,
                '넷마블': true
            },
            postNotifications: {
                commentOnMyPost: true,
                replyToMyComment: true,
                mentionMe: true
            },
            emailNotification: false,
            emailAddress: '',
            notificationFrequency: 'realtime',
            soundEnabled: false,
            quietHoursEnabled: false,
            quietHoursStart: '22:00',
            quietHoursEnd: '08:00'
        };

        // 추가 가능한 회사 목록
        const availableCompanies = ['넥슨', '크래프톤', '엔씨소프트', '넷마블', '펄어비스', '카카오게임즈', '위메이드', '컴투스'];

        // 출처별 더미 데이터
        const sourceData = {
            dart: {
                name: '공시(DART)',
                items: [
                    '넥슨 2024년 사업보고서',
                    '2024년 4분기 실적공시',
                    '2024년 3분기 분기보고서',
                    '2024년 2분기 분기보고서',
                    '2024년 1분기 분기보고서',
                    '주요사항보고서(자기주식취득)',
                    '임원현황 공시'
                ]
            },
            darkReport: {
                name: '다크리포트',
                items: [
                    '넥슨 매출 둔화 우려 분석',
                    '메이플스토리 매출 하락 리포트',
                    '던전앤파이터 중국 매출 분석',
                    'FC온라인 시즌 매출 추정',
                    '신작 기대작 매출 전망'
                ]
            },
            policy: {
                name: '정책/규제',
                items: [
                    '확률형 아이템 규제 강화안',
                    '게임산업법 개정 논의',
                    '청소년 게임시간 제한 완화',
                    '중국 판호 정책 변화',
                    '일본 게임시장 규제 동향'
                ]
            },
            news: {
                name: '뉴스/기타',
                items: [
                    '넥슨 신작 "퍼스트 디센던트" 출시',
                    '블루아카이브 글로벌 흥행',
                    '메이플스토리 20주년 이벤트',
                    '넥슨 북미 스튜디오 확장',
                    'EA와 전략적 파트너십 체결',
                    'FC온라인 e스포츠 대회 개최'
                ]
            },
            paper: {
                name: '논문',
                items: [
                    '게임 산업 성장 동력 분석',
                    'MMORPG 유저 행동 패턴 연구',
                    '게임 내 경제 시스템 연구',
                    'AI 기반 게임 콘텐츠 생성'
                ]
            },
            patent: {
                name: '특허',
                items: [
                    '게임 매칭 시스템 특허',
                    'AI NPC 행동 알고리즘',
                    '실시간 렌더링 기술',
                    '게임 내 거래 시스템'
                ]
            },
            sec: {
                name: 'SEC',
                items: [
                    'Form 20-F 연차보고서',
                    'Form 6-K 수시보고서',
                    '주요 주주 변동 보고'
                ]
            },
            edinet: {
                name: 'EDINET',
                items: [
                    '유가증권보고서',
                    '분기보고서',
                    '대량보유보고서'
                ]
            }
        };

        // 테이블 기간 선택 (기본값: 분기별)
        let selectedPeriod = 'quarter';

        // 출처 관리 상태
        const defaultSources = ['dart', 'darkReport', 'policy', 'paper', 'patent', 'sec', 'edinet'];
        let activeSources = [...defaultSources];
        let customSources = {}; // { key: { name: '출처명' } }
        let customSourceData = {}; // { key: { name: '...', items: [...] } }
        let customEventData = {}; // { key: { 'YYYY-MM': [...] } }

        // 이벤트 데이터 (날짜별) - 확장된 구조
        const eventData = {
            dart: {
                '2022-01': [{
                    id: 'dart-2022-01-1',
                    title: '2021년 4분기 잠정실적 공시',
                    summary: ['매출 2.5조원 달성', '영업이익 6,500억원', '던전앤파이터 중국 매출 호조', '메이플스토리 안정적 성장', '해외 매출 비중 65%'],
                    charts: [
                        {
                            title: '분기별 매출 추이 (억원)',
                            type: 'column',
                            data: [
                                { name: 'Q1', y: 21000 },
                                { name: 'Q2', y: 22000 },
                                { name: 'Q3', y: 23000 },
                                { name: 'Q4', y: 25000 }
                            ]
                        },
                        {
                            title: '게임별 매출 비중',
                            type: 'pie',
                            data: [
                                { name: '메이플', y: 32 },
                                { name: '던파', y: 28 },
                                { name: 'FC온라인', y: 20 },
                                { name: '기타', y: 20 }
                            ]
                        }
                    ],
                    date: '2022-01-15',
                    analysis: `## 데이터 기반 평가

**실적 평가: 양호 (★★★★☆)**

2021년 4분기 실적은 예상치에 부합하는 안정적인 실적을 기록했습니다.

### 핵심 지표 분석

| 지표 | 실적 | 전년비 | 평가 |
|------|------|--------|------|
| 매출 | 2.5조 | +8% | 양호 |
| 영업이익 | 6,500억 | +5% | 안정 |
| 영업이익률 | 26% | -1%p | 유지 |

### 성장 동력
1. **던전앤파이터**: 중국 시장 매출 안정적 유지
2. **메이플스토리**: 국내 MMORPG 1위 지속
3. **FC온라인**: e스포츠 연계 마케팅 효과

### 투자 의견
안정적인 실적 기반으로 2022년 성장 기대. 신작 파이프라인 확충 필요.`
                }],
                '2022-02': [{
                    id: 'dart-2022-02-1',
                    title: '2021년 사업보고서 제출',
                    summary: ['연간 총 매출 8.5조원', '해외 매출 비중 68%', '신규 IP 개발 투자'],
                    charts: [],
                    date: '2022-02-28'
                }],
                '2022-03': [],
                '2022-04': [{
                    id: 'dart-2022-04-1',
                    title: '2022년 1분기 분기보고서',
                    summary: ['매출 2.3조원', '영업이익 5,800억원', '메이플스토리 리마스터 효과', '블루아카이브 글로벌 출시', '신규 유저 유입 증가'],
                    charts: [
                        {
                            title: '전년 동기 대비 (억원)',
                            type: 'comparison',
                            categories: ['매출', '영업이익'],
                            series: [
                                { name: '2021 Q1', data: [21000, 5500], color: '#5B9BD5' },
                                { name: '2022 Q1', data: [23000, 5800], color: '#E57B53' }
                            ]
                        },
                        {
                            title: '지역별 매출 비중',
                            type: 'pie',
                            data: [
                                { name: '한국', y: 32 },
                                { name: '중국', y: 30 },
                                { name: '일본', y: 22 },
                                { name: '기타', y: 16 }
                            ]
                        }
                    ],
                    date: '2022-04-15',
                    analysis: `## 데이터 기반 평가

**1분기 실적 평가: 긍정적 (★★★★☆)**

메이플스토리 리마스터 업데이트 효과로 견조한 실적 달성.

### 핵심 지표

| 지표 | Q1 2022 | Q1 2021 | 증감 |
|------|---------|---------|------|
| 매출 | 2.3조 | 2.1조 | +9.5% |
| 영업이익 | 5,800억 | 5,500억 | +5.5% |

### 주요 이슈
- 메이플스토리 대규모 리마스터로 복귀 유저 증가
- 블루아카이브 글로벌 서비스 확대
- 던파 모바일 중국 안정적 운영`
                }],
                '2022-05': [],
                '2022-06': [],
                '2022-07': [{
                    id: 'dart-2022-07-1',
                    title: '2022년 2분기 분기보고서',
                    summary: ['매출 2.4조원', '영업이익 6,200억원', 'FC온라인 시즌 업데이트 효과', '블루아카이브 1주년 이벤트', '해외 매출 성장 지속'],
                    charts: [
                        {
                            title: '2022년 상반기 매출 (억원)',
                            type: 'column',
                            data: [
                                { name: 'Q1', y: 23000 },
                                { name: 'Q2', y: 24000 }
                            ]
                        },
                        {
                            title: '게임별 성장률 (%)',
                            type: 'comparison',
                            categories: ['FC온라인', '블루아카', '메이플'],
                            series: [
                                { name: '성장률', data: [15, 25, 8], color: '#E57B53' }
                            ]
                        },
                        {
                            title: '플랫폼별 매출',
                            type: 'pie',
                            data: [
                                { name: 'PC', y: 55 },
                                { name: '모바일', y: 35 },
                                { name: '콘솔', y: 10 }
                            ]
                        }
                    ],
                    date: '2022-07-15',
                    analysis: `## 데이터 기반 평가

**2분기 실적 평가: 우수 (★★★★☆)**

FC온라인 시즌 업데이트와 블루아카이브 1주년 효과로 전분기 대비 성장.

### 핵심 지표

| 지표 | Q2 2022 | Q1 2022 | 증감 |
|------|---------|---------|------|
| 매출 | 2.4조 | 2.3조 | +4.3% |
| 영업이익 | 6,200억 | 5,800억 | +6.9% |
| 영업이익률 | 25.8% | 25.2% | +0.6%p |

### 성장 포인트
1. **FC온라인**: 2022 시즌 업데이트 흥행
2. **블루아카이브**: 1주년 이벤트로 일본 매출 급증
3. **던파 모바일**: 중국 신규 콘텐츠 반응 호조`
                }],
                '2022-08': [],
                '2022-09': [],
                '2022-10': [{
                    id: 'dart-2022-10-1',
                    title: '2022년 3분기 분기보고서',
                    summary: ['매출 2.6조원', '영업이익 6,800억원', '블루아카이브 글로벌 성장', '던파 신규 직업 업데이트', '월드컵 시즌 기대감'],
                    charts: [
                        {
                            title: '2022년 분기별 매출 (억원)',
                            type: 'column',
                            data: [
                                { name: 'Q1', y: 23000 },
                                { name: 'Q2', y: 24000 },
                                { name: 'Q3', y: 26000 }
                            ]
                        },
                        {
                            title: '영업이익률 추이 (%)',
                            type: 'line',
                            data: [
                                { name: 'Q1', y: 25.2 },
                                { name: 'Q2', y: 25.8 },
                                { name: 'Q3', y: 26.2 }
                            ]
                        },
                        {
                            title: '신규 vs 기존 IP',
                            type: 'pie',
                            data: [
                                { name: '기존 IP', y: 82 },
                                { name: '신규 IP', y: 18 }
                            ]
                        }
                    ],
                    date: '2022-10-15',
                    analysis: `## 데이터 기반 평가

**3분기 실적 평가: 매우 긍정적 (★★★★★)**

블루아카이브 글로벌 성장과 던파 업데이트로 연간 최고 분기 실적 달성.

### 핵심 지표

| 지표 | Q3 2022 | Q2 2022 | 증감 |
|------|---------|---------|------|
| 매출 | 2.6조 | 2.4조 | +8.3% |
| 영업이익 | 6,800억 | 6,200억 | +9.7% |

### 하이라이트
1. **블루아카이브**: 일본 앱스토어 10위권 안착
2. **던파**: 신규 직업 출시로 중국 매출 증가
3. **FC온라인**: 월드컵 시즌 앞두고 기대감 상승

### 연간 전망
9.8조원 연간 매출 달성 가능성 높음. 4분기 월드컵 효과 기대.`
                }],
                '2022-11': [],
                '2022-12': [{
                    id: 'dart-2022-12-1',
                    title: '2022년 4분기 잠정실적 공시',
                    summary: ['매출 2.8조원 예상', '연간 매출 9.8조원 전망', '신작 개발 진행'],
                    charts: [],
                    date: '2022-12-20'
                }],
                '2023-01': [{
                    id: 'dart-2023-01-1',
                    title: '2022년 4분기 잠정실적 공시',
                    summary: ['매출 2.8조원 달성', '영업이익 7,200억원', '연간 매출 9.8조원 확정', 'FC온라인 월드컵 효과', '역대 최고 4분기 실적'],
                    charts: [
                        {
                            title: '2022년 분기별 실적 (억원)',
                            type: 'waterfall',
                            data: [
                                { name: 'Q1', y: 23000, color: '#4ECDC4' },
                                { name: 'Q2 증가', y: 1000, color: '#4ECDC4' },
                                { name: 'Q3 증가', y: 2000, color: '#4ECDC4' },
                                { name: 'Q4 증가', y: 2000, color: '#4ECDC4' },
                                { name: '연간', isSum: true, color: '#E57B53' }
                            ]
                        },
                        {
                            title: '전년 대비 성장률',
                            type: 'comparison',
                            categories: ['매출', '영업이익'],
                            series: [
                                { name: '2021', data: [85000, 22000], color: '#5B9BD5' },
                                { name: '2022', data: [98000, 26800], color: '#E57B53' }
                            ]
                        },
                        {
                            title: '4분기 게임별 기여도',
                            type: 'pie',
                            data: [
                                { name: 'FC온라인', y: 28 },
                                { name: '메이플', y: 30 },
                                { name: '던파', y: 25 },
                                { name: '기타', y: 17 }
                            ]
                        }
                    ],
                    date: '2023-01-15',
                    analysis: `## 데이터 기반 평가

**4분기 실적 평가: 최고 수준 (★★★★★)**

월드컵 효과와 연말 이벤트로 역대 최고 4분기 실적 달성.

### 연간 실적 요약

| 지표 | 2022년 | 2021년 | 성장률 |
|------|--------|--------|--------|
| 매출 | 9.8조 | 8.5조 | +15.3% |
| 영업이익 | 2.68조 | 2.2조 | +21.8% |
| 영업이익률 | 27.3% | 25.9% | +1.4%p |

### 2022년 성과
1. **FC온라인**: 월드컵 연계 이벤트 대성공
2. **블루아카이브**: 신규 캐시카우로 자리매김
3. **던파 모바일**: 중국 안정적 매출 유지

### 2023년 전망
10조원 매출 돌파 기대. 신작 퍼스트 디센던트 개발 진행.`
                }],
                '2023-02': [{
                    id: 'dart-2023-02-1',
                    title: '2022년 사업보고서 제출',
                    summary: ['연간 총 매출 9.8조원', '해외 매출 비중 70%', '퍼스트 디센던트 개발 발표'],
                    charts: [],
                    date: '2023-02-28'
                }],
                '2023-03': [],
                '2023-04': [{
                    id: 'dart-2023-04-1',
                    title: '2023년 1분기 분기보고서',
                    summary: ['매출 2.8조원', '영업이익 6,800억원', '블루아카이브 일본 매출 상승', '메이플스토리 신규 콘텐츠', '퍼스트 디센던트 개발 진행'],
                    charts: [
                        {
                            title: '전년 동기 대비 (억원)',
                            type: 'comparison',
                            categories: ['매출', '영업이익'],
                            series: [
                                { name: 'Q1 2022', data: [23000, 5800], color: '#5B9BD5' },
                                { name: 'Q1 2023', data: [28000, 6800], color: '#E57B53' }
                            ]
                        },
                        {
                            title: '일본 시장 성장',
                            type: 'line',
                            data: [
                                { name: 'Q1 2022', y: 4500 },
                                { name: 'Q2 2022', y: 4800 },
                                { name: 'Q3 2022', y: 5200 },
                                { name: 'Q4 2022', y: 5500 },
                                { name: 'Q1 2023', y: 6200 }
                            ]
                        },
                        {
                            title: '주요 게임 매출 비중',
                            type: 'pie',
                            data: [
                                { name: '메이플', y: 33 },
                                { name: '던파', y: 26 },
                                { name: 'FC온라인', y: 18 },
                                { name: '블루아카', y: 12 },
                                { name: '기타', y: 11 }
                            ]
                        }
                    ],
                    date: '2023-04-15',
                    analysis: `## 데이터 기반 평가

**1분기 실적 평가: 긍정적 (★★★★☆)**

전년 동기 대비 21.7% 성장하며 연간 성장 기조 유지.

### 핵심 지표

| 지표 | Q1 2023 | Q1 2022 | 증감 |
|------|---------|---------|------|
| 매출 | 2.8조 | 2.3조 | +21.7% |
| 영업이익 | 6,800억 | 5,800억 | +17.2% |
| 일본매출 | 6,200억 | 4,500억 | +37.8% |

### 성장 동력
1. **블루아카이브**: 일본 서브컬처 시장 선두
2. **메이플스토리**: 20주년 앞두고 신규 콘텐츠 강화
3. **글로벌 확장**: 해외 매출 비중 72%로 증가`
                }],
                '2023-05': [],
                '2023-06': [],
                '2023-07': [{
                    id: 'dart-2023-07-1',
                    title: '2023년 2분기 분기보고서',
                    summary: ['매출 2.9조원', '영업이익 7,500억원', '던파 모바일 중국 호조', '블루아카이브 1.5주년', '퍼스트 디센던트 CBT 예정'],
                    charts: [
                        {
                            title: '2023년 상반기 실적 (억원)',
                            type: 'column',
                            data: [
                                { name: 'Q1', y: 28000 },
                                { name: 'Q2', y: 29000 }
                            ]
                        },
                        {
                            title: '중국 매출 추이 (억원)',
                            type: 'line',
                            data: [
                                { name: 'Q4 2022', y: 8500 },
                                { name: 'Q1 2023', y: 8800 },
                                { name: 'Q2 2023', y: 9500 }
                            ]
                        },
                        {
                            title: '지역별 매출 비중',
                            type: 'pie',
                            data: [
                                { name: '한국', y: 25 },
                                { name: '중국', y: 33 },
                                { name: '일본', y: 24 },
                                { name: '기타', y: 18 }
                            ]
                        }
                    ],
                    date: '2023-07-15',
                    analysis: `## 데이터 기반 평가

**2분기 실적 평가: 우수 (★★★★☆)**

던파 모바일 신규 콘텐츠와 블루아카이브 1.5주년으로 실적 성장 지속.

### 핵심 지표

| 지표 | Q2 2023 | Q1 2023 | 증감 |
|------|---------|---------|------|
| 매출 | 2.9조 | 2.8조 | +3.6% |
| 영업이익 | 7,500억 | 6,800억 | +10.3% |
| 중국매출 | 9,500억 | 8,800억 | +8.0% |

### 주요 이슈
1. **던파 모바일**: 신규 직업 업데이트로 중국 매출 급증
2. **블루아카이브**: 1.5주년 이벤트 대성공
3. **퍼스트 디센던트**: 하반기 CBT 진행 예정`
                }],
                '2023-08': [],
                '2023-09': [],
                '2023-10': [{
                    id: 'dart-2023-10-1',
                    title: '2023년 3분기 분기보고서',
                    summary: ['매출 3.0조원', '영업이익 8,000억원', '메이플스토리 20주년 준비', '퍼스트 디센던트 CBT 성공', '연간 12조원 달성 전망'],
                    charts: [
                        {
                            title: '2023년 분기별 매출 (억원)',
                            type: 'column',
                            data: [
                                { name: 'Q1', y: 28000 },
                                { name: 'Q2', y: 29000 },
                                { name: 'Q3', y: 30000 }
                            ]
                        },
                        {
                            title: '영업이익률 추이 (%)',
                            type: 'line',
                            data: [
                                { name: 'Q1', y: 24.3 },
                                { name: 'Q2', y: 25.9 },
                                { name: 'Q3', y: 26.7 }
                            ]
                        },
                        {
                            title: '신작 개발 현황',
                            type: 'pie',
                            data: [
                                { name: '퍼스트디센던트', y: 40 },
                                { name: '기타 신작', y: 35 },
                                { name: '기존IP 업뎃', y: 25 }
                            ]
                        }
                    ],
                    date: '2023-10-15',
                    analysis: `## 데이터 기반 평가

**3분기 실적 평가: 매우 긍정적 (★★★★★)**

3분기 연속 성장하며 연간 12조원 매출 달성 확실시.

### 핵심 지표

| 지표 | Q3 2023 | Q2 2023 | 증감 |
|------|---------|---------|------|
| 매출 | 3.0조 | 2.9조 | +3.4% |
| 영업이익 | 8,000억 | 7,500억 | +6.7% |
| 영업이익률 | 26.7% | 25.9% | +0.8%p |

### 성장 포인트
1. **메이플스토리**: 20주년 이벤트 준비로 기대감 상승
2. **퍼스트 디센던트**: CBT 호평, 2024년 출시 확정
3. **블루아카이브**: 애니메이션 발표로 IP 확장

### 2024년 전망
퍼스트 디센던트 출시로 신규 성장 동력 확보 기대.`
                }],
                '2023-11': [],
                '2023-12': [{
                    id: 'dart-2023-12-1',
                    title: '2023년 4분기 잠정실적 공시',
                    summary: ['매출 3.2조원 예상', '연간 매출 11.97조원 전망', '퍼스트 디센던트 출시 예정'],
                    charts: [],
                    date: '2023-12-20'
                }],
                '2024-01': [{
                    id: 'dart-2024-01-1',
                    title: '2023년 4분기 잠정실적 공시',
                    summary: [
                        '매출 3.2조원 달성 (전년 동기 대비 12% 증가)',
                        '영업이익 8,500억원 (영업이익률 26.6%)',
                        '메이플스토리, 던전앤파이터 매출 견조',
                        'FC온라인 시즌 매출 호조',
                        '중국 던파 모바일 월 매출 2,000억원 추정',
                        '블루아카이브 일본 매출 상승세 지속',
                        '퍼스트 디센던트 개발 진행률 85%',
                        '2024년 연간 매출 가이던스 상향 조정',
                        '현금성 자산 5조원 돌파',
                        '배당금 증가 및 자사주 매입 계획 발표',
                        '게임 라이브 서비스 모델 전환 가속화',
                        '글로벌 e스포츠 투자 확대 전략 수립'
                    ],
                    charts: [
                        {
                            title: '분기별 실적 흐름 (억원)',
                            type: 'waterfall',
                            data: [
                                { name: 'Q1', y: 28000, color: '#4ECDC4' },
                                { name: 'Q2 증가', y: 1500, color: '#4ECDC4' },
                                { name: 'Q3 증가', y: 700, color: '#4ECDC4' },
                                { name: 'Q4 증가', y: 1800, color: '#4ECDC4' },
                                { name: '연간', isSum: true, color: '#E57B53' }
                            ]
                        },
                        {
                            title: '성장률 비교',
                            type: 'comparison',
                            categories: ['매출성장률', '영업이익률'],
                            series: [
                                { name: '넥슨', data: [12, 26.6], color: '#E57B53' },
                                { name: '업계평균', data: [8, 18], color: '#5B9BD5' }
                            ]
                        },
                        {
                            title: '게임별 매출 비중',
                            type: 'pie',
                            data: [
                                { name: '메이플', y: 35 },
                                { name: '던파', y: 25 },
                                { name: 'FC온라인', y: 22 },
                                { name: '기타', y: 18 }
                            ]
                        }
                    ],
                    date: '2024-01-15',
                    analysis: `## 데이터 기반 평가

**실적 평가: 긍정적 (★★★★☆)**

2023년 4분기 실적은 시장 예상치를 상회하는 호실적을 기록했습니다. 매출 3.2조원은 전년 동기 대비 12% 성장으로, 게임업계 평균 성장률(8%)을 크게 웃도는 수치입니다.

### 핵심 지표 분석

| 지표 | 실적 | 업계평균 | 평가 |
|------|------|---------|------|
| 매출성장률 | 12% | 8% | 우수 |
| 영업이익률 | 26.6% | 18% | 최상위권 |
| ROE | 18.2% | 12% | 양호 |

### 성장 동력
1. **메이플스토리**: 20주년 이벤트 효과로 복귀 유저 급증
2. **던전앤파이터**: 중국 모바일 버전 월 매출 2,000억원 추정
3. **FC온라인**: 시즌 전환 효과로 과금 유저 증가

### 리스크 요인
- 중국 게임 규제 불확실성 지속
- 신작 퍼스트 디센던트 출시 지연 가능성
- 원/엔 환율 변동에 따른 일본 매출 영향

### 투자 의견
현재 주가 대비 적정 가치 평가. 2024년 신작 출시 일정에 따라 추가 상승 여력 존재. 다만 중국 리스크 모니터링 필요.`
                },
                {
                    id: 'dart-2024-01-2',
                    title: '주요사항보고서(유상증자)',
                    summary: ['유상증자 500억원 결정', '신주 발행가 50,000원'],
                    charts: [],
                    date: '2024-01-20'
                },
                {
                    id: 'dart-2024-01-3',
                    title: '임원보수한도 승인의 건',
                    summary: ['이사보수 한도 30억원', '감사보수 한도 5억원'],
                    charts: [],
                    date: '2024-01-25'
                },
                {
                    id: 'dart-2024-01-4',
                    title: '자기주식 처분결과 보고서',
                    summary: ['자기주식 100만주 처분', '처분금액 500억원'],
                    charts: [],
                    date: '2024-01-28'
                }],
                '2024-02': [{
                    id: 'dart-2024-02-1',
                    title: '2023년 사업보고서 제출',
                    summary: [
                        '연간 총 매출 11.97조원 기록',
                        '해외 매출 비중 75% 달성',
                        '신규 IP 개발 투자 확대',
                        '임직원 수 7,200명으로 증가'
                    ],
                    charts: [
                        {
                            title: '연간 매출 성장 (억원)',
                            type: 'waterfall',
                            data: [
                                { name: '2021', y: 85000, color: '#4ECDC4' },
                                { name: '2022 증가', y: 13000, color: '#4ECDC4' },
                                { name: '2023 증가', y: 21700, color: '#4ECDC4' },
                                { name: '누적', isSum: true, color: '#E57B53' }
                            ]
                        },
                        {
                            title: '매출 지역별 비중 (%)',
                            type: 'pie',
                            data: [
                                { name: '국내', y: 25 },
                                { name: '해외', y: 75 }
                            ]
                        },
                        {
                            title: '연간 성장률 비교',
                            type: 'comparison',
                            categories: ['매출성장률', '인력성장률'],
                            series: [
                                { name: '넥슨', data: [22.2, 5.9], color: '#E57B53' },
                                { name: '업계평균', data: [12, 3], color: '#5B9BD5' }
                            ]
                        }
                    ],
                    date: '2024-02-28',
                    analysis: `## 데이터 기반 평가

**연간 실적 평가: 매우 긍정적 (★★★★★)**

2023년 연간 실적은 역대 최고 수준을 기록했습니다. 매출 11.97조원은 전년 대비 22.2% 성장으로, 게임업계 내 압도적인 성과입니다.

### 핵심 지표 분석

| 지표 | 2023년 | 2022년 | 성장률 |
|------|--------|--------|--------|
| 매출 | 11.97조 | 9.8조 | +22.2% |
| 영업이익 | 3.2조 | 2.5조 | +28% |
| 해외비중 | 75% | 70% | +5%p |

### 성장 포인트
1. **글로벌 확장**: 해외 매출 비중 75%로 국내 의존도 감소
2. **포트폴리오 다각화**: 신규 IP 투자로 리스크 분산
3. **인력 확충**: 개발 역량 강화를 위한 적극적 채용

### 향후 전망
2024년은 퍼스트 디센던트 출시와 기존 IP 업데이트로 추가 성장 기대. 다만 인건비 상승에 따른 수익성 관리 필요.`
                },
                {
                    id: 'dart-2024-02-2',
                    title: '정기주주총회 소집공고',
                    summary: ['제27기 정기주주총회 개최 안내', '배당금 지급 안건 상정'],
                    charts: [],
                    date: '2024-02-15'
                },
                {
                    id: 'dart-2024-02-3',
                    title: '감사보고서 제출',
                    summary: ['외부감사인 적정의견', '내부회계관리제도 적정'],
                    charts: [],
                    date: '2024-02-20'
                }],
                '2024-03': [],
                '2024-04': [{
                    id: 'dart-2024-04-1',
                    title: '2024년 1분기 분기보고서',
                    summary: [
                        '매출 3.1조원 (전년 동기 대비 8% 증가)',
                        '영업이익 7,800억원',
                        '블루아카이브 글로벌 성장세',
                        '신작 퍼스트 디센던트 개발 진행 중'
                    ],
                    charts: [
                        {
                            title: '분기 매출 (억원)',
                            type: 'column',
                            data: [
                                { name: 'Q1 2023', y: 28000 },
                                { name: 'Q1 2024', y: 31000 }
                            ]
                        },
                        {
                            title: '게임별 매출 비중 (%)',
                            type: 'pie',
                            data: [
                                { name: '메이플', y: 35 },
                                { name: '던파', y: 25 },
                                { name: 'FC온라인', y: 20 },
                                { name: '기타', y: 20 }
                            ]
                        },
                        {
                            title: '영업이익 추이 (억원)',
                            type: 'line',
                            data: [
                                { name: 'Q1 2023', y: 6800 },
                                { name: 'Q1 2024', y: 7800 }
                            ]
                        }
                    ],
                    date: '2024-04-15',
                    analysis: `## 데이터 기반 평가

**1분기 실적 평가: 긍정적 (★★★★☆)**

2024년 1분기 실적은 전년 동기 대비 8% 성장하며 안정적인 출발을 보였습니다.

### 핵심 지표 분석

| 지표 | Q1 2024 | Q1 2023 | 증감 |
|------|---------|---------|------|
| 매출 | 3.1조 | 2.8조 | +10.7% |
| 영업이익 | 7,800억 | 6,800억 | +14.7% |
| 영업이익률 | 25.2% | 24.3% | +0.9%p |

### 주요 분석
1. **블루아카이브**: 일본 시장에서 지속적인 성장세
2. **퍼스트 디센던트**: CBT 반응 긍정적, 7월 출시 예정
3. **FC온라인**: 시즌 업데이트로 매출 유지

### 투자 포인트
신작 출시 전 안정적인 기존 IP 매출 유지. 하반기 퍼스트 디센던트 출시에 따른 실적 개선 기대.`
                }],
                '2024-05': [{
                    id: 'dart-2024-05-1',
                    title: '주요사항보고서(자기주식취득)',
                    summary: [
                        '자기주식 500억원 규모 취득 결정',
                        '주주가치 제고 목적',
                        '취득 기간: 2024.05 ~ 2024.08',
                        '취득 방법: 장내 매수'
                    ],
                    charts: [
                        {
                            title: '자사주 매입 규모 (억원)',
                            type: 'column',
                            data: [
                                { name: '2022', y: 300 },
                                { name: '2023', y: 400 },
                                { name: '2024', y: 500 }
                            ]
                        },
                        {
                            title: '주주환원율 (%)',
                            type: 'line',
                            data: [
                                { name: '2022', y: 15 },
                                { name: '2023', y: 18 },
                                { name: '2024', y: 22 }
                            ]
                        },
                        {
                            title: '자사주 비중 (%)',
                            type: 'pie',
                            data: [
                                { name: '유통주식', y: 92 },
                                { name: '자사주', y: 8 }
                            ]
                        }
                    ],
                    date: '2024-05-10'
                }],
                '2024-06': [],
                '2024-07': [{
                    id: 'dart-2024-07-1',
                    title: '2024년 2분기 분기보고서',
                    summary: [
                        '매출 3.3조원 (전분기 대비 6% 증가)',
                        '영업이익 8,200억원',
                        '퍼스트 디센던트 출시 효과',
                        '중국 시장 매출 회복세'
                    ],
                    charts: [
                        {
                            title: '2024년 분기별 매출 (억원)',
                            type: 'column',
                            data: [
                                { name: 'Q1', y: 31000 },
                                { name: 'Q2', y: 33000 }
                            ]
                        },
                        {
                            title: '영업이익률 (%)',
                            type: 'line',
                            data: [
                                { name: 'Q1', y: 25.2 },
                                { name: 'Q2', y: 24.8 }
                            ]
                        },
                        {
                            title: '지역별 매출 비중',
                            type: 'pie',
                            data: [
                                { name: '한국', y: 22 },
                                { name: '중국', y: 35 },
                                { name: '일본', y: 25 },
                                { name: '기타', y: 18 }
                            ]
                        }
                    ],
                    date: '2024-07-15',
                    analysis: `## 데이터 기반 평가

**2분기 실적 평가: 매우 긍정적 (★★★★★)**

퍼스트 디센던트 출시 효과와 중국 시장 회복으로 예상을 뛰어넘는 실적 달성.

### 핵심 지표 분석

| 지표 | Q2 2024 | Q1 2024 | 증감 |
|------|---------|---------|------|
| 매출 | 3.3조 | 3.1조 | +6.5% |
| 영업이익 | 8,200억 | 7,800억 | +5.1% |
| 중국 비중 | 35% | 32% | +3%p |

### 성장 동력
1. **퍼스트 디센던트**: 7월 출시 직후 글로벌 흥행
2. **던파 중국**: 신규 직업 업데이트로 매출 급증
3. **블루아카이브**: 2주년 이벤트 성공

### 시장 반응
출시 첫 주 스팀 동시접속 26만명 달성. 글로벌 루터슈터 시장 진입 성공으로 평가.`
                }],
                '2024-08': [],
                '2024-09': [],
                '2024-10': [{
                    id: 'dart-2024-10-1',
                    title: '2024년 3분기 분기보고서',
                    summary: [
                        '매출 3.5조원 (전분기 대비 6% 증가)',
                        '영업이익 9,100억원 (역대 최고)',
                        '퍼스트 디센던트 누적 매출 3,000억원',
                        '블루아카이브 일본 매출 1위 달성'
                    ],
                    charts: [
                        {
                            title: '2024년 분기별 매출 (억원)',
                            type: 'column',
                            data: [
                                { name: 'Q1', y: 31000 },
                                { name: 'Q2', y: 33000 },
                                { name: 'Q3', y: 35000 }
                            ]
                        },
                        {
                            title: '영업이익률 (%)',
                            type: 'line',
                            data: [
                                { name: 'Q1', y: 25.2 },
                                { name: 'Q2', y: 24.8 },
                                { name: 'Q3', y: 26.0 }
                            ]
                        },
                        {
                            title: '신작 매출 비중',
                            type: 'pie',
                            data: [
                                { name: '퍼스트디센던트', y: 25 },
                                { name: '기존 IP', y: 75 }
                            ]
                        }
                    ],
                    date: '2024-10-15',
                    analysis: `## 데이터 기반 평가

**3분기 실적 평가: 최고 수준 (★★★★★)**

역대 최고 분기 영업이익 달성. 퍼스트 디센던트 누적 매출 3,000억원 돌파.

### 핵심 지표 분석

| 지표 | Q3 2024 | Q2 2024 | 증감 |
|------|---------|---------|------|
| 매출 | 3.5조 | 3.3조 | +6.1% |
| 영업이익 | 9,100억 | 8,200억 | +11% |
| 영업이익률 | 26.0% | 24.8% | +1.2%p |

### 성공 요인
1. **퍼스트 디센던트**: 시즌1 업데이트로 유저 리텐션 유지
2. **블루아카이브**: 일본 매출 1위 달성
3. **메이플스토리**: 20주년 이벤트 흥행

### 신작 기여도
퍼스트 디센던트가 전체 매출의 25%를 차지하며 신규 캐시카우로 자리매김.`
                }],
                '2024-11': [],
                '2024-12': [{
                    id: 'dart-2024-12-1',
                    title: '2024년 4분기 잠정실적 공시',
                    summary: [
                        '매출 3.8조원 (역대 최고 분기 실적)',
                        '영업이익 1조원 돌파',
                        '연간 총 매출 13.7조원 전망',
                        '2025년 신작 라인업 발표 예정'
                    ],
                    charts: [
                        {
                            title: '2024년 분기별 실적 흐름 (억원)',
                            type: 'waterfall',
                            data: [
                                { name: 'Q1', y: 31000, color: '#4ECDC4' },
                                { name: 'Q2 증가', y: 2000, color: '#4ECDC4' },
                                { name: 'Q3 증가', y: 2000, color: '#4ECDC4' },
                                { name: 'Q4 증가', y: 3000, color: '#4ECDC4' },
                                { name: '연간', isSum: true, color: '#E57B53' }
                            ]
                        },
                        {
                            title: '전년 대비 성장률 (%)',
                            type: 'comparison',
                            categories: ['매출성장률', '영업이익률', 'ROE'],
                            series: [
                                { name: '넥슨', data: [14.5, 26.3, 18.2], color: '#4ECDC4' },
                                { name: '업계평균', data: [6.2, 15.8, 10.5], color: '#5B9BD5' }
                            ]
                        },
                        {
                            title: '게임별 매출 비중',
                            type: 'pie',
                            data: [
                                { name: '메이플', y: 32 },
                                { name: '던파', y: 28 },
                                { name: 'FC온라인', y: 18 },
                                { name: '퍼스트디센던트', y: 12 },
                                { name: '기타', y: 10 }
                            ]
                        }
                    ],
                    date: '2024-12-20',
                    analysis: `## 데이터 기반 평가

**연간 실적 평가: 역대 최고 (★★★★★)**

2024년 연간 매출 13.7조원으로 사상 최대 실적 달성 전망.

### 핵심 지표 분석

| 지표 | 2024년(E) | 2023년 | 증감 |
|------|-----------|--------|------|
| 매출 | 13.7조 | 11.97조 | +14.5% |
| 영업이익 | 3.5조 | 3.2조 | +9.4% |
| 영업이익률 | 26.3% | 26.7% | -0.4%p |

### 2024년 성과
1. **퍼스트 디센던트**: 신작 성공으로 글로벌 포트폴리오 다각화
2. **기존 IP 안정성**: 메이플, 던파 등 꾸준한 매출 유지
3. **일본 시장**: 블루아카이브 1위로 일본 내 입지 강화

### 2025년 전망
신작 라인업 발표 예정. 퍼스트 디센던트 시즌2, 메이플 신규 월드 등 기대작 다수.`
                }]
            },
            darkReport: {
                '2022-01': [],
                '2022-02': [{
                    id: 'dark-2022-02-1',
                    title: '던파 모바일 중국 매출 분석',
                    summary: ['던전앤파이터 모바일 중국 월 매출 1,500억원 추정', '텐센트 협력 효과'],
                    charts: [],
                    date: '2022-02-10'
                }],
                '2022-03': [],
                '2022-04': [{
                    id: 'dark-2022-04-1',
                    title: '메이플스토리 유저 분석',
                    summary: ['리마스터 업데이트 후 복귀 유저 증가', 'DAU 15% 상승', '신규 유저 유입률 개선', '결제 유저 비율 증가'],
                    charts: [
                        {
                            title: 'DAU 변화 (만명)',
                            type: 'column',
                            data: [
                                { name: '리마스터 전', y: 32 },
                                { name: '리마스터 후', y: 37 }
                            ]
                        },
                        {
                            title: '유저 유형별 비율',
                            type: 'pie',
                            data: [
                                { name: '복귀유저', y: 35 },
                                { name: '기존유저', y: 50 },
                                { name: '신규유저', y: 15 }
                            ]
                        }
                    ],
                    date: '2022-04-05',
                    analysis: `## 유저 분석 리포트

**업데이트 효과: 긍정적 (★★★★☆)**

리마스터 업데이트 후 DAU 15% 상승, 복귀 유저 비율 35% 기록.

### 주요 지표

| 지표 | 업데이트 전 | 업데이트 후 | 변화 |
|------|------------|------------|------|
| DAU | 32만 | 37만 | +15.6% |
| 결제율 | 8.2% | 9.5% | +1.3%p |
| ARPU | 15,000원 | 17,500원 | +16.7% |

### 시사점
리마스터 업데이트가 유저 복귀와 결제율 향상에 효과적임을 입증.`
                }],
                '2022-05': [],
                '2022-06': [{
                    id: 'dark-2022-06-1',
                    title: 'FC온라인 시즌 분석',
                    summary: ['월드컵 시즌 효과 예상', '과금 유저 증가 전망'],
                    charts: [],
                    date: '2022-06-15'
                }],
                '2022-07': [],
                '2022-08': [],
                '2022-09': [{
                    id: 'dark-2022-09-1',
                    title: '블루아카이브 글로벌 성장',
                    summary: ['일본 앱스토어 매출 10위권 진입', '2차 창작 커뮤니티 활성화'],
                    charts: [],
                    date: '2022-09-20'
                }],
                '2022-10': [],
                '2022-11': [],
                '2022-12': [{
                    id: 'dark-2022-12-1',
                    title: '넥슨 연간 전망',
                    summary: ['2022년 연간 매출 9.8조원 예상', '2023년 10조원 돌파 전망'],
                    charts: [],
                    date: '2022-12-15'
                }],
                '2023-01': [],
                '2023-02': [{
                    id: 'dark-2023-02-1',
                    title: '메이플스토리 매출 분석',
                    summary: ['20주년 이벤트 준비 중', '신규 콘텐츠 개발 진행'],
                    charts: [],
                    date: '2023-02-05'
                }],
                '2023-03': [{
                    id: 'dark-2023-03-1',
                    title: '던파 중국 규제 영향',
                    summary: ['미성년자 게임 시간 제한 영향 분석', '넥슨 중국 매출 영향 제한적'],
                    charts: [],
                    date: '2023-03-10'
                }],
                '2023-04': [],
                '2023-05': [{
                    id: 'dark-2023-05-1',
                    title: 'FC온라인 경쟁 분석',
                    summary: ['EA FC 출시 대응 전략', '국내 축구게임 점유율 75% 유지'],
                    charts: [],
                    date: '2023-05-20'
                }],
                '2023-06': [],
                '2023-07': [{
                    id: 'dark-2023-07-1',
                    title: '블루아카이브 1.5주년',
                    summary: ['일본 매출 급증', '글로벌 MAU 500만 돌파', '2차 창작 커뮤니티 활성화', '일본 앱스토어 5위권'],
                    charts: [
                        {
                            title: '월 매출 추이 (억원)',
                            type: 'column',
                            data: [
                                { name: '5월', y: 450 },
                                { name: '6월', y: 520 },
                                { name: '7월', y: 680 }
                            ]
                        },
                        {
                            title: 'MAU 추이 (만명)',
                            type: 'line',
                            data: [
                                { name: '1주년', y: 350 },
                                { name: '1.5주년', y: 500 }
                            ]
                        },
                        {
                            title: '지역별 매출 비중',
                            type: 'pie',
                            data: [
                                { name: '일본', y: 55 },
                                { name: '한국', y: 20 },
                                { name: '글로벌', y: 25 }
                            ]
                        }
                    ],
                    date: '2023-07-10',
                    analysis: `## 블루아카이브 분석

**성장 평가: 매우 긍정적 (★★★★★)**

1.5주년 이벤트로 일본 시장에서 폭발적 성장 기록.

### 핵심 지표

| 지표 | 1주년 | 1.5주년 | 성장률 |
|------|-------|---------|--------|
| MAU | 350만 | 500만 | +42.9% |
| 월매출 | 450억 | 680억 | +51.1% |
| 일본순위 | 10위 | 5위 | +5 |

### 성공 요인
1. **2차 창작**: 동인 커뮤니티 활성화로 바이럴 효과
2. **캐릭터 IP**: 독보적인 일러스트 퀄리티
3. **이벤트 운영**: 유저 친화적 보상 정책`
                }],
                '2023-08': [],
                '2023-09': [{
                    id: 'dark-2023-09-1',
                    title: '퍼스트 디센던트 CBT 분석',
                    summary: ['베타 테스트 유저 반응 분석', '그래픽 호평, 최적화 개선 필요'],
                    charts: [],
                    date: '2023-09-15'
                }],
                '2023-10': [],
                '2023-11': [{
                    id: 'dark-2023-11-1',
                    title: '넥슨 하반기 전망',
                    summary: ['연간 매출 12조원 예상', '2024년 신작 기대감'],
                    charts: [],
                    date: '2023-11-10'
                }],
                '2023-12': [],
                '2024-01': [],
                '2024-02': [{
                    id: 'dark-2024-02-1',
                    title: '메이플 매출 하락 분석',
                    summary: [
                        '메이플스토리 1월 매출 전월 대비 15% 하락',
                        '신규 콘텐츠 부재로 유저 이탈 가속화',
                        '경쟁작 대비 업데이트 주기 늦어',
                        '20주년 이벤트로 반등 기대'
                    ],
                    charts: [
                        {
                            title: '월별 매출 추이 (억원)',
                            type: 'column',
                            data: [
                                { name: '11월', y: 1200 },
                                { name: '12월', y: 1400 },
                                { name: '1월', y: 1190 }
                            ]
                        },
                        {
                            title: 'DAU 추이 (만명)',
                            type: 'line',
                            data: [
                                { name: '11월', y: 45 },
                                { name: '12월', y: 52 },
                                { name: '1월', y: 38 }
                            ]
                        },
                        {
                            title: '경쟁작 대비 점유율',
                            type: 'pie',
                            data: [
                                { name: '메이플', y: 42 },
                                { name: '로아', y: 35 },
                                { name: '기타', y: 23 }
                            ]
                        }
                    ],
                    date: '2024-02-05',
                    analysis: `## 리스크 분석

**위험도 평가: 중간 (⚠️⚠️⚠️)**

메이플스토리 매출 하락은 일시적 현상으로 판단되나, 구조적 문제 가능성도 존재.

### 하락 요인 분석

| 요인 | 영향도 | 지속성 |
|------|--------|--------|
| 콘텐츠 부재 | 높음 | 단기 |
| 경쟁작 출시 | 중간 | 중기 |
| 유저 피로도 | 중간 | 장기 |

### 모니터링 포인트
- 20주년 이벤트 효과 확인 필요
- DAU 추이 지속 관찰
- 경쟁작 대비 점유율 변화

### 대응 전략 제언
신규 콘텐츠 업데이트 주기 단축 및 복귀 유저 이벤트 강화 필요.`
                }],
                '2024-03': [{
                    id: 'dark-2024-03-1',
                    title: '던파 중국 매출 추정',
                    summary: [
                        '던전앤파이터 모바일 중국 매출 월 2,000억원 추정',
                        '텐센트 협력으로 안정적 운영',
                        '신규 직업 업데이트로 매출 상승',
                        '규제 리스크는 제한적'
                    ],
                    charts: [
                        {
                            title: '월 매출 추정 (억원)',
                            type: 'column',
                            data: [
                                { name: '1월', y: 1800 },
                                { name: '2월', y: 2200 },
                                { name: '3월', y: 2000 }
                            ]
                        },
                        {
                            title: '중국 게임 순위',
                            type: 'line',
                            data: [
                                { name: '1월', y: 3 },
                                { name: '2월', y: 2 },
                                { name: '3월', y: 2 }
                            ]
                        },
                        {
                            title: '플랫폼별 비중',
                            type: 'pie',
                            data: [
                                { name: 'iOS', y: 45 },
                                { name: 'Android', y: 55 }
                            ]
                        }
                    ],
                    date: '2024-03-12'
                }],
                '2024-04': [{
                    id: 'dark-2024-04-1',
                    title: '블루아카이브 일본 시장 분석',
                    summary: ['일본 앱스토어 매출 5위권 유지', '일러스트 퀄리티로 2차 창작 활성화'],
                    charts: [],
                    date: '2024-04-05'
                },
                {
                    id: 'dark-2024-04-2',
                    title: '넥슨 인력 구조조정 루머',
                    summary: ['비용 절감 차원 구조조정 진행 추정', '개발 인력 영향은 제한적'],
                    charts: [],
                    date: '2024-04-10'
                },
                {
                    id: 'dark-2024-04-3',
                    title: '퍼스트 디센던트 CBT 분석',
                    summary: ['CBT 유저 피드백 분석', '최적화 이슈 개선 필요'],
                    charts: [],
                    date: '2024-04-15'
                },
                {
                    id: 'dark-2024-04-4',
                    title: '메이플스토리 네오 업데이트 반응',
                    summary: ['신규 콘텐츠 호평', 'DAU 20% 상승'],
                    charts: [],
                    date: '2024-04-20'
                },
                {
                    id: 'dark-2024-04-5',
                    title: '중국 게임 규제 영향 분석',
                    summary: ['미성년자 플레이 시간 제한 강화', '넥슨 중국 매출 영향 제한적'],
                    charts: [],
                    date: '2024-04-25'
                }],
                '2024-05': [{
                    id: 'dark-2024-05-1',
                    title: 'FC온라인 시즌 리포트',
                    summary: [
                        'FC온라인 시즌 전환기 매출 급증',
                        '월드컵 효과로 유저 유입 증가',
                        '경쟁작 EA FC 대비 국내 점유율 우위',
                        'e스포츠 투자 확대 전략'
                    ],
                    charts: [
                        {
                            title: '시즌별 매출 (억원)',
                            type: 'column',
                            data: [
                                { name: '23시즌', y: 3200 },
                                { name: '24시즌', y: 3800 }
                            ]
                        },
                        {
                            title: '신규 유저 추이 (만명)',
                            type: 'line',
                            data: [
                                { name: '3월', y: 12 },
                                { name: '4월', y: 18 },
                                { name: '5월', y: 25 }
                            ]
                        },
                        {
                            title: '국내 축구게임 점유율',
                            type: 'pie',
                            data: [
                                { name: 'FC온라인', y: 72 },
                                { name: 'EA FC', y: 28 }
                            ]
                        }
                    ],
                    date: '2024-05-20'
                }],
                '2024-06': [{
                    id: 'dark-2024-06-1',
                    title: '넥슨 종합 매출 전망',
                    summary: [
                        '2024년 연간 매출 13조원 상회 전망',
                        '퍼스트 디센던트 출시로 하반기 실적 기대',
                        '해외 매출 비중 80% 돌파 예상',
                        '목표주가 상향 조정'
                    ],
                    charts: [
                        {
                            title: 'FCF 분석 (억원)',
                            type: 'waterfall',
                            data: [
                                { name: '영업CF', y: 35000, color: '#4ECDC4' },
                                { name: '감가상각', y: 4000, color: '#4ECDC4' },
                                { name: '투자', y: -8000, color: '#FF6B6B' },
                                { name: '운전자본', y: -2000, color: '#FF6B6B' },
                                { name: 'FCF', isSum: true, color: '#E57B53' }
                            ]
                        },
                        {
                            title: '성장률 비교 (%)',
                            type: 'comparison',
                            categories: ['5년 평균', '최근 1년'],
                            series: [
                                { name: '넥슨', data: [19.2, 14.2], color: '#4ECDC4' },
                                { name: '업계', data: [8.5, 5.3], color: '#5B9BD5' },
                                { name: '시장', data: [9.1, 11.2], color: '#E57B53' }
                            ]
                        },
                        {
                            title: '해외 매출 비중 (%)',
                            type: 'pie',
                            data: [
                                { name: '해외', y: 80 },
                                { name: '국내', y: 20 }
                            ]
                        }
                    ],
                    date: '2024-06-15'
                }],
                '2024-07': [],
                '2024-08': [{
                    id: 'dark-2024-08-1',
                    title: '신작 기대작 분석',
                    summary: [
                        '퍼스트 디센던트 출시 첫 주 매출 500억원',
                        '스팀 동시접속 20만명 달성',
                        '과금 모델에 대한 유저 반응 엇갈려',
                        '장기 운영 전략이 관건'
                    ],
                    charts: [
                        {
                            title: '일별 매출 추이 (억원)',
                            type: 'column',
                            data: [
                                { name: '1일차', y: 120 },
                                { name: '2일차', y: 95 },
                                { name: '3일차', y: 85 },
                                { name: '7일차', y: 70 }
                            ]
                        },
                        {
                            title: '동시접속자 (만명)',
                            type: 'line',
                            data: [
                                { name: '1일차', y: 26 },
                                { name: '2일차', y: 22 },
                                { name: '3일차', y: 20 },
                                { name: '7일차', y: 15 }
                            ]
                        },
                        {
                            title: '플랫폼별 매출 비중',
                            type: 'pie',
                            data: [
                                { name: 'Steam', y: 40 },
                                { name: 'PS5', y: 35 },
                                { name: 'Xbox', y: 25 }
                            ]
                        }
                    ],
                    date: '2024-08-05'
                }],
                '2024-09': [],
                '2024-10': [{
                    id: 'dark-2024-10-1',
                    title: '퍼스트디센던트 매출 분석',
                    summary: [
                        '출시 3개월 누적 매출 2,500억원',
                        '콘솔 플랫폼 매출 비중 60%',
                        '시즌 업데이트로 유저 복귀 증가',
                        '연내 추가 콘텐츠 업데이트 예정'
                    ],
                    charts: [
                        {
                            title: '월별 매출 (억원)',
                            type: 'column',
                            data: [
                                { name: '7월', y: 1200 },
                                { name: '8월', y: 800 },
                                { name: '9월', y: 500 }
                            ]
                        },
                        {
                            title: 'MAU 추이 (만명)',
                            type: 'line',
                            data: [
                                { name: '7월', y: 450 },
                                { name: '8월', y: 280 },
                                { name: '9월', y: 180 }
                            ]
                        },
                        {
                            title: '플랫폼별 매출 비중',
                            type: 'pie',
                            data: [
                                { name: 'PC', y: 40 },
                                { name: 'PS5', y: 35 },
                                { name: 'Xbox', y: 25 }
                            ]
                        }
                    ],
                    date: '2024-10-08'
                }],
                '2024-11': [{
                    id: 'dark-2024-11-1',
                    title: '블루아카이브 글로벌 분석',
                    summary: [
                        '블루아카이브 글로벌 월 매출 800억원',
                        '일본 시장 앱스토어 매출 1위 기록',
                        '2.5주년 이벤트로 복귀 유저 급증',
                        '서브컬처 장르 대표 IP로 성장'
                    ],
                    charts: [
                        {
                            title: '월 매출 추이 (억원)',
                            type: 'column',
                            data: [
                                { name: '9월', y: 650 },
                                { name: '10월', y: 720 },
                                { name: '11월', y: 800 }
                            ]
                        },
                        {
                            title: 'DAU 추이 (만명)',
                            type: 'line',
                            data: [
                                { name: '9월', y: 120 },
                                { name: '10월', y: 145 },
                                { name: '11월', y: 180 }
                            ]
                        },
                        {
                            title: '지역별 매출 비중 (%)',
                            type: 'pie',
                            data: [
                                { name: '일본', y: 50 },
                                { name: '한국', y: 20 },
                                { name: '북미', y: 15 },
                                { name: '기타', y: 15 }
                            ]
                        }
                    ],
                    date: '2024-11-12'
                }],
                '2024-12': []
            },
            policy: {
                '2022-01': [],
                '2022-02': [{
                    id: 'policy-2022-02-1',
                    title: '게임 셧다운제 완화 논의',
                    summary: ['청소년 게임 이용시간 제한 완화 검토', '업계 자율규제 전환 논의'],
                    charts: [],
                    date: '2022-02-15'
                }],
                '2022-03': [],
                '2022-04': [],
                '2022-05': [{
                    id: 'policy-2022-05-1',
                    title: '확률형 아이템 규제 논의',
                    summary: ['확률 공개 의무화 법안 발의', '게임사 자율 공개 확대'],
                    charts: [],
                    date: '2022-05-20'
                }],
                '2022-06': [],
                '2022-07': [],
                '2022-08': [],
                '2022-09': [{
                    id: 'policy-2022-09-1',
                    title: '중국 게임 규제 동향',
                    summary: ['판호 발급 재개', '한국 게임사 진출 기회'],
                    charts: [],
                    date: '2022-09-10'
                }],
                '2022-10': [],
                '2022-11': [],
                '2022-12': [],
                '2023-01': [],
                '2023-02': [],
                '2023-03': [{
                    id: 'policy-2023-03-1',
                    title: '게임산업진흥법 개정',
                    summary: ['게임 이용자 보호 조항 강화', '결제 한도 조정 논의'],
                    charts: [],
                    date: '2023-03-15'
                }],
                '2023-04': [],
                '2023-05': [],
                '2023-06': [{
                    id: 'policy-2023-06-1',
                    title: '셧다운제 폐지 추진',
                    summary: ['청소년 보호법 개정안 발의', '게임 이용 자율화 방향'],
                    charts: [],
                    date: '2023-06-20'
                }],
                '2023-07': [],
                '2023-08': [],
                '2023-09': [],
                '2023-10': [{
                    id: 'policy-2023-10-1',
                    title: '중국 판호 정책 변화',
                    summary: ['판호 발급 건수 증가', '한국 게임사 신청 증가'],
                    charts: [],
                    date: '2023-10-10'
                }],
                '2023-11': [],
                '2023-12': [{
                    id: 'policy-2023-12-1',
                    title: '연말 정책 동향',
                    summary: ['2024년 게임 정책 방향 발표', '산업 지원 확대 예고'],
                    charts: [],
                    date: '2023-12-15'
                }],
                '2024-01': [],
                '2024-02': [],
                '2024-03': [{
                    id: 'policy-2024-03-1',
                    title: '확률형 아이템 규제안 발의',
                    summary: [
                        '국회 확률형 아이템 확률 공개 의무화 법안 발의',
                        '게임사 자율 규제 강화 요구',
                        '넥슨 등 주요 게임사 이미 확률 공개 중',
                        '실제 영향은 제한적일 전망'
                    ],
                    charts: [
                        {
                            title: '확률 공개 현황 (개사)',
                            type: 'column',
                            data: [
                                { name: '공개', y: 45 },
                                { name: '미공개', y: 12 }
                            ]
                        },
                        {
                            title: '규제 영향도 (점)',
                            type: 'line',
                            data: [
                                { name: '넥슨', y: 2 },
                                { name: '엔씨', y: 3 },
                                { name: '크래프톤', y: 2 }
                            ]
                        },
                        {
                            title: '가챠 매출 비중 (%)',
                            type: 'pie',
                            data: [
                                { name: '가챠', y: 35 },
                                { name: '기타', y: 65 }
                            ]
                        }
                    ],
                    date: '2024-03-25'
                }],
                '2024-04': [],
                '2024-05': [],
                '2024-06': [{
                    id: 'policy-2024-06-1',
                    title: '게임산업법 개정 논의',
                    summary: [
                        '게임산업진흥법 개정안 국회 상임위 통과',
                        '게임 이용자 보호 조항 강화',
                        '결제 한도 상향 조정 포함',
                        '업계 의견 수렴 진행 중'
                    ],
                    charts: [
                        {
                            title: '결제 한도 변화 (만원)',
                            type: 'column',
                            data: [
                                { name: '현행', y: 50 },
                                { name: '개정안', y: 100 }
                            ]
                        },
                        {
                            title: '업계 찬반 비율 (%)',
                            type: 'pie',
                            data: [
                                { name: '찬성', y: 68 },
                                { name: '반대', y: 22 },
                                { name: '보류', y: 10 }
                            ]
                        },
                        {
                            title: '민원 건수 추이',
                            type: 'line',
                            data: [
                                { name: '4월', y: 320 },
                                { name: '5월', y: 280 },
                                { name: '6월', y: 195 }
                            ]
                        }
                    ],
                    date: '2024-06-20'
                }],
                '2024-07': [],
                '2024-08': [],
                '2024-09': [{
                    id: 'policy-2024-09-1',
                    title: '중국 판호 정책 완화 소식',
                    summary: [
                        '중국 판호 발급 재개 및 확대',
                        '한국 게임사 신청 가능성 열려',
                        '넥슨 던전앤파이터 모바일 후속작 진출 기대',
                        '단, 실제 발급까지 시간 필요'
                    ],
                    charts: [
                        {
                            title: '월별 판호 발급 건수',
                            type: 'column',
                            data: [
                                { name: '7월', y: 88 },
                                { name: '8월', y: 95 },
                                { name: '9월', y: 102 }
                            ]
                        },
                        {
                            title: '한국게임 발급 추이',
                            type: 'line',
                            data: [
                                { name: '2022', y: 2 },
                                { name: '2023', y: 5 },
                                { name: '2024', y: 8 }
                            ]
                        },
                        {
                            title: '장르별 발급 비중',
                            type: 'pie',
                            data: [
                                { name: 'RPG', y: 45 },
                                { name: '캐주얼', y: 30 },
                                { name: '기타', y: 25 }
                            ]
                        }
                    ],
                    date: '2024-09-10'
                }],
                '2024-10': [],
                '2024-11': [],
                '2024-12': [{
                    id: 'policy-2024-12-1',
                    title: '청소년 보호법 개정',
                    summary: [
                        '게임 셧다운제 폐지 확정',
                        '자율규제 체계로 전환',
                        '게임사 부담 완화 기대',
                        '2025년 시행 예정'
                    ],
                    charts: [
                        {
                            title: '셧다운제 비용 절감 (억원)',
                            type: 'column',
                            data: [
                                { name: '넥슨', y: 45 },
                                { name: '엔씨', y: 38 },
                                { name: '크래프톤', y: 25 }
                            ]
                        },
                        {
                            title: '청소년 이용시간 변화 예상',
                            type: 'line',
                            data: [
                                { name: '현행', y: 2.5 },
                                { name: '개정후', y: 3.2 }
                            ]
                        },
                        {
                            title: '규제 현황 (국가수)',
                            type: 'pie',
                            data: [
                                { name: '규제', y: 3 },
                                { name: '자율', y: 42 }
                            ]
                        }
                    ],
                    date: '2024-12-15'
                }]
            },
            news: {
                '2022-01': [{
                    id: 'news-2022-01-1',
                    title: '메이플스토리 리마스터 업데이트',
                    summary: ['대규모 리마스터 업데이트 진행', '그래픽 및 시스템 개선', '복귀 유저 이벤트'],
                    charts: [],
                    date: '2022-01-20'
                }],
                '2022-02': [],
                '2022-03': [{
                    id: 'news-2022-03-1',
                    title: '넥슨 개발자 컨퍼런스 NDC 2022',
                    summary: ['온라인 개최', '신작 3종 발표', 'AI 기술 세션'],
                    charts: [],
                    date: '2022-03-10'
                }],
                '2022-04': [],
                '2022-05': [{
                    id: 'news-2022-05-1',
                    title: 'FC온라인 시즌 업데이트',
                    summary: ['2022 시즌 대규모 업데이트', '신규 선수 카드 추가'],
                    charts: [],
                    date: '2022-05-15'
                }],
                '2022-06': [],
                '2022-07': [{
                    id: 'news-2022-07-1',
                    title: '블루아카이브 1주년',
                    summary: ['글로벌 1주년 기념 이벤트', '신규 캐릭터 추가', '무료 가챠 이벤트', '일본 트렌드 1위 기록'],
                    charts: [
                        {
                            title: '이벤트 기간 매출 (억원)',
                            type: 'column',
                            data: [
                                { name: '이벤트 전', y: 280 },
                                { name: '이벤트 중', y: 520 }
                            ]
                        },
                        {
                            title: 'DAU 변화 (만명)',
                            type: 'line',
                            data: [
                                { name: '6월', y: 180 },
                                { name: '7월초', y: 250 },
                                { name: '7월말', y: 320 }
                            ]
                        },
                        {
                            title: '신규 캐릭터 인기',
                            type: 'pie',
                            data: [
                                { name: '호시노', y: 40 },
                                { name: '시로코', y: 35 },
                                { name: '기타', y: 25 }
                            ]
                        }
                    ],
                    date: '2022-07-10',
                    analysis: `## 1주년 이벤트 분석

**이벤트 효과: 매우 긍정적 (★★★★★)**

블루아카이브 1주년 이벤트로 DAU 78% 급증, 일본 앱스토어 상위권 진입.

### 이벤트 성과

| 지표 | 이벤트 전 | 이벤트 중 | 증가율 |
|------|----------|----------|--------|
| DAU | 180만 | 320만 | +77.8% |
| 매출 | 280억 | 520억 | +85.7% |
| 신규유저 | 5만/일 | 15만/일 | +200% |

### 마케팅 인사이트
무료 가챠와 신규 캐릭터 조합이 유저 유입과 결제 전환에 효과적.`
                }],
                '2022-08': [],
                '2022-09': [],
                '2022-10': [{
                    id: 'news-2022-10-1',
                    title: '던전앤파이터 신규 직업',
                    summary: ['신규 직업 업데이트', '중국 동시 출시'],
                    charts: [],
                    date: '2022-10-05'
                }],
                '2022-11': [{
                    id: 'news-2022-11-1',
                    title: 'FC온라인 월드컵 이벤트',
                    summary: ['카타르 월드컵 연계 이벤트', '특별 선수 카드 출시'],
                    charts: [],
                    date: '2022-11-20'
                }],
                '2022-12': [],
                '2023-01': [{
                    id: 'news-2023-01-1',
                    title: '메이플스토리 신규 보스',
                    summary: ['신규 보스 콘텐츠 추가', '엔드게임 콘텐츠 강화'],
                    charts: [],
                    date: '2023-01-15'
                }],
                '2023-02': [],
                '2023-03': [{
                    id: 'news-2023-03-1',
                    title: 'NDC 2023 개최',
                    summary: ['넥슨 개발자 컨퍼런스', '퍼스트 디센던트 공개'],
                    charts: [],
                    date: '2023-03-15'
                }],
                '2023-04': [{
                    id: 'news-2023-04-1',
                    title: '블루아카이브 애니메이션 발표',
                    summary: ['애니메이션 제작 발표', '2024년 방영 예정'],
                    charts: [],
                    date: '2023-04-10'
                }],
                '2023-05': [],
                '2023-06': [{
                    id: 'news-2023-06-1',
                    title: 'FC온라인 시즌 전환',
                    summary: ['2023 시즌 업데이트', 'e스포츠 리그 확대'],
                    charts: [],
                    date: '2023-06-15'
                }],
                '2023-07': [{
                    id: 'news-2023-07-1',
                    title: '퍼스트 디센던트 CBT',
                    summary: ['클로즈드 베타 테스트 진행', '글로벌 유저 참여', '스팀 CBT 호평', '그래픽 퀄리티 호평'],
                    charts: [
                        {
                            title: 'CBT 참여자 (만명)',
                            type: 'column',
                            data: [
                                { name: 'PC', y: 45 },
                                { name: 'PS5', y: 30 },
                                { name: 'Xbox', y: 20 }
                            ]
                        },
                        {
                            title: '유저 평가 분포 (%)',
                            type: 'pie',
                            data: [
                                { name: '긍정', y: 72 },
                                { name: '중립', y: 18 },
                                { name: '부정', y: 10 }
                            ]
                        }
                    ],
                    date: '2023-07-20',
                    analysis: `## CBT 분석 리포트

**CBT 평가: 긍정적 (★★★★☆)**

글로벌 95만명 참여, 긍정 평가 72%로 출시 기대감 상승.

### CBT 결과

| 항목 | 수치 | 평가 |
|------|------|------|
| 참여자 | 95만명 | 목표 초과 |
| 긍정률 | 72% | 양호 |
| 플레이타임 | 평균 12시간 | 우수 |

### 피드백 요약
- 그래픽 퀄리티 호평
- 전투 시스템 재미있음
- 최적화 개선 필요
- 콘텐츠 볼륨 확대 요청`
                }],
                '2023-08': [],
                '2023-09': [{
                    id: 'news-2023-09-1',
                    title: '던파 모바일 업데이트',
                    summary: ['대규모 콘텐츠 업데이트', '중국 매출 급증'],
                    charts: [],
                    date: '2023-09-10'
                }],
                '2023-10': [{
                    id: 'news-2023-10-1',
                    title: '메이플스토리 20주년 예고',
                    summary: ['20주년 기념 이벤트 예고', '특별 콘텐츠 준비 중'],
                    charts: [],
                    date: '2023-10-20'
                }],
                '2023-11': [],
                '2023-12': [{
                    id: 'news-2023-12-1',
                    title: '연말 대규모 업데이트',
                    summary: ['주요 게임 연말 이벤트', '2024년 로드맵 공개'],
                    charts: [],
                    date: '2023-12-20'
                }],
                '2024-01': [{
                    id: 'news-2024-01-1',
                    title: '메이플스토리 신규 직업 출시',
                    summary: [
                        '메이플스토리 신규 직업 "라라" 업데이트',
                        '자연 친화 컨셉의 마법사 계열',
                        '출시 첫 주 동시접속 30% 증가',
                        '유저 반응 호평'
                    ],
                    charts: [
                        {
                            title: '동시접속자 변화 (만명)',
                            type: 'column',
                            data: [
                                { name: '출시전', y: 12 },
                                { name: '출시후', y: 15.6 }
                            ]
                        },
                        {
                            title: '신규 캐릭터 생성 수',
                            type: 'line',
                            data: [
                                { name: '1일차', y: 85000 },
                                { name: '3일차', y: 120000 },
                                { name: '7일차', y: 180000 }
                            ]
                        },
                        {
                            title: '직업별 점유율 (%)',
                            type: 'pie',
                            data: [
                                { name: '라라', y: 18 },
                                { name: '기존직업', y: 82 }
                            ]
                        }
                    ],
                    date: '2024-01-18'
                }],
                '2024-02': [],
                '2024-03': [{
                    id: 'news-2024-03-1',
                    title: '넥슨 북미 스튜디오 설립 발표',
                    summary: [
                        'LA에 신규 개발 스튜디오 설립',
                        '글로벌 AAA 게임 개발 목표',
                        '초기 인력 100명 규모',
                        '언리얼 엔진 기반 프로젝트 진행'
                    ],
                    charts: [
                        {
                            title: '해외 스튜디오 투자 (억원)',
                            type: 'column',
                            data: [
                                { name: '2022', y: 800 },
                                { name: '2023', y: 1200 },
                                { name: '2024', y: 1800 }
                            ]
                        },
                        {
                            title: '글로벌 인력 추이 (명)',
                            type: 'line',
                            data: [
                                { name: '2022', y: 350 },
                                { name: '2023', y: 480 },
                                { name: '2024', y: 620 }
                            ]
                        },
                        {
                            title: '지역별 스튜디오 분포',
                            type: 'pie',
                            data: [
                                { name: '한국', y: 65 },
                                { name: '북미', y: 20 },
                                { name: '일본', y: 10 },
                                { name: '유럽', y: 5 }
                            ]
                        }
                    ],
                    date: '2024-03-05'
                }],
                '2024-04': [{
                    id: 'news-2024-04-1',
                    title: '블루아카이브 2주년 이벤트',
                    summary: [
                        '블루아카이브 글로벌 2주년 기념 이벤트',
                        '신규 학생 캐릭터 3종 추가',
                        '2주년 기념 무료 가챠 제공',
                        '실시간 트렌드 1위 기록'
                    ],
                    charts: [
                        {
                            title: '이벤트 기간 매출 (억원)',
                            type: 'column',
                            data: [
                                { name: '이벤트전', y: 180 },
                                { name: '이벤트중', y: 420 }
                            ]
                        },
                        {
                            title: 'DAU 변화 (만명)',
                            type: 'line',
                            data: [
                                { name: '1주전', y: 85 },
                                { name: '이벤트', y: 145 },
                                { name: '1주후', y: 110 }
                            ]
                        },
                        {
                            title: '신규 캐릭터 인기도',
                            type: 'pie',
                            data: [
                                { name: '캐릭터A', y: 45 },
                                { name: '캐릭터B', y: 35 },
                                { name: '캐릭터C', y: 20 }
                            ]
                        }
                    ],
                    date: '2024-04-09'
                }],
                '2024-05': [],
                '2024-06': [{
                    id: 'news-2024-06-1',
                    title: 'FC온라인 시즌 업데이트',
                    summary: [
                        'FC온라인 2024 시즌 대규모 업데이트',
                        '유로 2024 공식 라이선스 콘텐츠',
                        '신규 선수 카드 500종 추가',
                        '시즌 패스 판매 호조'
                    ],
                    charts: [
                        {
                            title: '시즌패스 판매량 (만건)',
                            type: 'column',
                            data: [
                                { name: '23시즌', y: 85 },
                                { name: '24시즌', y: 120 }
                            ]
                        },
                        {
                            title: 'DAU 추이 (만명)',
                            type: 'line',
                            data: [
                                { name: '5월', y: 180 },
                                { name: '6월초', y: 220 },
                                { name: '6월말', y: 245 }
                            ]
                        },
                        {
                            title: '콘텐츠별 이용 비중',
                            type: 'pie',
                            data: [
                                { name: '매치', y: 55 },
                                { name: '팩개봉', y: 30 },
                                { name: '기타', y: 15 }
                            ]
                        }
                    ],
                    date: '2024-06-10'
                }],
                '2024-07': [{
                    id: 'news-2024-07-1',
                    title: '퍼스트 디센던트 출시',
                    summary: [
                        '넥슨 신작 루터 슈터 "퍼스트 디센던트" 정식 출시',
                        'PC, PS5, Xbox 동시 출시',
                        '출시 첫날 스팀 동시접속 10만명',
                        'F2P 모델로 진입 장벽 낮춰'
                    ],
                    charts: [
                        {
                            title: '플랫폼별 다운로드 (만건)',
                            type: 'column',
                            data: [
                                { name: 'Steam', y: 180 },
                                { name: 'PS5', y: 120 },
                                { name: 'Xbox', y: 80 }
                            ]
                        },
                        {
                            title: '동시접속자 추이 (만명)',
                            type: 'line',
                            data: [
                                { name: '1일차', y: 10 },
                                { name: '2일차', y: 18 },
                                { name: '3일차', y: 22 }
                            ]
                        },
                        {
                            title: '지역별 유저 분포',
                            type: 'pie',
                            data: [
                                { name: '북미', y: 35 },
                                { name: '유럽', y: 30 },
                                { name: '아시아', y: 25 },
                                { name: '기타', y: 10 }
                            ]
                        }
                    ],
                    date: '2024-07-02',
                    analysis: `## 출시 영향 분석

**시장 반응: 매우 긍정적 (★★★★★)**

퍼스트 디센던트의 글로벌 동시 출시는 넥슨의 AAA급 게임 개발 역량을 입증.

### 출시 성과

| 지표 | 수치 | 평가 |
|------|------|------|
| 첫날 동접 | 10만명 | 우수 |
| 플랫폼 다운로드 | 380만건 | 초과달성 |
| 스팀 평점 | 7.2/10 | 양호 |

### 성공 요인
1. **멀티플랫폼**: PC, PS5, Xbox 동시 출시로 접근성 극대화
2. **F2P 모델**: 진입 장벽 낮춰 유저 유입 촉진
3. **루터슈터 장르**: 글로벌 인기 장르 진출

### 향후 전망
지속적인 콘텐츠 업데이트가 관건. 시즌제 운영으로 장기 수익 창출 기대.`
                },
                {
                    id: 'news-2024-07-2',
                    title: '넥슨 북미 스튜디오 인수',
                    summary: ['Embark Studios 인수 완료', '3A급 신작 개발 계획'],
                    charts: [],
                    date: '2024-07-05'
                },
                {
                    id: 'news-2024-07-3',
                    title: '메이플스토리 월드 오픈베타',
                    summary: ['유저 제작 콘텐츠 플랫폼 오픈', '초기 반응 호조'],
                    charts: [],
                    date: '2024-07-10'
                },
                {
                    id: 'news-2024-07-4',
                    title: 'EA와 파트너십 확대',
                    summary: ['FC 프랜차이즈 협력 강화', '새로운 스포츠 게임 공동 개발'],
                    charts: [],
                    date: '2024-07-15'
                },
                {
                    id: 'news-2024-07-5',
                    title: '던전앤파이터 모바일 신규 업데이트',
                    summary: ['신규 직업 "다크나이트" 추가', '중국 매출 순위 1위 탈환'],
                    charts: [],
                    date: '2024-07-20'
                },
                {
                    id: 'news-2024-07-6',
                    title: '블루아카이브 2주년 기념 이벤트',
                    summary: ['글로벌 동시 이벤트 진행', '유저 감사 보상 지급'],
                    charts: [],
                    date: '2024-07-25'
                }],
                '2024-08': [{
                    id: 'news-2024-08-1',
                    title: '퍼스트 디센던트 500만 다운로드',
                    summary: [
                        '출시 한 달 만에 글로벌 500만 다운로드 달성',
                        '스팀 최고 동시접속 26만명 기록',
                        '시즌 1 업데이트 예고',
                        '유저 피드백 반영 패치 진행'
                    ],
                    charts: [
                        {
                            title: '누적 다운로드 (만건)',
                            type: 'column',
                            data: [
                                { name: '1주차', y: 200 },
                                { name: '2주차', y: 350 },
                                { name: '4주차', y: 500 }
                            ]
                        },
                        {
                            title: '최고 동시접속 (만명)',
                            type: 'line',
                            data: [
                                { name: '1주차', y: 22 },
                                { name: '2주차', y: 26 },
                                { name: '4주차', y: 18 }
                            ]
                        },
                        {
                            title: '유저 평점 분포',
                            type: 'pie',
                            data: [
                                { name: '긍정', y: 68 },
                                { name: '중립', y: 18 },
                                { name: '부정', y: 14 }
                            ]
                        }
                    ],
                    date: '2024-08-02'
                }],
                '2024-09': [],
                '2024-10': [{
                    id: 'news-2024-10-1',
                    title: '메이플스토리 20주년',
                    summary: [
                        '메이플스토리 서비스 20주년 기념 행사',
                        '오프라인 팬미팅 1만명 참여',
                        '20주년 기념 캐릭터 및 아이템 출시',
                        '20년간의 역사 전시회 개최'
                    ],
                    charts: [
                        {
                            title: '연도별 매출 추이 (억원)',
                            type: 'column',
                            data: [
                                { name: '2014', y: 4500 },
                                { name: '2019', y: 8200 },
                                { name: '2024', y: 12000 }
                            ]
                        },
                        {
                            title: '누적 유저 수 (만명)',
                            type: 'line',
                            data: [
                                { name: '2014', y: 2500 },
                                { name: '2019', y: 4200 },
                                { name: '2024', y: 5800 }
                            ]
                        },
                        {
                            title: '이벤트 참여 비중',
                            type: 'pie',
                            data: [
                                { name: '온라인', y: 85 },
                                { name: '오프라인', y: 15 }
                            ]
                        }
                    ],
                    date: '2024-10-29',
                    analysis: `## 이벤트 영향 분석

**브랜드 가치: 최고 수준 (★★★★★)**

20년간 서비스 지속은 글로벌 게임 업계에서도 이례적인 성과.

### 20주년 성과

| 지표 | 수치 | 의미 |
|------|------|------|
| 누적 유저 | 1.8억명 | 글로벌 Top 5 |
| 서비스 기간 | 20년 | 업계 최장수 |
| 오프라인 참여 | 1만명 | 역대 최대 |

### 브랜드 파워
1. **세대 초월**: 10대부터 30대까지 폭넓은 유저층
2. **문화 아이콘**: 한국 게임 역사의 상징
3. **IP 확장성**: 애니메이션, 굿즈 등 다각화

### 투자 시사점
장수 IP의 안정적 수익 창출 능력 입증. 신규 콘텐츠와 노스탤지어 마케팅 병행으로 지속 성장 가능.`
                }],
                '2024-11': [{
                    id: 'news-2024-11-1',
                    title: '넥슨 개발자 컨퍼런스',
                    summary: [
                        'NDC 2024 온라인 개최',
                        '신작 5종 최초 공개',
                        '차세대 게임 엔진 발표',
                        'AI 기술 활용 사례 공유'
                    ],
                    charts: [
                        {
                            title: '참가자 수 추이 (명)',
                            type: 'column',
                            data: [
                                { name: '2022', y: 8500 },
                                { name: '2023', y: 12000 },
                                { name: '2024', y: 18000 }
                            ]
                        },
                        {
                            title: '세션 수 추이',
                            type: 'line',
                            data: [
                                { name: '2022', y: 85 },
                                { name: '2023', y: 110 },
                                { name: '2024', y: 145 }
                            ]
                        },
                        {
                            title: '분야별 세션 비중',
                            type: 'pie',
                            data: [
                                { name: '개발', y: 45 },
                                { name: 'AI/ML', y: 25 },
                                { name: '아트', y: 20 },
                                { name: '기타', y: 10 }
                            ]
                        }
                    ],
                    date: '2024-11-15'
                }],
                '2024-12': [{
                    id: 'news-2024-12-1',
                    title: '연말 대규모 업데이트',
                    summary: [
                        '주요 게임 연말 대규모 업데이트 일제히 진행',
                        '메이플스토리: 신규 보스 콘텐츠',
                        'FC온라인: 겨울 이벤트',
                        '블루아카이브: 크리스마스 스토리'
                    ],
                    charts: [
                        {
                            title: '게임별 업데이트 규모 (GB)',
                            type: 'column',
                            data: [
                                { name: '메이플', y: 3.2 },
                                { name: 'FC온라인', y: 5.8 },
                                { name: '블루아카', y: 2.1 }
                            ]
                        },
                        {
                            title: '예상 DAU 증가율 (%)',
                            type: 'line',
                            data: [
                                { name: '메이플', y: 25 },
                                { name: 'FC온라인', y: 35 },
                                { name: '블루아카', y: 40 }
                            ]
                        },
                        {
                            title: '콘텐츠 유형별 비중',
                            type: 'pie',
                            data: [
                                { name: '이벤트', y: 50 },
                                { name: '신규콘텐츠', y: 35 },
                                { name: '밸런스', y: 15 }
                            ]
                        }
                    ],
                    date: '2024-12-20'
                }]
            },
            paper: {
                '2022-01': [],
                '2022-02': [{
                    id: 'paper-2022-02-1',
                    title: 'MMORPG 시장 분석 보고서',
                    summary: ['글로벌 MMORPG 시장 트렌드', '메이플스토리 사례 분석'],
                    charts: [],
                    date: '2022-02-10'
                }],
                '2022-03': [],
                '2022-04': [],
                '2022-05': [],
                '2022-06': [{
                    id: 'paper-2022-06-1',
                    title: '모바일 게임 수익 모델 연구',
                    summary: ['F2P 모델 분석', '과금 최적화 전략'],
                    charts: [],
                    date: '2022-06-15'
                }],
                '2022-07': [],
                '2022-08': [],
                '2022-09': [],
                '2022-10': [{
                    id: 'paper-2022-10-1',
                    title: '게임 유저 행동 분석',
                    summary: ['유저 리텐션 요인 분석', '이탈 예측 모델'],
                    charts: [],
                    date: '2022-10-20'
                }],
                '2022-11': [],
                '2022-12': [],
                '2023-01': [],
                '2023-02': [],
                '2023-03': [{
                    id: 'paper-2023-03-1',
                    title: '게임 AI 기술 동향',
                    summary: ['AI NPC 개발 트렌드', '강화학습 적용 사례'],
                    charts: [],
                    date: '2023-03-15'
                }],
                '2023-04': [],
                '2023-05': [],
                '2023-06': [],
                '2023-07': [{
                    id: 'paper-2023-07-1',
                    title: '크로스플랫폼 게임 연구',
                    summary: ['PC-콘솔-모바일 연동 기술', '유저 경험 분석'],
                    charts: [],
                    date: '2023-07-20'
                }],
                '2023-08': [],
                '2023-09': [],
                '2023-10': [],
                '2023-11': [{
                    id: 'paper-2023-11-1',
                    title: '게임 그래픽 기술 발전',
                    summary: ['차세대 렌더링 기술', '실시간 레이트레이싱'],
                    charts: [],
                    date: '2023-11-10'
                }],
                '2023-12': [],
                '2024-01': [],
                '2024-02': [{
                    id: 'paper-2024-02-1',
                    title: 'MMORPG 유저 리텐션 분석',
                    summary: ['메이플스토리 10년 유저 데이터 분석', '리텐션 핵심 요인 도출'],
                    charts: [],
                    date: '2024-02-15'
                }],
                '2024-03': [],
                '2024-04': [],
                '2024-05': [{
                    id: 'paper-2024-05-1',
                    title: '게임 내 경제 시스템 연구',
                    summary: ['가상 경제 인플레이션 모델링', '아이템 가격 안정화 방안'],
                    charts: [],
                    date: '2024-05-20'
                }],
                '2024-06': [],
                '2024-07': [],
                '2024-08': [{
                    id: 'paper-2024-08-1',
                    title: 'AI 기반 NPC 행동 패턴 연구',
                    summary: ['강화학습 기반 NPC 설계', '유저 몰입도 향상 효과 검증'],
                    charts: [],
                    date: '2024-08-10'
                }],
                '2024-09': [],
                '2024-10': [],
                '2024-11': [{
                    id: 'paper-2024-11-1',
                    title: '루터슈터 장르 시장 분석',
                    summary: ['퍼스트 디센던트 성공 요인', '경쟁작 대비 차별점 분석'],
                    charts: [],
                    date: '2024-11-05'
                }],
                '2024-12': []
            },
            patent: {
                '2022-01': [],
                '2022-02': [{
                    id: 'patent-2022-02-1',
                    title: '게임 최적화 기술 특허',
                    summary: ['모바일 게임 렌더링 최적화', '배터리 소모 감소 기술'],
                    charts: [],
                    date: '2022-02-15'
                }],
                '2022-03': [],
                '2022-04': [],
                '2022-05': [{
                    id: 'patent-2022-05-1',
                    title: '실시간 번역 시스템',
                    summary: ['게임 내 다국어 실시간 번역', 'AI 기반 자연어 처리'],
                    charts: [],
                    date: '2022-05-20'
                }],
                '2022-06': [],
                '2022-07': [],
                '2022-08': [],
                '2022-09': [{
                    id: 'patent-2022-09-1',
                    title: '안티치트 시스템 특허',
                    summary: ['비정상 플레이 탐지', '머신러닝 기반 치트 감지'],
                    charts: [],
                    date: '2022-09-10'
                }],
                '2022-10': [],
                '2022-11': [],
                '2022-12': [],
                '2023-01': [],
                '2023-02': [{
                    id: 'patent-2023-02-1',
                    title: '클라우드 게이밍 기술',
                    summary: ['저지연 스트리밍 기술', '적응형 화질 조절'],
                    charts: [],
                    date: '2023-02-15'
                }],
                '2023-03': [],
                '2023-04': [],
                '2023-05': [{
                    id: 'patent-2023-05-1',
                    title: '유저 매칭 알고리즘',
                    summary: ['스킬 기반 매칭', '대기 시간 최적화'],
                    charts: [],
                    date: '2023-05-20'
                }],
                '2023-06': [],
                '2023-07': [],
                '2023-08': [{
                    id: 'patent-2023-08-1',
                    title: 'AI NPC 행동 시스템',
                    summary: ['강화학습 기반 NPC', '동적 난이도 조절'],
                    charts: [],
                    date: '2023-08-15'
                }],
                '2023-09': [],
                '2023-10': [],
                '2023-11': [],
                '2023-12': [{
                    id: 'patent-2023-12-1',
                    title: '멀티플랫폼 동기화',
                    summary: ['크로스 세이브 기술', '실시간 데이터 동기화'],
                    charts: [],
                    date: '2023-12-10'
                }],
                '2024-01': [{
                    id: 'patent-2024-01-1',
                    title: '실시간 매칭 시스템 특허',
                    summary: ['스킬 기반 매칭 알고리즘', '대기 시간 최소화 기술'],
                    charts: [],
                    date: '2024-01-10'
                }],
                '2024-02': [],
                '2024-03': [{
                    id: 'patent-2024-03-1',
                    title: 'AI 기반 게임 밸런싱 특허',
                    summary: ['실시간 밸런스 조정 시스템', '유저 피드백 반영 알고리즘'],
                    charts: [],
                    date: '2024-03-15'
                }],
                '2024-04': [],
                '2024-05': [],
                '2024-06': [{
                    id: 'patent-2024-06-1',
                    title: '크로스플랫폼 세이브 동기화',
                    summary: ['PC-모바일-콘솔 연동 기술', '클라우드 기반 저장 시스템'],
                    charts: [],
                    date: '2024-06-20'
                }],
                '2024-07': [],
                '2024-08': [],
                '2024-09': [{
                    id: 'patent-2024-09-1',
                    title: '게임 내 거래 보안 시스템',
                    summary: ['블록체인 기반 거래 검증', '사기 방지 알고리즘'],
                    charts: [],
                    date: '2024-09-05'
                }],
                '2024-10': [],
                '2024-11': [],
                '2024-12': [{
                    id: 'patent-2024-12-1',
                    title: '차세대 렌더링 엔진 특허',
                    summary: ['실시간 레이트레이싱 최적화', '모바일 적용 기술'],
                    charts: [],
                    date: '2024-12-10'
                }]
            },
            sec: {
                '2022-01': [],
                '2022-02': [],
                '2022-03': [{
                    id: 'sec-2022-03-1',
                    title: 'Form 20-F 연차보고서',
                    summary: ['2021 회계연도 실적 보고', 'SEC 제출 완료'],
                    charts: [],
                    date: '2022-03-31'
                }],
                '2022-04': [{
                    id: 'sec-2022-04-1',
                    title: 'Form 6-K 수시보고',
                    summary: ['1분기 실적 발표', '주요 경영사항 공시'],
                    charts: [],
                    date: '2022-04-20'
                }],
                '2022-05': [],
                '2022-06': [],
                '2022-07': [{
                    id: 'sec-2022-07-1',
                    title: 'Form 6-K 수시보고',
                    summary: ['2분기 실적 발표', '신작 개발 현황'],
                    charts: [],
                    date: '2022-07-25'
                }],
                '2022-08': [],
                '2022-09': [],
                '2022-10': [{
                    id: 'sec-2022-10-1',
                    title: 'Form 6-K 수시보고',
                    summary: ['3분기 실적 발표', '해외 사업 확장'],
                    charts: [],
                    date: '2022-10-28'
                }],
                '2022-11': [],
                '2022-12': [],
                '2023-01': [],
                '2023-02': [],
                '2023-03': [{
                    id: 'sec-2023-03-1',
                    title: 'Form 20-F 연차보고서',
                    summary: ['2022 회계연도 실적 보고', 'SEC 제출 완료'],
                    charts: [],
                    date: '2023-03-31'
                }],
                '2023-04': [{
                    id: 'sec-2023-04-1',
                    title: 'Form 6-K 수시보고',
                    summary: ['1분기 실적 발표', '신작 라인업 공개'],
                    charts: [],
                    date: '2023-04-20'
                }],
                '2023-05': [],
                '2023-06': [],
                '2023-07': [{
                    id: 'sec-2023-07-1',
                    title: 'Form 6-K 수시보고',
                    summary: ['2분기 실적 발표', '글로벌 매출 성장'],
                    charts: [],
                    date: '2023-07-25'
                }],
                '2023-08': [],
                '2023-09': [],
                '2023-10': [{
                    id: 'sec-2023-10-1',
                    title: 'Form 6-K 수시보고',
                    summary: ['3분기 실적 발표', '연간 가이던스 상향'],
                    charts: [],
                    date: '2023-10-28'
                }],
                '2023-11': [],
                '2023-12': [],
                '2024-01': [],
                '2024-02': [],
                '2024-03': [{
                    id: 'sec-2024-03-1',
                    title: 'Form 20-F 연차보고서',
                    summary: ['2023 회계연도 실적 보고', 'SEC 제출 완료'],
                    charts: [],
                    date: '2024-03-31'
                }],
                '2024-04': [{
                    id: 'sec-2024-04-1',
                    title: 'Form 6-K 수시보고',
                    summary: ['1분기 실적 발표', '주요 경영사항 공시'],
                    charts: [],
                    date: '2024-04-20'
                }],
                '2024-05': [],
                '2024-06': [],
                '2024-07': [{
                    id: 'sec-2024-07-1',
                    title: 'Form 6-K 수시보고',
                    summary: ['2분기 실적 발표', '신작 출시 관련 공시'],
                    charts: [],
                    date: '2024-07-25'
                }],
                '2024-08': [],
                '2024-09': [],
                '2024-10': [{
                    id: 'sec-2024-10-1',
                    title: 'Form 6-K 수시보고',
                    summary: ['3분기 실적 발표', '자사주 매입 계획 공시'],
                    charts: [],
                    date: '2024-10-28'
                }],
                '2024-11': [],
                '2024-12': []
            },
            edinet: {
                '2022-01': [],
                '2022-02': [{
                    id: 'edinet-2022-02-1',
                    title: '유가증권보고서 (일본법인)',
                    summary: ['넥슨 재팬 2021년 실적', '일본 시장 매출 분석'],
                    charts: [],
                    date: '2022-02-28'
                }],
                '2022-03': [],
                '2022-04': [],
                '2022-05': [{
                    id: 'edinet-2022-05-1',
                    title: '분기보고서 Q1',
                    summary: ['일본법인 1분기 실적', '블루아카이브 출시 효과'],
                    charts: [],
                    date: '2022-05-15'
                }],
                '2022-06': [],
                '2022-07': [],
                '2022-08': [{
                    id: 'edinet-2022-08-1',
                    title: '분기보고서 Q2',
                    summary: ['일본법인 2분기 실적', '서브컬처 게임 성장'],
                    charts: [],
                    date: '2022-08-14'
                }],
                '2022-09': [],
                '2022-10': [],
                '2022-11': [{
                    id: 'edinet-2022-11-1',
                    title: '분기보고서 Q3',
                    summary: ['일본법인 3분기 실적', '블루아카이브 1주년 효과'],
                    charts: [],
                    date: '2022-11-14'
                }],
                '2022-12': [],
                '2023-01': [],
                '2023-02': [{
                    id: 'edinet-2023-02-1',
                    title: '유가증권보고서 (일본법인)',
                    summary: ['넥슨 재팬 2022년 실적', '일본 시장 매출 분석'],
                    charts: [],
                    date: '2023-02-28'
                }],
                '2023-03': [],
                '2023-04': [],
                '2023-05': [{
                    id: 'edinet-2023-05-1',
                    title: '분기보고서 Q1',
                    summary: ['일본법인 1분기 실적', '블루아카이브 매출 호조'],
                    charts: [],
                    date: '2023-05-15'
                }],
                '2023-06': [],
                '2023-07': [],
                '2023-08': [{
                    id: 'edinet-2023-08-1',
                    title: '분기보고서 Q2',
                    summary: ['일본법인 2분기 실적', '서브컬처 시장 선두'],
                    charts: [],
                    date: '2023-08-14'
                }],
                '2023-09': [],
                '2023-10': [],
                '2023-11': [{
                    id: 'edinet-2023-11-1',
                    title: '분기보고서 Q3',
                    summary: ['일본법인 3분기 실적', '블루아카이브 애니 발표 효과'],
                    charts: [],
                    date: '2023-11-14'
                }],
                '2023-12': [],
                '2024-01': [],
                '2024-02': [{
                    id: 'edinet-2024-02-1',
                    title: '유가증권보고서 (일본법인)',
                    summary: ['넥슨 재팬 2023년 실적', '일본 시장 매출 분석'],
                    charts: [],
                    date: '2024-02-28'
                }],
                '2024-03': [],
                '2024-04': [],
                '2024-05': [{
                    id: 'edinet-2024-05-1',
                    title: '분기보고서 Q1',
                    summary: ['일본법인 1분기 실적', '블루아카이브 매출 호조'],
                    charts: [],
                    date: '2024-05-15'
                }],
                '2024-06': [],
                '2024-07': [],
                '2024-08': [{
                    id: 'edinet-2024-08-1',
                    title: '분기보고서 Q2',
                    summary: ['일본법인 2분기 실적', '퍼스트 디센던트 일본 출시 효과'],
                    charts: [],
                    date: '2024-08-14'
                }],
                '2024-09': [],
                '2024-10': [],
                '2024-11': [{
                    id: 'edinet-2024-11-1',
                    title: '분기보고서 Q3',
                    summary: ['일본법인 3분기 실적', '메이플 20주년 이벤트 효과'],
                    charts: [],
                    date: '2024-11-14'
                }],
                '2024-12': []
            }
        };

        // 간단한 마크다운 파서
        function parseMarkdown(text) {
            if (!text) return '';

            let html = text
                // 테이블 처리
                .replace(/\|(.+)\|\n\|[-:| ]+\|\n((?:\|.+\|\n?)+)/g, (match, header, body) => {
                    const headers = header.split('|').filter(h => h.trim());
                    const rows = body.trim().split('\n').map(row =>
                        row.split('|').filter(c => c.trim())
                    );
                    return `<table class="analysis-table">
                        <thead><tr>${headers.map(h => `<th>${h.trim()}</th>`).join('')}</tr></thead>
                        <tbody>${rows.map(row => `<tr>${row.map(c => `<td>${c.trim()}</td>`).join('')}</tr>`).join('')}</tbody>
                    </table>`;
                })
                // h2 (##)
                .replace(/^## (.+)$/gm, '<h4>$1</h4>')
                // h3 (###)
                .replace(/^### (.+)$/gm, '<h5>$1</h5>')
                // 굵은 글씨 (**)
                .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                // 순서 있는 리스트
                .replace(/^\d+\. (.+)$/gm, '<li>$1</li>')
                // 순서 없는 리스트 (-)
                .replace(/^- (.+)$/gm, '<li>$1</li>')
                // 연속된 li를 ul/ol로 감싸기
                .replace(/(<li>.+<\/li>\n?)+/g, '<ul>$&</ul>')
                // 줄바꿈
                .replace(/\n\n/g, '</p><p>')
                .replace(/\n/g, '<br>');

            return `<p>${html}</p>`;
        }

        // 넥슨 주가 더미 데이터 생성
        function generateStockData() {
            const data = [];
            const startDate = new Date('2022-01-01');
            const endDate = new Date('2024-12-31');
            let price = 180000; // 시작 가격 (원)

            for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {
                if (d.getDay() !== 0 && d.getDay() !== 6) { // 주말 제외
                    const change = (Math.random() - 0.48) * 5000;
                    price = Math.max(150000, Math.min(250000, price + change));
                    data.push([d.getTime(), Math.round(price)]);
                }
            }
            return data;
        }

        // USD/KRW 환율 더미 데이터 생성
        function generateExchangeRateData() {
            const data = [];
            const startDate = new Date('2022-01-01');
            const endDate = new Date('2024-12-31');
            let rate = 1320; // 시작 환율

            for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {
                if (d.getDay() !== 0 && d.getDay() !== 6) { // 주말 제외
                    const change = (Math.random() - 0.5) * 15;
                    rate = Math.max(1280, Math.min(1400, rate + change));
                    data.push([d.getTime(), Math.round(rate * 100) / 100]);
                }
            }
            return data;
        }

        // 테이블 렌더링
        function renderTable(min, max) {
            const startDate = new Date(min);
            const endDate = new Date(max);

            let columns = [];
            // 선택된 기간 사용
            const grain = selectedPeriod;

            // 컬럼 생성
            if (grain === 'day') {
                // 일별: 각 날짜마다 컬럼
                let current = new Date(startDate);
                while (current <= endDate) {
                    columns.push({
                        label: `${current.getMonth() + 1}/${current.getDate()}`,
                        key: `${current.getFullYear()}-${String(current.getMonth() + 1).padStart(2, '0')}-${String(current.getDate()).padStart(2, '0')}`
                    });
                    current.setDate(current.getDate() + 1);
                }
            } else if (grain === 'month') {
                // 월별
                let current = new Date(startDate.getFullYear(), startDate.getMonth(), 1);
                while (current <= endDate) {
                    const monthKey = `${current.getFullYear()}-${String(current.getMonth() + 1).padStart(2, '0')}`;
                    columns.push({
                        label: `${current.getMonth() + 1}월`,
                        key: monthKey
                    });
                    current.setMonth(current.getMonth() + 1);
                }
            } else if (grain === 'quarter') {
                // 분기별
                let current = new Date(startDate.getFullYear(), Math.floor(startDate.getMonth() / 3) * 3, 1);
                while (current <= endDate) {
                    const quarter = Math.floor(current.getMonth() / 3) + 1;
                    columns.push({
                        label: `${current.getFullYear()} Q${quarter}`,
                        key: `${current.getFullYear()}-Q${quarter}`
                    });
                    current.setMonth(current.getMonth() + 3);
                }
            } else if (grain === 'year') {
                // 연별: 각 연도마다 컬럼
                let current = new Date(startDate.getFullYear(), 0, 1);
                while (current <= endDate) {
                    columns.push({
                        label: `${current.getFullYear()}`,
                        key: `${current.getFullYear()}`
                    });
                    current.setFullYear(current.getFullYear() + 1);
                }
            }

            const table = document.getElementById('dataTable');
            // 활성화된 출처만 표시 (기본 출처 + 커스텀 출처)
            const sources = [...activeSources.filter(s => defaultSources.includes(s)), ...Object.keys(customSources).filter(s => activeSources.includes(s))];
            const sourceNamesShort = {
                dart: '공시',
                darkReport: '다크리포트',
                policy: '정책/규제',
                paper: '논문',
                patent: '특허',
                sec: 'SEC',
                edinet: 'EDINET',
                ...Object.fromEntries(Object.entries(customSources).map(([k, v]) => [k, v.name]))
            };

            let html = `<thead><tr><th>
                <div class="period-selector">
                    <button class="period-btn${selectedPeriod === 'day' ? ' active' : ''}" data-period="day">D</button>
                    <button class="period-btn${selectedPeriod === 'month' ? ' active' : ''}" data-period="month">M</button>
                    <button class="period-btn${selectedPeriod === 'quarter' ? ' active' : ''}" data-period="quarter">Q</button>
                    <button class="period-btn${selectedPeriod === 'year' ? ' active' : ''}" data-period="year">Y</button>
                </div>
                <div class="source-manager-container">
                    <button class="source-manager-btn" onclick="toggleSourceManager(event)">
                        <span>출처</span>
                        <span style="font-size: 9px;">▼</span>
                    </button>
                    <div class="source-manager-panel" id="sourceManagerPanel">
                        <!-- 패널 내용은 renderSourceManagerPanel()에서 생성 -->
                    </div>
                </div>
            </th>`;
            columns.forEach(col => {
                html += `<th class="period-header" onclick="handlePeriodHeaderClick('${col.key}', '${grain}')">${col.label}</th>`;
            });
            html += '</tr></thead><tbody>';

            sources.forEach(src => {
                const isCustom = Object.keys(customSources).includes(src);
                html += `<tr><td class="source-name" onclick="showSourceDetail('${src}')">${sourceNamesShort[src]}</td>`;
                columns.forEach(col => {
                    const events = getEventsForPeriod(src, col.key, grain);
                    const count = events.length;
                    if (count > 0) {
                        const tooltipText = getTooltipText(events);
                        const cellContent = getCellPreview(events);
                        html += `<td class="has-data" title="${tooltipText}" onclick="handleCellClick(event, '${src}', '${col.key}', '${grain}')">${cellContent}</td>`;
                    } else {
                        html += '<td>-</td>';
                    }
                });
                html += '</tr>';
            });

            html += '</tbody>';
            table.innerHTML = html;

            // 출처 관리 패널 렌더링
            renderSourceManagerPanel();
        }

        // 출처 클릭 시 보고서 목록 표시
        function showSourceDetail(source) {
            const container = document.getElementById('sourceDetailContainer');
            // 기본 출처 또는 커스텀 출처 데이터 조회
            const data = sourceData[source] || customSourceData[source];
            const events = eventData[source] || customEventData[source];

            if (!data || !events) return;

            // eventData에서 모든 이벤트 수집
            const allEvents = [];
            Object.keys(events).forEach(key => {
                events[key].forEach(event => {
                    allEvents.push(event);
                });
            });

            // 날짜 역순 정렬 (최신순)
            allEvents.sort((a, b) => new Date(b.date) - new Date(a.date));

            let html = `<div class="source-detail">
                <h4>${data.name} (${allEvents.length}건)</h4>
                <ul>`;

            allEvents.forEach(event => {
                // 날짜 포맷: YYYY-MM-DD → MM.DD
                const dateStr = event.date ? event.date.substring(5).replace('-', '.') : '';

                // 매출액 관련 항목 추출 (summary에서 '매출' 또는 '조원' 포함 항목)
                const revenueItem = event.summary ?
                    event.summary.find(s => s.includes('매출') || s.includes('조원')) : null;
                const revenueText = revenueItem ? ` · ${revenueItem}` : '';

                const monthKey = event.date ? event.date.substring(0, 7) : '';
                const isCustom = source.startsWith('custom_');
                const dataSource = isCustom ? 'customEventData' : 'eventData';

                html += `<li class="source-item" onclick="showDetail(${dataSource}['${source}']['${monthKey}'].find(e => e.id === '${event.id}'), '${source}')">
                    <span class="source-item-date">${dateStr}</span>
                    <span class="source-item-title">${event.title}</span>
                    <span class="source-item-revenue">${revenueText}</span>
                </li>`;
            });

            html += '</ul></div>';
            container.innerHTML = html;
            container.classList.add('active');
        }

        // 기간별 이벤트 조회
        function getEventsForPeriod(source, key, grain) {
            const events = [];
            // 기본 출처 또는 커스텀 출처 데이터 조회
            const data = eventData[source] || customEventData[source];

            if (!data) return events;

            if (grain === 'day') {
                // 일별: YYYY-MM-DD 키에서 해당 월 데이터 내 특정 날짜 필터
                const [year, month, day] = key.split('-');
                const monthKey = `${year}-${month}`;
                if (data[monthKey]) {
                    events.push(...data[monthKey].filter(e => {
                        if (e.date) {
                            const eventDate = new Date(e.date);
                            return eventDate.getDate() === parseInt(day);
                        }
                        return false;
                    }));
                }
            } else if (grain === 'month') {
                // 월별
                if (data[key]) {
                    events.push(...data[key]);
                }
            } else if (grain === 'quarter') {
                // 분기별
                const [year, q] = key.split('-Q');
                const quarter = parseInt(q);
                const months = [(quarter - 1) * 3 + 1, (quarter - 1) * 3 + 2, (quarter - 1) * 3 + 3];
                months.forEach(m => {
                    const monthKey = `${year}-${String(m).padStart(2, '0')}`;
                    if (data[monthKey]) {
                        events.push(...data[monthKey]);
                    }
                });
            } else if (grain === 'year') {
                // 연별: 해당 연도의 모든 월 데이터 집계
                const year = key;
                for (let m = 1; m <= 12; m++) {
                    const monthKey = `${year}-${String(m).padStart(2, '0')}`;
                    if (data[monthKey]) {
                        events.push(...data[monthKey]);
                    }
                }
            }

            return events;
        }

        // 툴팁 텍스트 생성
        function getTooltipText(events) {
            if (events.length === 0) return '';
            const firstTitle = events[0].title;
            if (events.length === 1) {
                return firstTitle;
            }
            return `${firstTitle} 외 ${events.length - 1}건`;
        }

        // 셀 미리보기 생성
        function getCellPreview(events) {
            if (events.length === 0) return '-';
            return `<span class="cell-count">${events.length}건</span>`;
        }

        // 출처명 매핑
        const sourceNames = {
            dart: '공시(DART)',
            darkReport: '다크리포트',
            policy: '정책/규제',
            paper: '논문',
            patent: '특허',
            sec: 'SEC',
            edinet: 'EDINET'
        };

        // ===== 출처 관리 기능 =====

        // 출처 관리 패널 토글
        function toggleSourceManager(event) {
            event.stopPropagation();
            const panel = document.getElementById('sourceManagerPanel');
            const btn = event.currentTarget;
            panel.classList.toggle('visible');
            btn.classList.toggle('active');
        }

        // 출처 관리 패널 렌더링
        function renderSourceManagerPanel() {
            const panel = document.getElementById('sourceManagerPanel');
            if (!panel) return;

            let html = `
                <div class="source-manager-section">
                    <div class="source-manager-section-title">기본 출처</div>
                    ${defaultSources.map(src => `
                        <label class="source-checkbox-item">
                            <input type="checkbox" ${activeSources.includes(src) ? 'checked' : ''}
                                   onchange="toggleSource('${src}')" />
                            <span>${sourceNames[src] || src}</span>
                        </label>
                    `).join('')}
                </div>
            `;

            // 커스텀 출처가 있으면 표시
            const customKeys = Object.keys(customSources);
            if (customKeys.length > 0) {
                html += `
                    <div class="source-manager-divider"></div>
                    <div class="source-manager-section">
                        <div class="source-manager-section-title">커스텀 출처</div>
                        ${customKeys.map(key => `
                            <div class="source-checkbox-item custom">
                                <label style="display: flex; align-items: center; gap: 8px; flex: 1;">
                                    <input type="checkbox" ${activeSources.includes(key) ? 'checked' : ''}
                                           onchange="toggleSource('${key}')" />
                                    <span>${customSources[key].name}</span>
                                </label>
                                <button class="delete-btn" onclick="removeCustomSource('${key}')" title="삭제">×</button>
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            html += `
                <div class="source-manager-divider"></div>
                <button class="upload-btn" onclick="showUploadModal()">
                    <span>+</span>
                    <span>데이터 업로드</span>
                </button>
            `;

            panel.innerHTML = html;
        }

        // 출처 토글
        function toggleSource(sourceKey) {
            const idx = activeSources.indexOf(sourceKey);
            if (idx > -1) {
                activeSources.splice(idx, 1);
            } else {
                activeSources.push(sourceKey);
            }
            // 테이블 다시 렌더링
            if (window.stockChart) {
                const extremes = window.stockChart.xAxis[0].getExtremes();
                renderTable(extremes.min, extremes.max);
            }
        }

        // 업로드 모달 표시
        function showUploadModal() {
            // 패널 닫기
            const panel = document.getElementById('sourceManagerPanel');
            const btn = document.querySelector('.source-manager-btn');
            if (panel) panel.classList.remove('visible');
            if (btn) btn.classList.remove('active');

            // 모달이 없으면 생성
            let modal = document.getElementById('uploadModalOverlay');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'uploadModalOverlay';
                modal.className = 'upload-modal-overlay';
                modal.innerHTML = `
                    <div class="upload-modal">
                        <div class="upload-modal-header">
                            <span class="upload-modal-title">데이터 업로드</span>
                            <button class="upload-modal-close" onclick="hideUploadModal()">×</button>
                        </div>
                        <div class="upload-form-group">
                            <label class="upload-form-label">출처명 *</label>
                            <input type="text" class="upload-form-input" id="uploadSourceName"
                                   placeholder="예: 내부 보고서, 리서치 자료" />
                        </div>
                        <div class="upload-form-group">
                            <label class="upload-form-label">파일 선택</label>
                            <div class="upload-dropzone" id="uploadDropzone" onclick="document.getElementById('uploadFileInput').click()">
                                <div class="upload-dropzone-text">클릭하여 파일 선택</div>
                                <div class="upload-dropzone-hint">CSV, JSON, Excel (.xlsx) 지원</div>
                            </div>
                            <input type="file" id="uploadFileInput" style="display: none;"
                                   accept=".csv,.json,.xlsx" onchange="handleFileSelect(event)" />
                            <div class="upload-file-info" id="uploadFileInfo" style="display: none;">
                                <span class="upload-file-name" id="uploadFileName"></span>
                                <button class="upload-file-remove" onclick="clearFileSelection()">×</button>
                            </div>
                            <div class="upload-format-info">
                                <strong>데이터 형식:</strong><br>
                                • CSV/Excel: date, title, summary 컬럼<br>
                                • JSON: [{ date, title, summary }] 배열<br>
                                <em style="color: var(--claude-orange);">파일 없이 출처명만 입력하면 샘플 데이터로 추가됩니다.</em>
                            </div>
                        </div>
                        <div class="upload-modal-actions">
                            <button class="upload-modal-btn cancel" onclick="hideUploadModal()">취소</button>
                            <button class="upload-modal-btn submit" id="uploadSubmitBtn" onclick="submitUpload()">추가</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);

                // 드래그 앤 드롭 이벤트
                const dropzone = modal.querySelector('#uploadDropzone');
                dropzone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    dropzone.classList.add('dragover');
                });
                dropzone.addEventListener('dragleave', () => {
                    dropzone.classList.remove('dragover');
                });
                dropzone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    dropzone.classList.remove('dragover');
                    if (e.dataTransfer.files.length > 0) {
                        handleFileSelectDrop(e.dataTransfer.files[0]);
                    }
                });

                // 오버레이 클릭 시 닫기
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) hideUploadModal();
                });
            }

            // 폼 초기화
            document.getElementById('uploadSourceName').value = '';
            clearFileSelection();

            // 모달 표시
            modal.classList.add('visible');
        }

        // 업로드 모달 숨기기
        function hideUploadModal() {
            const modal = document.getElementById('uploadModalOverlay');
            if (modal) {
                modal.classList.remove('visible');
            }
        }

        // 선택된 파일 정보 저장
        let selectedUploadFile = null;

        // 파일 선택 처리
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                handleFileSelectDrop(file);
            }
        }

        function handleFileSelectDrop(file) {
            selectedUploadFile = file;
            document.getElementById('uploadFileName').textContent = file.name;
            document.getElementById('uploadFileInfo').style.display = 'flex';
            document.getElementById('uploadDropzone').style.display = 'none';
        }

        // 파일 선택 취소
        function clearFileSelection() {
            selectedUploadFile = null;
            document.getElementById('uploadFileInput').value = '';
            document.getElementById('uploadFileInfo').style.display = 'none';
            document.getElementById('uploadDropzone').style.display = 'block';
        }

        // 업로드 제출
        function submitUpload() {
            const sourceName = document.getElementById('uploadSourceName').value.trim();
            if (!sourceName) {
                alert('출처명을 입력해주세요.');
                return;
            }

            // 고유 키 생성
            const sourceKey = 'custom_' + Date.now();

            if (selectedUploadFile) {
                // 파일이 있으면 파싱
                parseUploadedFile(selectedUploadFile, sourceKey, sourceName);
            } else {
                // 파일이 없으면 샘플 데이터로 추가
                addCustomSourceWithSampleData(sourceKey, sourceName);
            }

            hideUploadModal();
        }

        // 파일 파싱
        function parseUploadedFile(file, sourceKey, sourceName) {
            const reader = new FileReader();
            const extension = file.name.split('.').pop().toLowerCase();

            reader.onload = function(e) {
                let events = [];

                try {
                    if (extension === 'json') {
                        events = parseJSON(e.target.result);
                    } else if (extension === 'csv') {
                        events = parseCSV(e.target.result);
                    } else if (extension === 'xlsx') {
                        // Excel 파싱은 라이브러리 필요 - 데모용 샘플 데이터 사용
                        console.log('Excel 파일은 데모 모드에서 샘플 데이터로 대체됩니다.');
                        addCustomSourceWithSampleData(sourceKey, sourceName);
                        return;
                    }

                    if (events.length > 0) {
                        addCustomSource(sourceKey, sourceName, events);
                    } else {
                        addCustomSourceWithSampleData(sourceKey, sourceName);
                    }
                } catch (error) {
                    console.error('파일 파싱 오류:', error);
                    addCustomSourceWithSampleData(sourceKey, sourceName);
                }
            };

            reader.readAsText(file);
        }

        // CSV 파싱
        function parseCSV(content) {
            const lines = content.trim().split('\n');
            if (lines.length < 2) return [];

            const headers = lines[0].split(',').map(h => h.trim().toLowerCase());
            const dateIdx = headers.indexOf('date');
            const titleIdx = headers.indexOf('title');
            const summaryIdx = headers.indexOf('summary');

            if (dateIdx === -1 || titleIdx === -1) return [];

            const events = [];
            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',');
                if (values.length >= 2) {
                    events.push({
                        id: `custom-${Date.now()}-${i}`,
                        date: values[dateIdx]?.trim() || '',
                        title: values[titleIdx]?.trim() || '',
                        summary: summaryIdx > -1 && values[summaryIdx] ?
                            values[summaryIdx].trim().split(';').map(s => s.trim()) : []
                    });
                }
            }
            return events;
        }

        // JSON 파싱
        function parseJSON(content) {
            const data = JSON.parse(content);
            const arr = Array.isArray(data) ? data : [data];

            return arr.map((item, idx) => ({
                id: `custom-${Date.now()}-${idx}`,
                date: item.date || '',
                title: item.title || '',
                summary: Array.isArray(item.summary) ? item.summary :
                    (item.summary ? [item.summary] : [])
            }));
        }

        // 커스텀 출처 추가 (파싱된 데이터)
        function addCustomSource(sourceKey, sourceName, events) {
            // 커스텀 출처 등록
            customSources[sourceKey] = { name: sourceName };
            customSourceData[sourceKey] = { name: sourceName, items: events.map(e => e.title) };

            // 이벤트 데이터를 월별로 그룹화
            const groupedEvents = {};
            events.forEach(event => {
                if (event.date) {
                    const monthKey = event.date.substring(0, 7);
                    if (!groupedEvents[monthKey]) {
                        groupedEvents[monthKey] = [];
                    }
                    groupedEvents[monthKey].push(event);
                }
            });
            customEventData[sourceKey] = groupedEvents;

            // 활성 출처에 추가
            if (!activeSources.includes(sourceKey)) {
                activeSources.push(sourceKey);
            }

            // 테이블 다시 렌더링
            if (window.stockChart) {
                const extremes = window.stockChart.xAxis[0].getExtremes();
                renderTable(extremes.min, extremes.max);
            }
        }

        // 샘플 데이터로 커스텀 출처 추가
        function addCustomSourceWithSampleData(sourceKey, sourceName) {
            const sampleEvents = [
                {
                    id: `${sourceKey}-sample-1`,
                    date: '2024-01-15',
                    title: `${sourceName} - 샘플 보고서 1`,
                    summary: ['샘플 데이터입니다', '실제 파일을 업로드하면 대체됩니다']
                },
                {
                    id: `${sourceKey}-sample-2`,
                    date: '2024-02-20',
                    title: `${sourceName} - 샘플 보고서 2`,
                    summary: ['2월 샘플 데이터']
                },
                {
                    id: `${sourceKey}-sample-3`,
                    date: '2024-03-10',
                    title: `${sourceName} - 샘플 보고서 3`,
                    summary: ['3월 샘플 데이터']
                }
            ];

            addCustomSource(sourceKey, sourceName, sampleEvents);
        }

        // 커스텀 출처 삭제
        function removeCustomSource(sourceKey) {
            if (!confirm('이 출처를 삭제하시겠습니까?')) return;

            delete customSources[sourceKey];
            delete customSourceData[sourceKey];
            delete customEventData[sourceKey];

            // 활성 출처에서 제거
            const idx = activeSources.indexOf(sourceKey);
            if (idx > -1) {
                activeSources.splice(idx, 1);
            }

            // 테이블 다시 렌더링
            if (window.stockChart) {
                const extremes = window.stockChart.xAxis[0].getExtremes();
                renderTable(extremes.min, extremes.max);
            }
        }

        // 패널 외부 클릭 시 닫기
        document.addEventListener('click', function(e) {
            const panel = document.getElementById('sourceManagerPanel');
            const btn = document.querySelector('.source-manager-btn');
            if (panel && !panel.contains(e.target) && (!btn || !btn.contains(e.target))) {
                panel.classList.remove('visible');
                if (btn) btn.classList.remove('active');
            }
        });

        // ===== 출처 관리 기능 끝 =====

        // 셀 클릭 핸들러
        function handleCellClick(event, source, key, grain) {
            const events = getEventsForPeriod(source, key, grain);
            if (events.length === 0) return;

            if (events.length === 1) {
                // 항목이 1개면 바로 상세보기 표시
                showDetail(events[0], source);
                hidePopover();
            } else {
                // 항목이 2개 이상이면 팝오버 표시
                showPopover(event, source, key, grain, events);
            }

            event.stopPropagation();
        }

        // 팝오버 표시
        function showPopover(event, source, key, grain, events) {
            const popover = document.getElementById('popover');
            const title = document.getElementById('popoverTitle');
            const content = document.getElementById('popoverContent');

            // 헤더: "공시(DART) · 1월" 형식
            const monthLabel = key.includes('-Q') ? key : key.split('-')[1] + '월';
            const sourceName = sourceNames[source] || (customSources[source] ? customSources[source].name : source);
            title.textContent = `${sourceName} · ${monthLabel}`;

            // 항목: 날짜 + 제목
            content.innerHTML = events.map((e, idx) => {
                const date = e.date ? e.date.substring(5).replace('-', '.') : '';
                const truncTitle = e.title.length > 20 ? e.title.substring(0, 20) + '…' : e.title;
                return `
                    <div class="popover-item" onclick="onPopoverItemClick(event, '${source}', '${key}', ${idx}, '${grain}')" title="${e.title}">
                        <span class="popover-date">${date}</span>
                        <span class="popover-title-text">${truncTitle}</span>
                    </div>
                `;
            }).join('');

            const rect = event.target.getBoundingClientRect();
            popover.style.left = `${rect.left}px`;
            popover.style.top = `${rect.bottom + 5}px`;
            popover.classList.add('visible');
        }

        // 팝오버 항목 클릭
        function onPopoverItemClick(event, source, key, index, grain) {
            const events = getEventsForPeriod(source, key, grain);
            if (events && events[index]) {
                showDetail(events[index], source);
            }
            hidePopover();
            event.stopPropagation();
        }

        // 팝오버 숨기기
        function hidePopover() {
            document.getElementById('popover').classList.remove('visible');
        }

        document.addEventListener('click', (e) => {
            hidePopover();

            // 산업 분석 드롭다운 닫기
            if (!e.target.closest('.industry-dropdown-wrapper')) {
                document.querySelectorAll('.industry-dropdown').forEach(d => d.classList.remove('show'));
            }
        });

        // 상세보기 표시
        let detailCharts = [];
        let currentItem = null;
        let currentSource = null;

        function showDetail(item, source) {
            const container = document.getElementById('detailContainer');

            // 현재 항목 저장
            currentItem = item;
            currentSource = source;

            // 기존 차트 정리
            detailCharts.forEach(chart => {
                if (chart) chart.destroy();
            });
            detailCharts = [];

            // 전망 포인트 생성
            const forecastPoints = generateForecast(item, source);

            // 전망 탭 내용 생성
            const forecastHtml = `
                <div class="forecast-container">
                    <div class="forecast-header">
                        <span class="forecast-title">전망</span>
                        <span class="forecast-period">${item.date}</span>
                    </div>
                    <div class="forecast-content">
                        <div class="forecast-section">
                            <h4>전망 포인트</h4>
                            <ul>
                                ${forecastPoints.map(p => `<li>${p}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                </div>
            `;

            // 상세 탭 내용 생성
            let chartsHtml = '';
            if (item.charts && item.charts.length > 0) {
                chartsHtml = `<div class="detail-charts">
                    ${item.charts.map((c, i) =>
                        `<div class="detail-chart-item" id="detailChart${i}"></div>`
                    ).join('')}
                </div>`;
            }

            const summaryHtml = item.summary ?
                `<ul>${item.summary.map(s => `<li>${s}</li>`).join('')}</ul>` :
                '<p>요약 정보가 없습니다.</p>';

            const analysisHtml = item.analysis ?
                `<div class="detail-analysis">${parseMarkdown(item.analysis)}</div>` :
                '';

            const displaySourceName = sourceNames[source] || (customSources[source] ? customSources[source].name : source);

            const detailHtml = `
                <div class="detail-header">
                    <div class="detail-source">${displaySourceName}</div>
                    <div class="detail-date">${item.date}</div>
                </div>
                ${chartsHtml}
                <div class="detail-content">
                    <div class="detail-title">${item.title}</div>
                    <div class="detail-summary">${summaryHtml}</div>
                    ${analysisHtml}
                </div>
            `;

            // 탭 구조 생성
            container.innerHTML = `
                <div class="detail-tabs">
                    <div class="detail-tab active" data-tab="detail">상세</div>
                    <div class="detail-tab" data-tab="forecast">전망</div>
                </div>
                <div class="detail-tab-content" id="detailContent">
                    ${detailHtml}
                </div>
                <div class="detail-tab-content" id="forecastContent" style="display:none">
                    ${forecastHtml}
                </div>
            `;

            // 탭 클릭 이벤트
            container.querySelectorAll('.detail-tab').forEach(tab => {
                tab.addEventListener('click', () => switchTab(tab.dataset.tab));
            });

            // 상세 탭이 기본이므로 차트 바로 렌더링
            if (currentItem && currentItem.charts && currentItem.charts.length > 0) {
                setTimeout(() => {
                    currentItem.charts.forEach((chartConfig, i) => {
                        renderDetailChart(`detailChart${i}`, chartConfig);
                    });
                }, 50);
            }
        }

        // 탭 전환
        function switchTab(tabName) {
            const container = document.getElementById('detailContainer');
            const tabs = container.querySelectorAll('.detail-tab');
            const forecastContent = document.getElementById('forecastContent');
            const detailContent = document.getElementById('detailContent');

            tabs.forEach(tab => {
                if (tab.dataset.tab === tabName) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });

            if (tabName === 'forecast') {
                forecastContent.style.display = 'block';
                detailContent.style.display = 'none';
            } else {
                forecastContent.style.display = 'none';
                detailContent.style.display = 'block';

                // 상세 탭 활성화 시 차트 렌더링
                if (currentItem && currentItem.charts && currentItem.charts.length > 0) {
                    // 이미 렌더링된 차트가 없으면 렌더링
                    if (detailCharts.length === 0) {
                        currentItem.charts.forEach((chartConfig, i) => {
                            renderDetailChart(`detailChart${i}`, chartConfig);
                        });
                    }
                }
            }
        }

        // 상세보기 차트 렌더링
        function renderDetailChart(containerId, chartConfig) {
            const chartType = chartConfig.type || 'column';

            if (chartType === 'waterfall') {
                renderWaterfallChart(containerId, chartConfig);
            } else if (chartType === 'comparison') {
                renderComparisonChart(containerId, chartConfig);
            } else if (chartType === 'pie') {
                renderPieChart(containerId, chartConfig);
            } else {
                renderColumnChart(containerId, chartConfig);
            }
        }

        // Waterfall 차트 렌더링
        function renderWaterfallChart(containerId, config) {
            const chart = Highcharts.chart(containerId, {
                chart: {
                    type: 'waterfall',
                    backgroundColor: 'transparent',
                    height: 220,
                    style: {
                        fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                        fontWeight: '300'
                    }
                },
                title: {
                    text: config.title || '',
                    style: { fontSize: '11px', fontWeight: '400', color: '#ccc' }
                },
                xAxis: {
                    type: 'category',
                    labels: { style: { fontSize: '9px', color: '#888' } },
                    lineColor: '#3a3a3a'
                },
                yAxis: {
                    title: { text: '' },
                    labels: { style: { fontSize: '9px', color: '#888' } },
                    gridLineColor: '#3a3a3a'
                },
                legend: { enabled: false },
                tooltip: {
                    backgroundColor: '#2d2d2d',
                    borderColor: '#E57B53',
                    borderRadius: 6,
                    style: { fontSize: '11px', color: '#ccc' },
                    pointFormat: '<b>{point.y}</b>'
                },
                plotOptions: {
                    waterfall: {
                        dataLabels: {
                            enabled: true,
                            formatter: function() {
                                if (this.point.isSum) return '';
                                return this.y > 0 ? '+' + this.y : this.y;
                            },
                            style: { fontSize: '9px', fontWeight: '300', color: '#ccc' }
                        },
                        borderWidth: 0,
                        lineColor: '#E57B53',
                        lineWidth: 1
                    }
                },
                series: [{
                    data: config.data,
                    upColor: '#E57B53',
                    color: '#666'
                }],
                credits: { enabled: false }
            });
            detailCharts.push(chart);
        }

        // 비교 차트 렌더링
        function renderComparisonChart(containerId, config) {
            const chart = Highcharts.chart(containerId, {
                chart: {
                    type: 'column',
                    backgroundColor: 'transparent',
                    height: 220,
                    style: {
                        fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                        fontWeight: '300'
                    }
                },
                title: {
                    text: config.title || '',
                    style: { fontSize: '11px', fontWeight: '400', color: '#ccc' }
                },
                xAxis: {
                    categories: config.categories,
                    labels: { style: { fontSize: '9px', color: '#888' } },
                    lineColor: '#3a3a3a'
                },
                yAxis: {
                    title: { text: '' },
                    plotLines: [{ value: 0, width: 1, color: '#666' }],
                    labels: { style: { fontSize: '9px', color: '#888' } },
                    gridLineColor: '#3a3a3a'
                },
                legend: {
                    enabled: true,
                    itemStyle: { fontSize: '9px', fontWeight: '300', color: '#888' }
                },
                tooltip: {
                    backgroundColor: '#2d2d2d',
                    borderColor: '#E57B53',
                    borderRadius: 6,
                    style: { fontSize: '11px', color: '#ccc' },
                    shared: true
                },
                plotOptions: {
                    column: {
                        dataLabels: {
                            enabled: true,
                            format: '{y}%',
                            style: { fontSize: '8px', fontWeight: '300', color: '#ccc' }
                        },
                        borderRadius: 2,
                        groupPadding: 0.1
                    }
                },
                series: config.series,
                credits: { enabled: false }
            });
            detailCharts.push(chart);
        }

        // 파이 차트 렌더링
        function renderPieChart(containerId, config) {
            const chart = Highcharts.chart(containerId, {
                chart: {
                    type: 'pie',
                    backgroundColor: 'transparent',
                    height: 220,
                    style: {
                        fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                        fontWeight: '300'
                    }
                },
                title: {
                    text: config.title || '',
                    style: { fontSize: '11px', fontWeight: '400', color: '#ccc' }
                },
                legend: { enabled: false },
                tooltip: {
                    backgroundColor: '#2d2d2d',
                    borderColor: '#E57B53',
                    borderRadius: 6,
                    style: { fontSize: '11px', color: '#ccc' }
                },
                plotOptions: {
                    pie: {
                        colors: ['#E57B53', '#c96a47', '#a55a3c', '#7a4a32', '#5a3a28'],
                        dataLabels: {
                            enabled: true,
                            format: '{point.name}: {point.percentage:.0f}%',
                            style: {
                                fontSize: '9px',
                                fontWeight: '300',
                                color: '#ccc'
                            }
                        }
                    }
                },
                series: [{
                    name: '비중',
                    data: config.data
                }],
                credits: { enabled: false }
            });
            detailCharts.push(chart);
        }

        // 컬럼/라인 차트 렌더링
        function renderColumnChart(containerId, config) {
            const chartType = config.type || 'column';
            const chart = Highcharts.chart(containerId, {
                chart: {
                    type: chartType,
                    backgroundColor: 'transparent',
                    height: 220,
                    style: {
                        fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                        fontWeight: '300'
                    }
                },
                title: {
                    text: config.title || '',
                    style: { fontSize: '11px', fontWeight: '400', color: '#ccc' }
                },
                xAxis: {
                    type: 'category',
                    labels: { style: { fontSize: '10px', color: '#888' } },
                    lineColor: '#3a3a3a',
                    tickColor: '#3a3a3a'
                },
                yAxis: {
                    title: { text: '' },
                    labels: { style: { fontSize: '10px', color: '#888' } },
                    gridLineColor: '#3a3a3a'
                },
                legend: { enabled: false },
                tooltip: {
                    backgroundColor: '#2d2d2d',
                    borderColor: '#E57B53',
                    borderRadius: 6,
                    style: { fontSize: '11px', color: '#ccc' }
                },
                plotOptions: {
                    column: {
                        color: '#E57B53',
                        borderRadius: 3
                    },
                    line: {
                        color: '#E57B53',
                        marker: {
                            fillColor: '#E57B53',
                            lineColor: '#E57B53'
                        }
                    }
                },
                series: [{
                    name: '값',
                    data: config.data
                }],
                credits: { enabled: false }
            });
            detailCharts.push(chart);
        }

        // 차트 초기화
        function initChart() {
            const stockData = generateStockData();
            const exchangeRateData = generateExchangeRateData();

            Highcharts.stockChart('stockChart', {
                chart: {
                    backgroundColor: 'transparent',
                    marginLeft: 80,
                    marginRight: 80,
                    spacingLeft: 10,
                    spacingRight: 10,
                    spacingTop: 50,
                    style: {
                        fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                        fontWeight: '300'
                    }
                },
                rangeSelector: {
                    buttonPosition: {
                        align: 'right',
                        x: -60,
                        y: 0
                    },
                    buttons: [{
                        type: 'month',
                        count: 1,
                        text: '1개월'
                    }, {
                        type: 'month',
                        count: 3,
                        text: '3개월'
                    }, {
                        type: 'month',
                        count: 6,
                        text: '6개월'
                    }, {
                        type: 'all',
                        text: '전체'
                    }],
                    selected: 3,
                    inputEnabled: false,
                    buttonTheme: {
                        fill: '#2d2d2d',
                        stroke: '#3a3a3a',
                        'stroke-width': 1,
                        r: 4,
                        style: {
                            color: '#888',
                            fontWeight: '300'
                        },
                        states: {
                            hover: {
                                fill: 'rgba(229, 123, 83, 0.2)',
                                style: {
                                    color: '#E57B53'
                                }
                            },
                            select: {
                                fill: '#E57B53',
                                style: {
                                    color: '#fff'
                                }
                            }
                        }
                    }
                },
                navigator: {
                    enabled: true,
                    height: 30,
                    maskFill: 'rgba(229, 123, 83, 0.15)',
                    outlineColor: '#3a3a3a',
                    handles: {
                        backgroundColor: '#E57B53',
                        borderColor: '#E57B53'
                    },
                    series: {
                        color: '#E57B53',
                        lineWidth: 1
                    }
                },
                scrollbar: {
                    enabled: false
                },
                xAxis: {
                    events: {
                        afterSetExtremes: function(e) {
                            renderTable(e.min, e.max);
                        }
                    },
                    lineColor: '#3a3a3a',
                    tickColor: '#3a3a3a',
                    labels: {
                        style: {
                            color: '#888',
                            fontWeight: '300'
                        }
                    }
                },
                yAxis: [{
                    // 주가 축 (왼쪽)
                    opposite: false,
                    gridLineColor: '#3a3a3a',
                    labels: {
                        align: 'right',
                        x: -3,
                        style: {
                            color: '#888',
                            fontWeight: '300'
                        },
                        formatter: function() {
                            return (this.value / 1000) + 'K';
                        }
                    },
                    title: {
                        text: '주가 (원)',
                        align: 'high',
                        rotation: 0,
                        x: 40,
                        y: -10,
                        style: {
                            color: '#888',
                            fontWeight: '300'
                        }
                    },
                    height: '100%'
                }, {
                    // 환율 축 (오른쪽)
                    opposite: true,
                    gridLineWidth: 0,
                    labels: {
                        align: 'right',
                        x: -3,
                        style: {
                            color: '#888',
                            fontWeight: '300'
                        },
                        formatter: function() {
                            return this.value;
                        }
                    },
                    title: {
                        text: 'USD/KRW',
                        align: 'high',
                        rotation: 0,
                        y: -10,
                        style: {
                            color: '#888',
                            fontWeight: '300'
                        }
                    },
                    height: '100%'
                }],
                tooltip: {
                    backgroundColor: '#2d2d2d',
                    borderColor: '#E57B53',
                    borderRadius: 6,
                    style: {
                        color: '#ccc',
                        fontWeight: '300'
                    },
                    shared: true
                },
                legend: {
                    enabled: true,
                    align: 'left',
                    verticalAlign: 'top',
                    layout: 'vertical',
                    x: 140,
                    y: 15,
                    floating: true,
                    backgroundColor: 'rgba(30, 30, 30, 0.8)',
                    borderColor: 'var(--border-color)',
                    borderWidth: 1,
                    borderRadius: 4,
                    itemStyle: {
                        color: 'var(--text-muted)',
                        fontSize: '11px'
                    },
                    itemHoverStyle: {
                        color: 'var(--text-primary)'
                    },
                    symbolWidth: 16,
                    symbolHeight: 2
                },
                series: [{
                    name: '넥슨 주가',
                    data: stockData,
                    color: '#E57B53',
                    lineWidth: 2,
                    yAxis: 0,
                    tooltip: {
                        valueDecimals: 0,
                        valuePrefix: '₩'
                    }
                }, {
                    name: 'USD/KRW 환율',
                    data: exchangeRateData,
                    color: '#888',
                    lineWidth: 2,
                    yAxis: 1,
                    tooltip: {
                        valueDecimals: 2,
                        valuePrefix: '₩'
                    }
                }],
                credits: {
                    enabled: false
                },
                exporting: {
                    enabled: false
                }
            });

            // 초기 테이블 렌더링
            const firstDate = stockData[0][0];
            const lastDate = stockData[stockData.length - 1][0];
            renderTable(firstDate, lastDate);
        }

        // 리사이저 기능
        function initResizers() {
            // 중앙-우측 리사이저
            initCenterResizer();
        }

        function initHorizontalResizer(resizerId, leftPanelId, rightPanelId, minWidth, maxWidth) {
            const resizer = document.getElementById(resizerId);
            const leftPanel = document.getElementById(leftPanelId);

            let isResizing = false;
            let startX, startWidth;

            resizer.addEventListener('mousedown', (e) => {
                isResizing = true;
                startX = e.clientX;
                startWidth = leftPanel.offsetWidth;
                resizer.classList.add('active');
                document.body.style.cursor = 'col-resize';
                document.body.style.userSelect = 'none';
                e.preventDefault();
            });

            document.addEventListener('mousemove', (e) => {
                if (!isResizing) return;
                const diff = e.clientX - startX;
                let newWidth = startWidth + diff;
                newWidth = Math.max(minWidth, Math.min(maxWidth, newWidth));
                leftPanel.style.width = newWidth + 'px';
                leftPanel.style.minWidth = newWidth + 'px';
            });

            document.addEventListener('mouseup', () => {
                if (isResizing) {
                    isResizing = false;
                    resizer.classList.remove('active');
                    document.body.style.cursor = '';
                    document.body.style.userSelect = '';
                    // 차트 리사이즈 트리거
                    window.dispatchEvent(new Event('resize'));
                }
            });
        }

        // 우측 패널 접힘 상태 관리
        let isRightPanelCollapsed = false;
        let savedRightPanelWidth = 350;

        function collapseRightPanel() {
            const rightPanel = document.getElementById('rightPanel');
            const resizer = document.getElementById('resizerCenter');
            savedRightPanelWidth = rightPanel.offsetWidth || 350;
            rightPanel.classList.add('collapsed');
            isRightPanelCollapsed = true;
            resizer.classList.add('panel-collapsed');
            localStorage.setItem('rightPanelCollapsed', 'true');
            localStorage.setItem('savedRightPanelWidth', savedRightPanelWidth.toString());
        }

        function expandRightPanel() {
            const rightPanel = document.getElementById('rightPanel');
            const resizer = document.getElementById('resizerCenter');
            rightPanel.classList.remove('collapsed');
            rightPanel.style.flex = '1';
            rightPanel.style.width = 'auto';
            rightPanel.style.maxWidth = 'none';
            isRightPanelCollapsed = false;
            resizer.classList.remove('panel-collapsed');
            localStorage.setItem('rightPanelCollapsed', 'false');
        }

        function initCenterResizer() {
            const resizer = document.getElementById('resizerCenter');
            const centerPanel = document.getElementById('centerPanel');
            const rightPanel = document.getElementById('rightPanel');
            const upperArea = document.getElementById('upperArea');

            let isResizing = false;
            let startX, startCenterWidth;

            // 페이지 로드 시 저장된 상태 복원
            const savedCollapsed = localStorage.getItem('rightPanelCollapsed');
            const savedWidth = localStorage.getItem('savedRightPanelWidth');
            if (savedWidth) {
                savedRightPanelWidth = parseInt(savedWidth, 10);
            }
            if (savedCollapsed === 'true') {
                collapseRightPanel();
                centerPanel.style.flex = 'none';
                centerPanel.style.width = (upperArea.offsetWidth - 5) + 'px';
            }

            resizer.addEventListener('mousedown', (e) => {
                isResizing = true;
                startX = e.clientX;
                startCenterWidth = centerPanel.offsetWidth;

                resizer.classList.add('active');
                document.body.style.cursor = 'col-resize';
                document.body.style.userSelect = 'none';
                e.preventDefault();
            });

            document.addEventListener('mousemove', (e) => {
                if (!isResizing) return;
                const diff = e.clientX - startX;
                let newCenterWidth = startCenterWidth + diff;

                const minCenter = 400;
                const totalWidth = upperArea.offsetWidth - 5; // 리사이저 너비 제외
                const rightPanelWidth = totalWidth - newCenterWidth;

                // 우측 패널 접기 감지 (50px 이하)
                if (rightPanelWidth <= 50 && !isRightPanelCollapsed) {
                    collapseRightPanel();
                    newCenterWidth = totalWidth;
                }
                // 접힌 상태에서 좌측으로 드래그 시 복원
                else if (isRightPanelCollapsed && diff < -30) {
                    expandRightPanel();
                    newCenterWidth = totalWidth - savedRightPanelWidth;
                }

                // 최소 너비 제한
                if (newCenterWidth < minCenter) {
                    newCenterWidth = minCenter;
                }

                // 접히지 않은 상태에서 최대 너비 제한 (우측 패널 최소 250px)
                if (!isRightPanelCollapsed) {
                    const maxCenter = totalWidth - 250;
                    if (newCenterWidth > maxCenter) {
                        newCenterWidth = maxCenter;
                    }
                }

                centerPanel.style.flex = 'none';
                centerPanel.style.width = newCenterWidth + 'px';

                // 우측 패널은 남은 공간 차지 (접히지 않은 경우)
                if (!isRightPanelCollapsed) {
                    rightPanel.style.flex = '1';
                    rightPanel.style.width = 'auto';
                    rightPanel.style.maxWidth = 'none';
                }
            });

            document.addEventListener('mouseup', () => {
                if (isResizing) {
                    isResizing = false;
                    resizer.classList.remove('active');
                    document.body.style.cursor = '';
                    document.body.style.userSelect = '';
                    window.dispatchEvent(new Event('resize'));
                }
            });
        }

        // 전망 포인트 생성
        function generateForecast(item, source) {
            const forecastPoints = [];

            // 출처별 기본 전망 포인트
            if (source === 'dart') {
                forecastPoints.push('공시 자료 기반 실적 데이터로 신뢰도 높음');
                if (item.summary && item.summary.some(s => s.includes('매출'))) {
                    forecastPoints.push('매출 관련 핵심 지표 확인 필요');
                }
                if (item.summary && item.summary.some(s => s.includes('영업이익'))) {
                    forecastPoints.push('수익성 지표가 업계 평균 대비 양호한 수준');
                }
            } else if (source === 'darkReport') {
                forecastPoints.push('비공식 분석 자료로 참고용 활용 권장');
                forecastPoints.push('시장 센티먼트 파악에 유용한 데이터');
            } else if (source === 'policy') {
                forecastPoints.push('규제 환경 변화에 따른 사업 영향도 모니터링 필요');
                forecastPoints.push('중장기 전략 수립 시 반영 검토');
            } else if (source === 'news') {
                forecastPoints.push('시장 관심도 및 브랜드 인지도 관련 지표');
                forecastPoints.push('단기 주가 변동성에 영향 가능');
            }

            // 항목별 추가 전망 포인트
            if (item.charts && item.charts.length > 0) {
                const chartTypes = item.charts.map(c => c.type);
                if (chartTypes.includes('waterfall')) {
                    forecastPoints.push('누적 흐름 분석을 통한 성장 동인 파악 가능');
                }
                if (chartTypes.includes('comparison')) {
                    forecastPoints.push('경쟁사 대비 상대적 위치 확인 필요');
                }
                if (chartTypes.includes('pie')) {
                    forecastPoints.push('포트폴리오 구성 및 집중도 리스크 검토');
                }
            }

            return forecastPoints.slice(0, 4); // 최대 4개 전망 포인트
        }

        // 검색 실행 (Enter 키)
        function handleChartSearch(query) {
            if (!query.trim()) return;

            const titleEl = document.getElementById('chartTitle');
            const inputEl = document.getElementById('chartSearchInput');

            // 검색어를 그대로 타이틀로 사용 (추후 AI API 연동 가능)
            titleEl.textContent = query;
            titleEl.style.display = 'block';
            inputEl.style.display = 'none';
        }

        // 타이틀 클릭 시 검색창으로 전환
        function editChartTitle() {
            const titleEl = document.getElementById('chartTitle');
            const inputEl = document.getElementById('chartSearchInput');

            inputEl.value = titleEl.textContent;
            inputEl.style.display = 'block';
            titleEl.style.display = 'none';
            inputEl.focus();
            inputEl.select();
        }

        // 검색창 초기화
        function initChartSearch() {
            document.getElementById('chartSearchInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleChartSearch(e.target.value);
                }
            });

            document.getElementById('chartTitle').addEventListener('click', editChartTitle);
        }

        // 기간 헤더 클릭 처리
        function handlePeriodHeaderClick(periodKey, grain) {
            const periodData = collectPeriodData(periodKey, grain);
            showPeriodCharts(periodKey, grain, periodData);
        }

        // 기간별 모든 출처 데이터 수집
        function collectPeriodData(periodKey, grain) {
            const sources = ['dart', 'darkReport', 'policy', 'paper', 'patent', 'sec', 'edinet'];
            const result = {
                bySource: {},
                allEvents: [],
                total: 0
            };

            sources.forEach(src => {
                const events = getEventsForPeriod(src, periodKey, grain);
                result.bySource[src] = events;
                result.allEvents.push(...events.map(e => ({ ...e, source: src })));
                result.total += events.length;
            });

            // 날짜 역순 정렬
            result.allEvents.sort((a, b) => new Date(b.date) - new Date(a.date));

            return result;
        }

        // 세부 기간 목록 생성
        function getSubPeriods(periodKey, grain) {
            const subPeriods = [];

            if (grain === 'year') {
                // 연도 -> 4분기
                const year = parseInt(periodKey);
                for (let q = 1; q <= 4; q++) {
                    subPeriods.push({
                        key: `${year}-Q${q}`,
                        label: `Q${q}`
                    });
                }
            } else if (grain === 'quarter') {
                // 분기 -> 3개월
                const [year, qStr] = periodKey.split('-Q');
                const quarter = parseInt(qStr);
                const startMonth = (quarter - 1) * 3 + 1;
                for (let m = startMonth; m < startMonth + 3; m++) {
                    subPeriods.push({
                        key: `${year}-${String(m).padStart(2, '0')}`,
                        label: `${m}월`
                    });
                }
            } else if (grain === 'month') {
                // 월 -> 주별 (1-7, 8-14, 15-21, 22-말일)
                const [year, month] = periodKey.split('-');
                const weeks = ['1주', '2주', '3주', '4주'];
                weeks.forEach((label, idx) => {
                    subPeriods.push({
                        key: `${periodKey}-W${idx + 1}`,
                        label: label
                    });
                });
            }

            return subPeriods;
        }

        // 기간 레이블 포맷팅
        function formatPeriodLabel(periodKey, grain) {
            if (grain === 'year') {
                return `${periodKey}년`;
            } else if (grain === 'quarter') {
                const [year, qStr] = periodKey.split('-Q');
                return `${year}년 ${qStr}분기`;
            } else if (grain === 'month') {
                const [year, month] = periodKey.split('-');
                return `${year}년 ${parseInt(month)}월`;
            } else if (grain === 'day') {
                const [year, month, day] = periodKey.split('-');
                return `${year}년 ${parseInt(month)}월 ${parseInt(day)}일`;
            }
            return periodKey;
        }

        // 히트맵 데이터 생성
        function generateHeatmapData(periodData, periodKey, grain) {
            const sources = ['dart', 'darkReport', 'policy', 'paper', 'patent', 'sec', 'edinet'];
            const sourceLabels = ['공시', '다크리포트', '정책/규제', '논문', '특허', 'SEC', 'EDINET'];
            const subPeriods = getSubPeriods(periodKey, grain);

            if (subPeriods.length === 0) return null;

            const data = [];
            const subGrain = grain === 'year' ? 'quarter' : (grain === 'quarter' ? 'month' : 'day');

            sources.forEach((src, yIdx) => {
                subPeriods.forEach((sub, xIdx) => {
                    let count = 0;
                    if (grain === 'month') {
                        // 주별 계산
                        const weekNum = xIdx + 1;
                        const events = periodData.bySource[src] || [];
                        count = events.filter(e => {
                            if (!e.date) return false;
                            const day = new Date(e.date).getDate();
                            if (weekNum === 1) return day <= 7;
                            if (weekNum === 2) return day >= 8 && day <= 14;
                            if (weekNum === 3) return day >= 15 && day <= 21;
                            return day >= 22;
                        }).length;
                    } else {
                        const subEvents = getEventsForPeriod(src, sub.key, subGrain);
                        count = subEvents.length;
                    }
                    data.push([xIdx, yIdx, count]);
                });
            });

            return {
                data,
                xCategories: subPeriods.map(p => p.label),
                yCategories: sourceLabels
            };
        }

        // 우측 패널에 기간별 차트 표시
        function showPeriodCharts(periodKey, grain, periodData) {
            const container = document.getElementById('detailContainer');
            const periodLabel = formatPeriodLabel(periodKey, grain);
            const subPeriods = getSubPeriods(periodKey, grain);

            // 출처별 데이터 집계
            const sourceLabels = {
                dart: '공시',
                darkReport: '다크리포트',
                policy: '정책/규제',
                paper: '논문',
                patent: '특허',
                sec: 'SEC',
                edinet: 'EDINET'
            };

            // HTML 생성
            let html = `
                <div class="detail-tabs">
                    <div class="detail-tab active">기간별 분석</div>
                </div>
                <div class="detail-tab-content" style="display:block">
                    <div class="period-charts-view">
                        <div class="period-charts-header">
                            <div class="period-charts-title">${periodLabel}</div>
                            <div class="period-charts-subtitle">기간별 이벤트 분석</div>
                        </div>
                        <div class="period-charts-total">총 ${periodData.total}건</div>

                        <div class="period-chart-item">
                            <h4>출처별 이벤트 수</h4>
                            <div class="period-chart-container" id="periodBarChart"></div>
                        </div>

                        ${subPeriods.length > 0 ? `
                        <div class="period-chart-item">
                            <h4>기간 내 트렌드</h4>
                            <div class="period-chart-container" id="periodLineChart"></div>
                        </div>

                        <div class="period-chart-item">
                            <h4>출처 × 기간 분포</h4>
                            <div class="period-chart-container" id="periodHeatmap"></div>
                        </div>
                        ` : ''}

                        <div class="period-events-list">
                            <div class="period-events-title">이벤트 목록 (${periodData.total}건)</div>
                            ${periodData.allEvents.slice(0, 20).map(e => `
                                <div class="period-event-item" onclick="showDetail(eventData['${e.source}']['${e.date ? e.date.substring(0, 7) : ''}'].find(ev => ev.id === '${e.id}'), '${e.source}')">
                                    <span class="period-event-source">${sourceLabels[e.source]}</span>
                                    <span class="period-event-date">${e.date ? e.date.substring(5).replace('-', '.') : ''}</span>
                                    <span class="period-event-title">${e.title}</span>
                                </div>
                            `).join('')}
                            ${periodData.total > 20 ? `<div style="padding: 8px; color: var(--text-muted); font-size: 11px;">... 외 ${periodData.total - 20}건</div>` : ''}
                        </div>
                    </div>
                </div>
            `;

            container.innerHTML = html;

            // 차트 렌더링
            setTimeout(() => {
                renderSourceBarChart('periodBarChart', periodData, sourceLabels);
                if (subPeriods.length > 0) {
                    renderTrendLineChart('periodLineChart', periodData, periodKey, grain);
                    renderSourceHeatmap('periodHeatmap', periodData, periodKey, grain);
                }
            }, 50);
        }

        // 출처별 막대 차트
        function renderSourceBarChart(containerId, periodData, sourceLabels) {
            const sources = ['dart', 'darkReport', 'policy', 'paper', 'patent', 'sec', 'edinet'];
            const categories = sources.map(s => sourceLabels[s]);
            const data = sources.map(s => (periodData.bySource[s] || []).length);

            Highcharts.chart(containerId, {
                chart: {
                    type: 'bar',
                    backgroundColor: 'transparent',
                    height: 180
                },
                title: { text: null },
                xAxis: {
                    categories: categories,
                    labels: { style: { color: '#888', fontSize: '10px' } },
                    lineColor: '#3a3a3a'
                },
                yAxis: {
                    min: 0,
                    title: { text: null },
                    labels: { style: { color: '#888', fontSize: '10px' } },
                    gridLineColor: '#3a3a3a'
                },
                legend: { enabled: false },
                credits: { enabled: false },
                plotOptions: {
                    bar: {
                        color: '#E57B53',
                        dataLabels: {
                            enabled: true,
                            style: { color: '#ccc', fontSize: '10px', textOutline: 'none' }
                        }
                    }
                },
                series: [{
                    name: '이벤트 수',
                    data: data
                }]
            });
        }

        // 트렌드 라인 차트
        function renderTrendLineChart(containerId, periodData, periodKey, grain) {
            const subPeriods = getSubPeriods(periodKey, grain);
            const subGrain = grain === 'year' ? 'quarter' : (grain === 'quarter' ? 'month' : 'day');

            const data = subPeriods.map(sub => {
                if (grain === 'month') {
                    // 주별 계산
                    const weekNum = parseInt(sub.key.split('-W')[1]);
                    let count = 0;
                    periodData.allEvents.forEach(e => {
                        if (!e.date) return;
                        const day = new Date(e.date).getDate();
                        if (weekNum === 1 && day <= 7) count++;
                        else if (weekNum === 2 && day >= 8 && day <= 14) count++;
                        else if (weekNum === 3 && day >= 15 && day <= 21) count++;
                        else if (weekNum === 4 && day >= 22) count++;
                    });
                    return count;
                } else {
                    let total = 0;
                    const sources = ['dart', 'darkReport', 'policy', 'paper', 'patent', 'sec', 'edinet'];
                    sources.forEach(src => {
                        total += getEventsForPeriod(src, sub.key, subGrain).length;
                    });
                    return total;
                }
            });

            Highcharts.chart(containerId, {
                chart: {
                    type: 'line',
                    backgroundColor: 'transparent',
                    height: 180
                },
                title: { text: null },
                xAxis: {
                    categories: subPeriods.map(p => p.label),
                    labels: { style: { color: '#888', fontSize: '10px' } },
                    lineColor: '#3a3a3a'
                },
                yAxis: {
                    min: 0,
                    title: { text: null },
                    labels: { style: { color: '#888', fontSize: '10px' } },
                    gridLineColor: '#3a3a3a'
                },
                legend: { enabled: false },
                credits: { enabled: false },
                plotOptions: {
                    line: {
                        color: '#E57B53',
                        marker: {
                            fillColor: '#E57B53',
                            lineColor: '#E57B53'
                        },
                        dataLabels: {
                            enabled: true,
                            style: { color: '#ccc', fontSize: '10px', textOutline: 'none' }
                        }
                    }
                },
                series: [{
                    name: '이벤트 수',
                    data: data
                }]
            });
        }

        // 히트맵 차트
        function renderSourceHeatmap(containerId, periodData, periodKey, grain) {
            const heatmapData = generateHeatmapData(periodData, periodKey, grain);
            if (!heatmapData) return;

            Highcharts.chart(containerId, {
                chart: {
                    type: 'heatmap',
                    backgroundColor: 'transparent',
                    height: 180
                },
                title: { text: null },
                xAxis: {
                    categories: heatmapData.xCategories,
                    labels: { style: { color: '#888', fontSize: '10px' } },
                    lineColor: '#3a3a3a'
                },
                yAxis: {
                    categories: heatmapData.yCategories,
                    title: { text: null },
                    labels: { style: { color: '#888', fontSize: '10px' } },
                    reversed: true
                },
                colorAxis: {
                    min: 0,
                    minColor: '#2d2d2d',
                    maxColor: '#E57B53'
                },
                legend: { enabled: false },
                credits: { enabled: false },
                tooltip: {
                    formatter: function() {
                        return `<b>${this.series.yAxis.categories[this.point.y]}</b><br>` +
                               `${this.series.xAxis.categories[this.point.x]}: <b>${this.point.value}건</b>`;
                    }
                },
                series: [{
                    name: '이벤트 수',
                    borderWidth: 1,
                    borderColor: '#3a3a3a',
                    data: heatmapData.data,
                    dataLabels: {
                        enabled: true,
                        color: '#ffffff',
                        style: { fontSize: '9px', textOutline: 'none' },
                        formatter: function() {
                            return this.point.value > 0 ? this.point.value : '';
                        }
                    }
                }]
            });
        }

        // 기간 선택 버튼 초기화 (이벤트 위임 방식)
        function initPeriodSelector() {
            document.getElementById('dataTable').addEventListener('click', (e) => {
                const btn = e.target.closest('.period-btn');
                if (!btn) return;

                // 활성 상태 변경
                document.querySelectorAll('.period-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');

                // 선택된 기간 업데이트
                selectedPeriod = btn.dataset.period;

                // 테이블 다시 렌더링 (현재 차트 범위 기준)
                const chart = Highcharts.charts.find(c => c && c.renderTo.id === 'stockChart');
                if (chart) {
                    const extremes = chart.xAxis[0].getExtremes();
                    renderTable(extremes.min, extremes.max);
                }
            });
        }

        // 산업 분석 색상 팔레트
        const industryColors = [
            "#C15F3C",   // Crail (메인 러스트 오렌지)
            "#B1ADA1",   // Cloudy (웜 그레이)
            "#da7756",   // Terra Cotta (테라코타)
            "#7D8471",   // Sage (세이지 그린)
            "#9B8AA6",   // Lavender (라벤더)
            "#D4A574",   // Tan (탄)
            "#6B7B8C",   // Slate (슬레이트 그레이)
            "#A67B5B",   // Coffee (커피 브라운)
        ];

        // 산업 분석 데이터
        const industryData = {
            // 산업간 비교: 게임 vs 다른 산업 (시장 규모, 조원)
            interIndustry: {
                categories: ['게임', 'IT서비스', '엔터테인먼트', '콘텐츠'],
                data: [45.2, 38.7, 22.1, 18.5],
                colors: [industryColors[0], industryColors[1], industryColors[2], industryColors[3]]
            },
            // 산업내 비교: 넥슨 vs 경쟁사 (매출, 조원)
            competitors: {
                categories: ['넥슨', '엔씨소프트', '넷마블', '크래프톤'],
                data: [4.2, 2.1, 2.8, 1.5],
                colors: [industryColors[0], industryColors[4], industryColors[5], industryColors[6]]
            },
            // 장르별 비교 (시장 점유율, %)
            genres: {
                categories: ['MMORPG', 'FPS', '모바일', '캐주얼'],
                data: [35, 28, 45, 15],
                colors: [industryColors[0], industryColors[2], industryColors[3], industryColors[7]]
            },
            // 지역별 비교 (넥슨 매출, 조원)
            regions: {
                categories: ['한국', '일본', '미국', '중국'],
                data: [1.2, 1.8, 0.8, 0.4],
                colors: [industryColors[0], industryColors[1], industryColors[4], industryColors[6]]
            }
        };

        let currentIndustryTab = 'competitors';

        // 확장된 산업 데이터
        const extendedIndustryData = {
            industries: {
                game: { name: '게임', size: 45.2, growth: 8.5 },
                it: { name: 'IT서비스', size: 38.7, growth: 5.2 },
                entertainment: { name: '엔터테인먼트', size: 22.1, growth: 3.1 },
                content: { name: '콘텐츠', size: 18.5, growth: 4.8 },
                semiconductor: { name: '반도체', size: 180.5, growth: 12.3 },
                bio: { name: '바이오', size: 25.3, growth: 15.2 },
                finance: { name: '금융', size: 95.2, growth: 2.1 },
                retail: { name: '유통', size: 120.8, growth: 1.5 },
                manufacturing: { name: '제조', size: 210.3, growth: 3.8 }
            },
            companies: {
                nexon: { name: '넥슨', revenue: 4.2, growth: 5.5, marketCap: 18.5 },
                ncsoft: { name: '엔씨소프트', revenue: 2.1, growth: -3.2, marketCap: 8.2 },
                netmarble: { name: '넷마블', revenue: 2.8, growth: 2.1, marketCap: 6.5 },
                krafton: { name: '크래프톤', revenue: 1.5, growth: 8.9, marketCap: 12.3 },
                pearl: { name: '펄어비스', revenue: 0.5, growth: -5.2, marketCap: 2.1 },
                smilegate: { name: '스마일게이트', revenue: 1.2, growth: 3.5, marketCap: null },
                wemade: { name: '위메이드', revenue: 0.8, growth: 12.3, marketCap: 1.8 },
                kakao: { name: '카카오게임즈', revenue: 0.9, growth: 1.2, marketCap: 2.5 }
            },
            genres: {
                mmorpg: { name: 'MMORPG', share: 35, trend: 'stable' },
                fps: { name: 'FPS', share: 28, trend: 'up' },
                mobile: { name: '모바일', share: 45, trend: 'up' },
                casual: { name: '캐주얼', share: 15, trend: 'stable' },
                sports: { name: '스포츠', share: 12, trend: 'up' },
                strategy: { name: '전략', share: 8, trend: 'down' },
                simulation: { name: '시뮬레이션', share: 5, trend: 'stable' }
            },
            regions: {
                korea: { name: '한국', revenue: 1.2, share: 28.6 },
                japan: { name: '일본', revenue: 1.8, share: 42.9 },
                usa: { name: '미국', revenue: 0.8, share: 19.0 },
                china: { name: '중국', revenue: 0.4, share: 9.5 },
                sea: { name: '동남아', revenue: 0.3, share: 7.1 },
                europe: { name: '유럽', revenue: 0.2, share: 4.8 }
            }
        };

        // 선택 상태 변수
        let selectedIndustries = ['game', 'it', 'entertainment', 'content'];
        let selectedCompanies = ['nexon', 'ncsoft', 'netmarble', 'krafton'];
        let selectedGenres = ['mmorpg', 'fps', 'mobile', 'casual'];
        let selectedRegions = ['korea', 'japan', 'usa', 'china'];

        // 비교분석 아이콘 클릭 핸들러
        function showIndustryAnalysis() {
            // 사이드바 아이콘 활성화 상태 변경
            document.querySelectorAll('.icon-sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector('.icon-sidebar-item[title="비교분석"]').classList.add('active');

            // 중앙 패널 내용 변경
            const centerPanel = document.querySelector('.center-panel');
            centerPanel.innerHTML = `
                <div class="industry-analysis-view">
                    <div class="industry-analysis-header">산업 분석</div>

                    <!-- 산업간 비교 섹션 -->
                    <div class="industry-section">
                        <div class="industry-section-title">산업간 비교 (시장 규모)</div>

                        <!-- 산업 선택기 -->
                        <div class="industry-selector" id="industrySelector">
                            <div id="industryItems"></div>
                            <div class="industry-dropdown-wrapper">
                                <button class="industry-add-btn" onclick="toggleIndustryDropdown('industry')">+ 추가</button>
                                <div class="industry-dropdown" id="industryDropdown"></div>
                            </div>
                        </div>

                        <!-- 차트와 테이블 가로 배치 -->
                        <div class="industry-content-row">
                            <div class="industry-chart-wrapper">
                                <div id="inter-industry-chart" class="industry-chart-container"></div>
                            </div>
                            <div class="industry-table-wrapper">
                                <table class="industry-data-table">
                                    <thead>
                                        <tr>
                                            <th>산업</th>
                                            <th>시장규모</th>
                                            <th>성장률</th>
                                            <th>순위</th>
                                        </tr>
                                    </thead>
                                    <tbody id="industryTableBody"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- 산업내 비교 섹션 -->
                    <div class="industry-section">
                        <div class="industry-section-title">산업내 비교</div>
                        <div class="industry-tabs">
                            <div class="industry-tab active" data-tab="competitors" onclick="switchIndustryTab('competitors')">경쟁사</div>
                            <div class="industry-tab" data-tab="genres" onclick="switchIndustryTab('genres')">장르별</div>
                            <div class="industry-tab" data-tab="regions" onclick="switchIndustryTab('regions')">지역별</div>
                        </div>

                        <!-- 탭별 선택기 -->
                        <div class="industry-selector" id="intraSelector">
                            <div id="intraItems"></div>
                            <div class="industry-dropdown-wrapper">
                                <button class="industry-add-btn" onclick="toggleIndustryDropdown('intra')">+ 추가</button>
                                <div class="industry-dropdown" id="intraDropdown"></div>
                            </div>
                        </div>

                        <!-- 차트와 테이블 가로 배치 -->
                        <div class="industry-content-row">
                            <div class="industry-chart-wrapper">
                                <div id="intra-industry-chart" class="industry-chart-container"></div>
                            </div>
                            <div class="industry-table-wrapper">
                                <table class="industry-data-table">
                                    <thead id="intraTableHead">
                                        <tr>
                                            <th>항목</th>
                                            <th>값</th>
                                            <th>성장률</th>
                                            <th>순위</th>
                                        </tr>
                                    </thead>
                                    <tbody id="intraTableBody"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // 선택기와 차트, 테이블 렌더링
            renderIndustrySelectorItems();
            renderIntraSelectorItems();
            renderInterIndustryChart();
            renderIntraIndustryChart();
            renderIndustryTable();
            renderIntraTable();
        }

        // 산업간 비교 선택기 렌더링
        function renderIndustrySelectorItems() {
            const container = document.getElementById('industryItems');
            if (!container) return;

            container.innerHTML = selectedIndustries.map(key => {
                const ind = extendedIndustryData.industries[key];
                return `
                    <div class="industry-selector-item">
                        <span>${ind.name}</span>
                        <span class="remove-btn" onclick="removeIndustryItem('industry', '${key}')">✕</span>
                    </div>
                `;
            }).join('');

            updateIndustryDropdown('industry');
        }

        // 산업내 비교 선택기 렌더링
        function renderIntraSelectorItems() {
            const container = document.getElementById('intraItems');
            if (!container) return;

            let items, dataSource;
            if (currentIndustryTab === 'competitors') {
                items = selectedCompanies;
                dataSource = extendedIndustryData.companies;
            } else if (currentIndustryTab === 'genres') {
                items = selectedGenres;
                dataSource = extendedIndustryData.genres;
            } else {
                items = selectedRegions;
                dataSource = extendedIndustryData.regions;
            }

            container.innerHTML = items.map(key => {
                const item = dataSource[key];
                return `
                    <div class="industry-selector-item">
                        <span>${item.name}</span>
                        <span class="remove-btn" onclick="removeIndustryItem('intra', '${key}')">✕</span>
                    </div>
                `;
            }).join('');

            updateIndustryDropdown('intra');
        }

        // 드롭다운 토글
        function toggleIndustryDropdown(type) {
            const dropdownId = type === 'industry' ? 'industryDropdown' : 'intraDropdown';
            const dropdown = document.getElementById(dropdownId);
            if (!dropdown) return;

            // 다른 드롭다운 닫기
            document.querySelectorAll('.industry-dropdown').forEach(d => {
                if (d.id !== dropdownId) d.classList.remove('show');
            });

            dropdown.classList.toggle('show');
        }

        // 드롭다운 내용 업데이트
        function updateIndustryDropdown(type) {
            if (type === 'industry') {
                const dropdown = document.getElementById('industryDropdown');
                if (!dropdown) return;

                const allIndustries = Object.keys(extendedIndustryData.industries);
                dropdown.innerHTML = allIndustries.map(key => {
                    const ind = extendedIndustryData.industries[key];
                    const isSelected = selectedIndustries.includes(key);
                    return `
                        <div class="industry-dropdown-item ${isSelected ? 'disabled' : ''}"
                             onclick="${isSelected ? '' : `addIndustryItem('industry', '${key}')`}">
                            ${ind.name} ${isSelected ? '✓' : ''}
                        </div>
                    `;
                }).join('');
            } else {
                const dropdown = document.getElementById('intraDropdown');
                if (!dropdown) return;

                let dataSource, selected;
                if (currentIndustryTab === 'competitors') {
                    dataSource = extendedIndustryData.companies;
                    selected = selectedCompanies;
                } else if (currentIndustryTab === 'genres') {
                    dataSource = extendedIndustryData.genres;
                    selected = selectedGenres;
                } else {
                    dataSource = extendedIndustryData.regions;
                    selected = selectedRegions;
                }

                const allItems = Object.keys(dataSource);
                dropdown.innerHTML = allItems.map(key => {
                    const item = dataSource[key];
                    const isSelected = selected.includes(key);
                    return `
                        <div class="industry-dropdown-item ${isSelected ? 'disabled' : ''}"
                             onclick="${isSelected ? '' : `addIndustryItem('intra', '${key}')`}">
                            ${item.name} ${isSelected ? '✓' : ''}
                        </div>
                    `;
                }).join('');
            }
        }

        // 항목 추가
        function addIndustryItem(type, key) {
            if (type === 'industry') {
                if (!selectedIndustries.includes(key)) {
                    selectedIndustries.push(key);
                    renderIndustrySelectorItems();
                    renderInterIndustryChart();
                    renderIndustryTable();
                }
            } else {
                let selected;
                if (currentIndustryTab === 'competitors') {
                    selected = selectedCompanies;
                } else if (currentIndustryTab === 'genres') {
                    selected = selectedGenres;
                } else {
                    selected = selectedRegions;
                }

                if (!selected.includes(key)) {
                    selected.push(key);
                    renderIntraSelectorItems();
                    renderIntraIndustryChart();
                    renderIntraTable();
                }
            }

            // 드롭다운 닫기
            document.querySelectorAll('.industry-dropdown').forEach(d => d.classList.remove('show'));
        }

        // 항목 제거
        function removeIndustryItem(type, key) {
            if (type === 'industry') {
                if (selectedIndustries.length > 1) {
                    selectedIndustries = selectedIndustries.filter(k => k !== key);
                    renderIndustrySelectorItems();
                    renderInterIndustryChart();
                    renderIndustryTable();
                }
            } else {
                let selected;
                if (currentIndustryTab === 'competitors') {
                    if (selectedCompanies.length > 1) {
                        selectedCompanies = selectedCompanies.filter(k => k !== key);
                    }
                } else if (currentIndustryTab === 'genres') {
                    if (selectedGenres.length > 1) {
                        selectedGenres = selectedGenres.filter(k => k !== key);
                    }
                } else {
                    if (selectedRegions.length > 1) {
                        selectedRegions = selectedRegions.filter(k => k !== key);
                    }
                }
                renderIntraSelectorItems();
                renderIntraIndustryChart();
                renderIntraTable();
            }
        }

        // 산업간 비교 테이블 렌더링
        function renderIndustryTable() {
            const tbody = document.getElementById('industryTableBody');
            if (!tbody) return;

            // 선택된 산업 데이터를 크기 순으로 정렬
            const sortedData = selectedIndustries.map(key => ({
                key,
                ...extendedIndustryData.industries[key]
            })).sort((a, b) => b.size - a.size);

            tbody.innerHTML = sortedData.map((item, idx) => {
                const rank = idx + 1;
                const rankClass = rank <= 3 ? `rank-${rank}` : 'rank-other';
                const growthClass = item.growth >= 0 ? 'value-positive' : 'value-negative';
                const growthSign = item.growth >= 0 ? '+' : '';

                return `
                    <tr>
                        <td>${item.name}</td>
                        <td>${item.size.toFixed(1)}조</td>
                        <td class="${growthClass}">${growthSign}${item.growth.toFixed(1)}%</td>
                        <td><span class="rank-badge ${rankClass}">${rank}</span></td>
                    </tr>
                `;
            }).join('');
        }

        // 산업내 비교 테이블 렌더링
        function renderIntraTable() {
            const thead = document.getElementById('intraTableHead');
            const tbody = document.getElementById('intraTableBody');
            if (!thead || !tbody) return;

            let headers, rows;

            if (currentIndustryTab === 'competitors') {
                headers = '<tr><th>회사</th><th>매출</th><th>성장률</th><th>순위</th></tr>';
                const sortedData = selectedCompanies.map(key => ({
                    key,
                    ...extendedIndustryData.companies[key]
                })).sort((a, b) => b.revenue - a.revenue);

                rows = sortedData.map((item, idx) => {
                    const rank = idx + 1;
                    const rankClass = rank <= 3 ? `rank-${rank}` : 'rank-other';
                    const growthClass = item.growth >= 0 ? 'value-positive' : 'value-negative';
                    const growthSign = item.growth >= 0 ? '+' : '';

                    return `
                        <tr>
                            <td>${item.name}</td>
                            <td>${item.revenue.toFixed(1)}조</td>
                            <td class="${growthClass}">${growthSign}${item.growth.toFixed(1)}%</td>
                            <td><span class="rank-badge ${rankClass}">${rank}</span></td>
                        </tr>
                    `;
                }).join('');

            } else if (currentIndustryTab === 'genres') {
                headers = '<tr><th>장르</th><th>점유율</th><th>추세</th><th>순위</th></tr>';
                const sortedData = selectedGenres.map(key => ({
                    key,
                    ...extendedIndustryData.genres[key]
                })).sort((a, b) => b.share - a.share);

                const trendText = { up: '↑ 상승', down: '↓ 하락', stable: '→ 유지' };
                const trendClass = { up: 'value-positive', down: 'value-negative', stable: '' };

                rows = sortedData.map((item, idx) => {
                    const rank = idx + 1;
                    const rankClass = rank <= 3 ? `rank-${rank}` : 'rank-other';

                    return `
                        <tr>
                            <td>${item.name}</td>
                            <td>${item.share}%</td>
                            <td class="${trendClass[item.trend]}">${trendText[item.trend]}</td>
                            <td><span class="rank-badge ${rankClass}">${rank}</span></td>
                        </tr>
                    `;
                }).join('');

            } else {
                headers = '<tr><th>지역</th><th>매출</th><th>점유율</th><th>순위</th></tr>';
                const sortedData = selectedRegions.map(key => ({
                    key,
                    ...extendedIndustryData.regions[key]
                })).sort((a, b) => b.revenue - a.revenue);

                rows = sortedData.map((item, idx) => {
                    const rank = idx + 1;
                    const rankClass = rank <= 3 ? `rank-${rank}` : 'rank-other';

                    return `
                        <tr>
                            <td>${item.name}</td>
                            <td>${item.revenue.toFixed(1)}조</td>
                            <td>${item.share.toFixed(1)}%</td>
                            <td><span class="rank-badge ${rankClass}">${rank}</span></td>
                        </tr>
                    `;
                }).join('');
            }

            thead.innerHTML = headers;
            tbody.innerHTML = rows;
        }

        // ===== 캘린더 기능 =====
        let currentCalendarDate = new Date();

        // 캘린더 이벤트 샘플 데이터
        const calendarEvents = [
            { date: '2026-01-15', title: '넥슨 4Q 실적발표', company: '넥슨', source: 'earnings' },
            { date: '2026-01-20', title: '엔씨소프트 배당금 지급', company: '엔씨소프트', source: 'dividend' },
            { date: '2026-01-22', title: '크래프톤 IR 컨퍼런스', company: '크래프톤', source: 'conference' },
            { date: '2026-01-25', title: '게임산업 분기 보고서', company: '산업', source: 'report' },
            { date: '2026-01-28', title: '넷마블 신작 발표', company: '넷마블', source: 'news' },
            { date: '2026-01-30', title: '넥슨 IR 데이', company: '넥슨', source: 'conference' },
            { date: '2026-02-05', title: '엔씨소프트 1Q 실적예고', company: '엔씨소프트', source: 'earnings' },
            { date: '2026-02-10', title: '크래프톤 배당 공시', company: '크래프톤', source: 'dividend' },
            { date: '2026-02-15', title: '게임주 투자 리포트', company: '산업', source: 'report' },
            { date: '2026-02-20', title: '넥슨 파트너 컨퍼런스', company: '넥슨', source: 'conference' },
        ];

        function showCalendar() {
            // 사이드바 아이콘 활성화 상태 변경
            document.querySelectorAll('.icon-sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector('.icon-sidebar-item[title="캘린더"]').classList.add('active');

            // 중앙 패널에 캘린더 표시
            const centerPanel = document.querySelector('.center-panel');
            centerPanel.innerHTML = `
                <div class="calendar-view">
                    <div class="calendar-header">
                        <div class="calendar-nav">
                            <button class="calendar-nav-btn" onclick="changeMonth(-1)">◀</button>
                            <button class="calendar-nav-btn" onclick="goToday()">오늘</button>
                            <button class="calendar-nav-btn" onclick="changeMonth(1)">▶</button>
                        </div>
                        <div class="calendar-title" id="calendarTitle">2026년 1월</div>
                    </div>

                    <div class="calendar-filter">
                        <input type="text" class="calendar-filter-input" placeholder="회사명 검색..."
                               id="companyFilter" onkeyup="filterCalendarEvents()">
                        <select class="calendar-filter-select" id="sourceFilter" onchange="filterCalendarEvents()">
                            <option value="">전체 출처</option>
                            <option value="earnings">실적발표</option>
                            <option value="news">뉴스</option>
                            <option value="report">보고서</option>
                            <option value="conference">컨퍼런스</option>
                            <option value="dividend">배당</option>
                        </select>
                    </div>

                    <div class="calendar-legend">
                        <div class="calendar-legend-item">
                            <div class="calendar-legend-color" style="background: var(--claude-crail);"></div>
                            <span>실적발표</span>
                        </div>
                        <div class="calendar-legend-item">
                            <div class="calendar-legend-color" style="background: var(--claude-sage);"></div>
                            <span>뉴스</span>
                        </div>
                        <div class="calendar-legend-item">
                            <div class="calendar-legend-color" style="background: var(--claude-tan);"></div>
                            <span>보고서</span>
                        </div>
                        <div class="calendar-legend-item">
                            <div class="calendar-legend-color" style="background: var(--claude-lavender);"></div>
                            <span>컨퍼런스</span>
                        </div>
                        <div class="calendar-legend-item">
                            <div class="calendar-legend-color" style="background: var(--claude-coffee);"></div>
                            <span>배당</span>
                        </div>
                    </div>

                    <div class="calendar-grid" id="calendarGrid">
                        <!-- 요일 헤더 -->
                        <div class="calendar-day-header">일</div>
                        <div class="calendar-day-header">월</div>
                        <div class="calendar-day-header">화</div>
                        <div class="calendar-day-header">수</div>
                        <div class="calendar-day-header">목</div>
                        <div class="calendar-day-header">금</div>
                        <div class="calendar-day-header">토</div>
                        <!-- 날짜 셀은 JavaScript로 동적 생성 -->
                    </div>
                </div>
            `;

            // 우측 패널에 미니 캘린더 + 통계 표시
            const rightPanel = document.querySelector('.right-panel');
            rightPanel.innerHTML = `
                <div class="mini-calendar">
                    <div class="mini-calendar-header">
                        <span class="mini-calendar-title" id="miniCalendarTitle">2026년 1월</span>
                        <div class="mini-calendar-nav-group">
                            <button class="mini-calendar-nav" onclick="changeMiniMonth(-1)">&lt;</button>
                            <button class="mini-calendar-nav" onclick="changeMiniMonth(1)">&gt;</button>
                        </div>
                    </div>
                    <div class="mini-calendar-weekdays">
                        <div>일</div><div>월</div><div>화</div><div>수</div><div>목</div><div>금</div><div>토</div>
                    </div>
                    <div class="mini-calendar-grid" id="miniCalendarGrid"></div>
                </div>
                <div class="calendar-stats" id="calendarStats"></div>
            `;

            renderCalendar(currentCalendarDate);
            renderMiniCalendar(currentCalendarDate);
            updateCalendarStats();
        }

        // 미니 캘린더 날짜 변수
        let miniCalendarDate = new Date();

        function renderMiniCalendar(date) {
            miniCalendarDate = new Date(date);
            const year = date.getFullYear();
            const month = date.getMonth();

            // 타이틀 업데이트
            const titleEl = document.getElementById('miniCalendarTitle');
            if (titleEl) titleEl.textContent = `${year}년 ${month + 1}월`;

            const grid = document.getElementById('miniCalendarGrid');
            if (!grid) return;

            grid.innerHTML = '';

            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startDayOfWeek = firstDay.getDay();
            const prevLastDay = new Date(year, month, 0).getDate();

            const today = new Date();
            const todayStr = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;

            // 이벤트가 있는 날짜 Set
            const eventDates = new Set(calendarEvents.map(e => e.date));

            for (let i = 0; i < 42; i++) {
                const dayCell = document.createElement('div');
                dayCell.className = 'mini-calendar-day';

                let dayNumber;
                let cellDate;
                let isCurrentMonth = true;

                if (i < startDayOfWeek) {
                    dayNumber = prevLastDay - startDayOfWeek + i + 1;
                    cellDate = new Date(year, month - 1, dayNumber);
                    isCurrentMonth = false;
                } else if (i >= startDayOfWeek + lastDay.getDate()) {
                    dayNumber = i - startDayOfWeek - lastDay.getDate() + 1;
                    cellDate = new Date(year, month + 1, dayNumber);
                    isCurrentMonth = false;
                } else {
                    dayNumber = i - startDayOfWeek + 1;
                    cellDate = new Date(year, month, dayNumber);
                }

                if (isCurrentMonth) dayCell.classList.add('current-month');

                const dateStr = `${cellDate.getFullYear()}-${String(cellDate.getMonth() + 1).padStart(2, '0')}-${String(cellDate.getDate()).padStart(2, '0')}`;

                if (dateStr === todayStr) dayCell.classList.add('today');
                if (eventDates.has(dateStr)) dayCell.classList.add('has-event');

                dayCell.textContent = dayNumber;
                dayCell.onclick = () => {
                    currentCalendarDate = new Date(cellDate);
                    renderCalendar(currentCalendarDate);
                };
                grid.appendChild(dayCell);
            }
        }

        function changeMiniMonth(delta) {
            miniCalendarDate.setMonth(miniCalendarDate.getMonth() + delta);
            renderMiniCalendar(miniCalendarDate);
        }

        function generatePieChart(data) {
            const total = data.reduce((sum, item) => sum + item.value, 0);
            if (total === 0) {
                return `<svg class="pie-chart" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="40" fill="none" stroke="var(--border-color)" stroke-width="12"/>
                    <text x="50" y="50" text-anchor="middle" dy=".3em" fill="var(--text-muted)" font-size="10">데이터 없음</text>
                </svg>`;
            }

            const outerRadius = 44;
            const innerRadius = 28;
            let paths = '';
            let currentAngle = -90; // 12시 방향에서 시작

            data.forEach(item => {
                if (item.value === 0) return;

                const percentage = item.value / total;
                const angle = percentage * 360;
                const startAngle = currentAngle;
                const endAngle = currentAngle + angle;

                const startRad = (startAngle * Math.PI) / 180;
                const endRad = (endAngle * Math.PI) / 180;

                // 외부 호
                const outerX1 = 50 + outerRadius * Math.cos(startRad);
                const outerY1 = 50 + outerRadius * Math.sin(startRad);
                const outerX2 = 50 + outerRadius * Math.cos(endRad);
                const outerY2 = 50 + outerRadius * Math.sin(endRad);

                // 내부 호
                const innerX1 = 50 + innerRadius * Math.cos(startRad);
                const innerY1 = 50 + innerRadius * Math.sin(startRad);
                const innerX2 = 50 + innerRadius * Math.cos(endRad);
                const innerY2 = 50 + innerRadius * Math.sin(endRad);

                const largeArcFlag = angle > 180 ? 1 : 0;

                // 100%일 경우 도넛 전체를 그림
                if (percentage >= 0.9999) {
                    paths += `<circle cx="50" cy="50" r="${(outerRadius + innerRadius) / 2}" fill="none" stroke="${item.color}" stroke-width="${outerRadius - innerRadius}"/>`;
                } else {
                    // 도넛 조각: 외부 호 → 내부 호 (반대 방향)
                    paths += `<path d="M ${outerX1} ${outerY1} A ${outerRadius} ${outerRadius} 0 ${largeArcFlag} 1 ${outerX2} ${outerY2} L ${innerX2} ${innerY2} A ${innerRadius} ${innerRadius} 0 ${largeArcFlag} 0 ${innerX1} ${innerY1} Z" fill="${item.color}"/>`;
                }

                currentAngle = endAngle;
            });

            // 중앙에 전체 개수 표시
            return `<svg class="pie-chart" viewBox="0 0 100 100">
                ${paths}
                <text x="50" y="46" text-anchor="middle" fill="var(--text-primary)" font-size="14" font-weight="600">${total}</text>
                <text x="50" y="58" text-anchor="middle" fill="var(--text-muted)" font-size="8">이벤트</text>
            </svg>`;
        }

        function updateCalendarStats() {
            const statsEl = document.getElementById('calendarStats');
            if (!statsEl) return;

            const year = currentCalendarDate.getFullYear();
            const month = currentCalendarDate.getMonth();
            const monthStart = `${year}-${String(month + 1).padStart(2, '0')}-01`;
            const monthEnd = `${year}-${String(month + 1).padStart(2, '0')}-31`;

            // 이번 달 이벤트 필터링
            const monthEvents = calendarEvents.filter(e => e.date >= monthStart && e.date <= monthEnd);
            const earningsCount = monthEvents.filter(e => e.source === 'earnings').length;
            const newsCount = monthEvents.filter(e => e.source === 'news').length;
            const reportCount = monthEvents.filter(e => e.source === 'report').length;
            const conferenceCount = monthEvents.filter(e => e.source === 'conference').length;
            const dividendCount = monthEvents.filter(e => e.source === 'dividend').length;

            // 다가오는 일정 (오늘 이후)
            const today = new Date();
            const todayStr = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
            const upcoming = calendarEvents.filter(e => e.date >= todayStr).sort((a, b) => a.date.localeCompare(b.date)).slice(0, 3);

            const sourceColors = {
                earnings: '#C15F3C',    // Crail (러스트 오렌지)
                news: '#7D8471',        // Sage (세이지 그린)
                report: '#D4A574',      // Tan (따뜻한 베이지)
                conference: '#9B8AA6',  // Lavender (라벤더)
                dividend: '#A67B5B'     // Coffee (커피 브라운)
            };

            // 파이 차트 데이터
            const pieData = [
                { label: '실적발표', value: earningsCount, color: sourceColors.earnings },
                { label: '뉴스', value: newsCount, color: sourceColors.news },
                { label: '보고서', value: reportCount, color: sourceColors.report },
                { label: '컨퍼런스', value: conferenceCount, color: sourceColors.conference },
                { label: '배당', value: dividendCount, color: sourceColors.dividend }
            ];

            const pieChartSvg = generatePieChart(pieData);
            const pieLegendHtml = pieData.filter(d => d.value > 0).map(d => `
                <div class="pie-legend-item">
                    <div class="pie-legend-color" style="background:${d.color}"></div>
                    <span>${d.label} (${d.value})</span>
                </div>
            `).join('');

            statsEl.innerHTML = `
                <div class="stats-header">이번 달 요약</div>
                <div class="pie-chart-container">
                    ${pieChartSvg}
                    <div class="pie-chart-legend">${pieLegendHtml}</div>
                </div>
                <div class="stats-item">
                    <span class="stats-label">전체 이벤트</span>
                    <span class="stats-value">${monthEvents.length}개</span>
                </div>
                <div class="stats-item">
                    <span class="stats-label">실적발표</span>
                    <span class="stats-value">${earningsCount}개</span>
                </div>
                <div class="stats-item">
                    <span class="stats-label">뉴스</span>
                    <span class="stats-value">${newsCount}개</span>
                </div>
                <div class="stats-item">
                    <span class="stats-label">보고서</span>
                    <span class="stats-value">${reportCount}개</span>
                </div>
                <div class="stats-item">
                    <span class="stats-label">컨퍼런스</span>
                    <span class="stats-value">${conferenceCount}개</span>
                </div>
                <div class="stats-item">
                    <span class="stats-label">배당</span>
                    <span class="stats-value">${dividendCount}개</span>
                </div>

                <div class="stats-divider"></div>

                <div class="stats-header">다가오는 일정</div>
                ${upcoming.length > 0 ? upcoming.map(event => `
                    <div class="upcoming-event">
                        <span class="upcoming-dot" style="color:${sourceColors[event.source] || 'var(--claude-crail)'}">●</span>
                        <div class="upcoming-info">
                            <div class="upcoming-title">${event.title}</div>
                            <div class="upcoming-date">${formatEventDate(event.date)}</div>
                        </div>
                    </div>
                `).join('') : '<div style="font-size:12px;color:var(--text-muted);">예정된 일정이 없습니다.</div>'}
            `;
        }

        function formatEventDate(dateStr) {
            const [year, month, day] = dateStr.split('-');
            return `${parseInt(month)}월 ${parseInt(day)}일`;
        }

        function renderCalendar(date) {
            const year = date.getFullYear();
            const month = date.getMonth();

            // 타이틀 업데이트
            document.getElementById('calendarTitle').textContent = `${year}년 ${month + 1}월`;

            // 이번 달 첫째 날과 마지막 날
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);

            // 첫째 날의 요일 (0: 일요일)
            const startDayOfWeek = firstDay.getDay();

            // 이전 달 마지막 날
            const prevLastDay = new Date(year, month, 0).getDate();

            // 그리드 생성 (헤더 제외하고 날짜 셀만)
            const grid = document.getElementById('calendarGrid');

            // 기존 날짜 셀 제거 (헤더는 유지)
            const existingDays = grid.querySelectorAll('.calendar-day');
            existingDays.forEach(day => day.remove());

            // 필터 값 가져오기
            const companyFilter = document.getElementById('companyFilter')?.value.toLowerCase() || '';
            const sourceFilter = document.getElementById('sourceFilter')?.value || '';

            // 오늘 날짜
            const today = new Date();
            const todayStr = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;

            // 총 42셀 (6주)
            for (let i = 0; i < 42; i++) {
                const dayCell = document.createElement('div');
                dayCell.className = 'calendar-day';

                let dayNumber;
                let cellDate;
                let isOtherMonth = false;

                if (i < startDayOfWeek) {
                    // 이전 달
                    dayNumber = prevLastDay - startDayOfWeek + i + 1;
                    cellDate = new Date(year, month - 1, dayNumber);
                    isOtherMonth = true;
                } else if (i >= startDayOfWeek + lastDay.getDate()) {
                    // 다음 달
                    dayNumber = i - startDayOfWeek - lastDay.getDate() + 1;
                    cellDate = new Date(year, month + 1, dayNumber);
                    isOtherMonth = true;
                } else {
                    // 이번 달
                    dayNumber = i - startDayOfWeek + 1;
                    cellDate = new Date(year, month, dayNumber);
                }

                if (isOtherMonth) {
                    dayCell.classList.add('other-month');
                }

                // 요일 스타일
                const dayOfWeek = i % 7;
                if (dayOfWeek === 0) dayCell.classList.add('sunday');
                if (dayOfWeek === 6) dayCell.classList.add('saturday');

                // 날짜 문자열
                const dateStr = `${cellDate.getFullYear()}-${String(cellDate.getMonth() + 1).padStart(2, '0')}-${String(cellDate.getDate()).padStart(2, '0')}`;

                // 오늘 표시
                if (dateStr === todayStr) {
                    dayCell.classList.add('today');
                }

                // 날짜 번호
                const dayNumberDiv = document.createElement('div');
                dayNumberDiv.className = 'calendar-day-number';
                dayNumberDiv.textContent = dayNumber;
                dayCell.appendChild(dayNumberDiv);

                // 해당 날짜의 이벤트 필터링 및 표시
                const dayEvents = calendarEvents.filter(event => {
                    if (event.date !== dateStr) return false;
                    if (companyFilter && !event.company.toLowerCase().includes(companyFilter)) return false;
                    if (sourceFilter && event.source !== sourceFilter) return false;
                    return true;
                });

                dayEvents.forEach(event => {
                    const eventDiv = document.createElement('div');
                    eventDiv.className = `calendar-event source-${event.source}`;
                    eventDiv.textContent = event.title;
                    eventDiv.onclick = () => showEventDetail(event);
                    dayCell.appendChild(eventDiv);
                });

                grid.appendChild(dayCell);
            }
        }

        function changeMonth(delta) {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() + delta);
            renderCalendar(currentCalendarDate);
            renderMiniCalendar(currentCalendarDate);
            updateCalendarStats();
        }

        function goToday() {
            currentCalendarDate = new Date();
            renderCalendar(currentCalendarDate);
            renderMiniCalendar(currentCalendarDate);
            updateCalendarStats();
        }

        function filterCalendarEvents() {
            renderCalendar(currentCalendarDate);
        }

        function showEventDetail(event) {
            // 기존 모달 제거
            const existingOverlay = document.querySelector('.calendar-modal-overlay');
            if (existingOverlay) existingOverlay.remove();
            const existingModal = document.querySelector('.calendar-event-modal');
            if (existingModal) existingModal.remove();

            // 모달 오버레이
            const overlay = document.createElement('div');
            overlay.className = 'calendar-modal-overlay';
            overlay.onclick = closeEventModal;

            // 모달
            const modal = document.createElement('div');
            modal.className = 'calendar-event-modal';

            const sourceNames = {
                earnings: '실적발표',
                news: '뉴스',
                report: '보고서',
                conference: '컨퍼런스',
                dividend: '배당'
            };

            modal.innerHTML = `
                <button class="calendar-modal-close" onclick="closeEventModal()">×</button>
                <div class="calendar-modal-header">${event.title}</div>
                <p><strong>회사:</strong> ${event.company}</p>
                <p><strong>날짜:</strong> ${event.date}</p>
                <p><strong>유형:</strong> <span class="calendar-event source-${event.source}" style="display: inline-block;">${sourceNames[event.source]}</span></p>
            `;

            document.body.appendChild(overlay);
            document.body.appendChild(modal);
        }

        function closeEventModal() {
            const overlay = document.querySelector('.calendar-modal-overlay');
            const modal = document.querySelector('.calendar-event-modal');
            if (overlay) overlay.remove();
            if (modal) modal.remove();
        }

        // 차트 뷰로 돌아가기
        function showChartView() {
            // 사이드바 아이콘 활성화 상태 변경
            document.querySelectorAll('.icon-sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector('.icon-sidebar-item[title="차트"]').classList.add('active');

            // 페이지 새로고침하여 원래 상태로 복원
            location.reload();
        }

        // 도넛 차트 렌더링 함수
        function renderDonutChart(container, data, unit, centerLabel) {
            const total = data.data.reduce((a, b) => a + b, 0);
            const size = 200;
            const strokeWidth = 35;
            const radius = (size - strokeWidth) / 2;
            const circumference = 2 * Math.PI * radius;

            let currentOffset = 0;
            let circles = '';

            data.data.forEach((value, index) => {
                const percentage = value / total;
                const dashLength = circumference * percentage;
                const dashOffset = circumference - currentOffset;
                const color = data.colors[index];

                circles += `
                    <circle
                        cx="${size/2}"
                        cy="${size/2}"
                        r="${radius}"
                        fill="none"
                        stroke="${color}"
                        stroke-width="${strokeWidth}"
                        stroke-dasharray="${dashLength} ${circumference - dashLength}"
                        stroke-dashoffset="${dashOffset}"
                        style="transition: stroke-dashoffset 0.5s ease;"
                    />
                `;
                currentOffset += dashLength;
            });

            let legendItems = '';
            data.categories.forEach((category, index) => {
                legendItems += `
                    <div class="donut-legend-item">
                        <div class="donut-legend-color" style="background: ${data.colors[index]};"></div>
                        <span class="donut-legend-label">${category}</span>
                        <span class="donut-legend-value">${data.data[index]}${unit}</span>
                    </div>
                `;
            });

            container.innerHTML = `
                <div class="donut-chart-wrapper">
                    <svg width="${size}" height="${size}" class="donut-chart-svg">
                        ${circles}
                        <g transform="rotate(90, ${size/2}, ${size/2})">
                            <text x="${size/2}" y="${size/2 - 8}" class="donut-center-text donut-center-value">${total.toFixed(1)}</text>
                            <text x="${size/2}" y="${size/2 + 14}" class="donut-center-text donut-center-label">${centerLabel}</text>
                        </g>
                    </svg>
                    <div class="donut-legend">
                        ${legendItems}
                    </div>
                </div>
            `;
        }

        // 파이 차트 렌더링 함수
        function renderPieChart(container, data, unit) {
            const total = data.data.reduce((a, b) => a + b, 0);
            const size = 200;
            const cx = size / 2;
            const cy = size / 2;
            const radius = size / 2 - 10;

            let currentAngle = -90;
            let paths = '';

            data.data.forEach((value, index) => {
                const percentage = value / total;
                const angle = percentage * 360;
                const startAngle = currentAngle;
                const endAngle = currentAngle + angle;

                const startRad = (startAngle * Math.PI) / 180;
                const endRad = (endAngle * Math.PI) / 180;

                const x1 = cx + radius * Math.cos(startRad);
                const y1 = cy + radius * Math.sin(startRad);
                const x2 = cx + radius * Math.cos(endRad);
                const y2 = cy + radius * Math.sin(endRad);

                const largeArcFlag = angle > 180 ? 1 : 0;

                const pathData = `M ${cx} ${cy} L ${x1} ${y1} A ${radius} ${radius} 0 ${largeArcFlag} 1 ${x2} ${y2} Z`;

                paths += `<path d="${pathData}" fill="${data.colors[index]}" style="transition: opacity 0.3s;" onmouseover="this.style.opacity=0.8" onmouseout="this.style.opacity=1"/>`;

                currentAngle += angle;
            });

            let legendItems = '';
            data.categories.forEach((category, index) => {
                const pct = ((data.data[index] / total) * 100).toFixed(0);
                legendItems += `
                    <div class="pie-legend-item">
                        <div class="pie-legend-color" style="background: ${data.colors[index]};"></div>
                        <span class="pie-legend-label">${category}</span>
                        <span class="pie-legend-value">${data.data[index]}${unit} (${pct}%)</span>
                    </div>
                `;
            });

            container.innerHTML = `
                <div class="pie-chart-wrapper">
                    <svg width="${size}" height="${size}">
                        ${paths}
                    </svg>
                    <div class="pie-legend">
                        ${legendItems}
                    </div>
                </div>
            `;
        }

        // 레이더 차트 렌더링 함수
        function renderRadarChart(container, data, unit) {
            const size = 240;
            const cx = size / 2;
            const cy = size / 2;
            const maxRadius = size / 2 - 40;
            const levels = 4;
            const maxValue = Math.max(...data.data);
            const angleStep = (2 * Math.PI) / data.categories.length;

            // 배경 그리드 생성
            let gridLines = '';
            for (let level = 1; level <= levels; level++) {
                const r = (maxRadius / levels) * level;
                let points = [];
                for (let i = 0; i < data.categories.length; i++) {
                    const angle = i * angleStep - Math.PI / 2;
                    const x = cx + r * Math.cos(angle);
                    const y = cy + r * Math.sin(angle);
                    points.push(`${x},${y}`);
                }
                gridLines += `<polygon points="${points.join(' ')}" fill="none" stroke="var(--border-color)" stroke-width="1" opacity="0.5"/>`;
            }

            // 축 그리기
            let axes = '';
            let labels = '';
            for (let i = 0; i < data.categories.length; i++) {
                const angle = i * angleStep - Math.PI / 2;
                const x = cx + maxRadius * Math.cos(angle);
                const y = cy + maxRadius * Math.sin(angle);
                axes += `<line x1="${cx}" y1="${cy}" x2="${x}" y2="${y}" stroke="var(--border-color)" stroke-width="1" opacity="0.5"/>`;

                const labelX = cx + (maxRadius + 25) * Math.cos(angle);
                const labelY = cy + (maxRadius + 25) * Math.sin(angle);
                labels += `<text x="${labelX}" y="${labelY}" text-anchor="middle" dominant-baseline="middle" fill="var(--text-secondary)" font-size="12">${data.categories[i]}</text>`;
            }

            // 데이터 폴리곤 생성
            let dataPoints = [];
            for (let i = 0; i < data.data.length; i++) {
                const value = data.data[i];
                const r = (value / maxValue) * maxRadius;
                const angle = i * angleStep - Math.PI / 2;
                const x = cx + r * Math.cos(angle);
                const y = cy + r * Math.sin(angle);
                dataPoints.push(`${x},${y}`);
            }

            // 데이터 점 생성
            let dots = '';
            for (let i = 0; i < data.data.length; i++) {
                const value = data.data[i];
                const r = (value / maxValue) * maxRadius;
                const angle = i * angleStep - Math.PI / 2;
                const x = cx + r * Math.cos(angle);
                const y = cy + r * Math.sin(angle);
                dots += `<circle cx="${x}" cy="${y}" r="5" fill="${data.colors[i]}" stroke="white" stroke-width="2"/>`;
            }

            let legendItems = '';
            data.categories.forEach((category, index) => {
                legendItems += `
                    <div class="radar-legend-item">
                        <div class="radar-legend-color" style="background: ${data.colors[index]};"></div>
                        <span class="radar-legend-label">${category}</span>
                        <span class="radar-legend-value">${data.data[index]}${unit}</span>
                    </div>
                `;
            });

            container.innerHTML = `
                <div class="radar-chart-wrapper">
                    <svg width="${size}" height="${size}">
                        ${gridLines}
                        ${axes}
                        <polygon points="${dataPoints.join(' ')}" fill="${industryColors[0]}" fill-opacity="0.3" stroke="${industryColors[0]}" stroke-width="2"/>
                        ${dots}
                        ${labels}
                    </svg>
                    <div class="radar-legend">
                        ${legendItems}
                    </div>
                </div>
            `;
        }

        // 산업간 비교 차트 렌더링 (도넛 차트) - 선택된 산업 기반
        function renderInterIndustryChart() {
            const container = document.getElementById('inter-industry-chart');
            if (!container) return;

            // 선택된 산업 데이터로 차트 데이터 생성
            const categories = selectedIndustries.map(key => extendedIndustryData.industries[key].name);
            const values = selectedIndustries.map(key => extendedIndustryData.industries[key].size);
            const colors = selectedIndustries.map((_, idx) => industryColors[idx % industryColors.length]);

            const data = {
                categories: categories,
                data: values,
                colors: colors
            };

            renderDonutChart(container, data, '조원', '총 시장규모');
        }

        // 산업내 비교 차트 렌더링 - 선택된 항목 기반
        function renderIntraIndustryChart() {
            const container = document.getElementById('intra-industry-chart');
            if (!container) return;

            let categories, values, colors, data;

            if (currentIndustryTab === 'competitors') {
                categories = selectedCompanies.map(key => extendedIndustryData.companies[key].name);
                values = selectedCompanies.map(key => extendedIndustryData.companies[key].revenue);
                colors = selectedCompanies.map((_, idx) => industryColors[idx % industryColors.length]);
                data = { categories, data: values, colors };
                renderDonutChart(container, data, '조원', '총 매출');

            } else if (currentIndustryTab === 'genres') {
                categories = selectedGenres.map(key => extendedIndustryData.genres[key].name);
                values = selectedGenres.map(key => extendedIndustryData.genres[key].share);
                colors = selectedGenres.map((_, idx) => industryColors[idx % industryColors.length]);
                data = { categories, data: values, colors };
                renderPieChart(container, data, '%');

            } else if (currentIndustryTab === 'regions') {
                categories = selectedRegions.map(key => extendedIndustryData.regions[key].name);
                values = selectedRegions.map(key => extendedIndustryData.regions[key].revenue);
                colors = selectedRegions.map((_, idx) => industryColors[idx % industryColors.length]);
                data = { categories, data: values, colors };
                renderRadarChart(container, data, '조원');
            }
        }

        // 탭 전환
        function switchIndustryTab(tab) {
            currentIndustryTab = tab;

            // 탭 활성화 상태 변경
            document.querySelectorAll('.industry-tab').forEach(t => {
                t.classList.remove('active');
            });
            document.querySelector(`.industry-tab[data-tab="${tab}"]`).classList.add('active');

            // 선택기, 차트, 테이블 다시 렌더링
            renderIntraSelectorItems();
            renderIntraIndustryChart();
            renderIntraTable();
        }

        // 매뉴얼 데이터 정의
        const manualData = {
            'getting-started': {
                title: '시작하기',
                icon: '🚀',
                description: '대시보드 기본 사용법',
                content: {
                    title: '대시보드 시작하기',
                    description: '넥슨 주가 대시보드의 기본 사용법을 안내합니다. 이 가이드를 통해 대시보드의 주요 기능을 빠르게 익힐 수 있습니다.',
                    sections: [
                        {
                            subtitle: '화면 구성',
                            text: '대시보드는 세 개의 주요 영역으로 구성되어 있습니다. 좌측의 아이콘 사이드바에서 기능을 선택하고, 중앙 패널에서 주요 콘텐츠를 확인하며, 우측 패널에서 상세 정보를 볼 수 있습니다.',
                            list: [
                                '<strong>아이콘 사이드바</strong>: 차트, 비교분석, 캘린더 등 주요 기능 접근',
                                '<strong>중앙 패널</strong>: 선택한 기능의 주요 콘텐츠 표시',
                                '<strong>우측 패널</strong>: 세부 정보 및 추가 옵션 제공'
                            ],
                            illustration: 'layout'
                        },
                        {
                            subtitle: '기본 조작법',
                            text: '좌측 사이드바의 아이콘을 클릭하여 원하는 기능으로 이동합니다. 각 패널 사이의 구분선을 드래그하여 패널 크기를 조절할 수 있습니다.',
                            tip: '패널 크기는 드래그로 자유롭게 조절 가능합니다. 편한 작업 환경을 만들어보세요!'
                        }
                    ]
                }
            },
            'chart': {
                title: '차트',
                icon: '📈',
                description: '주가 차트 보기',
                content: {
                    title: '주가 차트 사용하기',
                    description: '실시간 주가 데이터를 다양한 차트 형식으로 확인하고 분석할 수 있습니다.',
                    sections: [
                        {
                            subtitle: '차트 유형',
                            text: '캔들스틱 차트와 라인 차트를 지원합니다. 상단의 차트 유형 버튼을 클릭하여 전환할 수 있습니다.',
                            list: [
                                '<strong>캔들스틱</strong>: 시가, 고가, 저가, 종가를 한눈에 파악',
                                '<strong>라인 차트</strong>: 종가 추이를 부드러운 곡선으로 표시'
                            ],
                            illustration: 'chart-types'
                        },
                        {
                            subtitle: '확대/축소',
                            text: '마우스 휠을 스크롤하여 차트를 확대하거나 축소할 수 있습니다. 세부적인 가격 움직임을 확인하거나 전체 추세를 파악할 때 유용합니다.',
                            tip: '차트 위에서 마우스 휠을 위로 굴리면 확대, 아래로 굴리면 축소됩니다.'
                        },
                        {
                            subtitle: '기간 선택',
                            text: '상단의 기간 버튼(1일, 1주, 1개월, 3개월, 1년, 전체)을 클릭하여 원하는 기간의 데이터를 조회할 수 있습니다.',
                            illustration: 'period-selector'
                        },
                        {
                            subtitle: '상세 정보 확인',
                            text: '차트 위에 마우스를 올리면 해당 시점의 시가, 고가, 저가, 종가, 거래량 정보가 표시됩니다.',
                            tip: '십자선 커서를 따라 정확한 가격 정보를 확인할 수 있습니다.'
                        }
                    ]
                }
            },
            'analysis': {
                title: '비교분석',
                icon: '📊',
                description: '산업 및 경쟁사 분석',
                content: {
                    title: '비교분석 기능',
                    description: '넥슨을 산업 내 경쟁사와 비교 분석하고, 시장 점유율 및 재무 지표를 확인할 수 있습니다.',
                    sections: [
                        {
                            subtitle: '산업별 분석',
                            text: '게임 산업 내 주요 기업들의 시가총액, 매출, 영업이익 등을 비교할 수 있습니다.',
                            list: [
                                '시가총액 기준 순위 확인',
                                '매출 및 영업이익 비교',
                                '성장률 추이 분석'
                            ],
                            illustration: 'industry-analysis'
                        },
                        {
                            subtitle: '장르별/지역별 분석',
                            text: '탭을 전환하여 게임 장르별 시장 점유율이나 지역별 매출 분포를 확인할 수 있습니다.',
                            tip: '상단의 탭을 클릭하여 산업, 장르, 지역별 데이터를 전환하세요.'
                        }
                    ]
                }
            },
            'calendar': {
                title: '캘린더',
                icon: '📅',
                description: '일정 및 이벤트 관리',
                content: {
                    title: '캘린더 사용하기',
                    description: '실적 발표, 배당 일정, 게임 출시 등 주요 이벤트를 캘린더에서 확인할 수 있습니다.',
                    sections: [
                        {
                            subtitle: '이벤트 종류',
                            text: '다양한 종류의 이벤트가 색상으로 구분되어 표시됩니다.',
                            list: [
                                '<span style="color:#e57b53">●</span> <strong>실적 발표</strong>: 분기별 실적 발표 일정',
                                '<span style="color:#4ade80">●</span> <strong>배당</strong>: 배당금 지급 일정',
                                '<span style="color:#60a5fa">●</span> <strong>게임 출시</strong>: 신작 게임 출시 일정',
                                '<span style="color:#a78bfa">●</span> <strong>IR 행사</strong>: 투자자 설명회 등'
                            ]
                        },
                        {
                            subtitle: '필터 사용',
                            text: '우측 패널의 필터를 사용하여 특정 유형의 이벤트만 표시할 수 있습니다. 원하는 카테고리를 체크하거나 해제하세요.',
                            illustration: 'calendar-filter'
                        },
                        {
                            subtitle: '상세 정보 보기',
                            text: '캘린더의 이벤트를 클릭하면 팝업에서 상세 정보를 확인할 수 있습니다.',
                            tip: '이벤트 클릭 시 시간, 장소, 상세 설명 등의 추가 정보가 표시됩니다.'
                        }
                    ]
                }
            },
            'notifications': {
                title: '알림',
                icon: '🔔',
                description: '알림 설정 및 확인',
                content: {
                    title: '알림 기능',
                    description: '중요한 이벤트나 가격 변동에 대한 알림을 설정하고 관리할 수 있습니다.',
                    sections: [
                        {
                            subtitle: '알림 종류',
                            text: '다양한 유형의 알림을 설정할 수 있습니다.',
                            list: [
                                '<strong>가격 알림</strong>: 목표가 도달 시 알림',
                                '<strong>변동률 알림</strong>: 일정 % 이상 변동 시 알림',
                                '<strong>이벤트 알림</strong>: 실적 발표, 배당 등 일정 알림',
                                '<strong>뉴스 알림</strong>: 관련 뉴스 발생 시 알림'
                            ]
                        },
                        {
                            subtitle: '알림 관리',
                            text: '설정된 알림 목록을 확인하고, 개별 알림을 수정하거나 삭제할 수 있습니다.',
                            tip: '알림 오른쪽의 토글 스위치로 개별 알림을 켜고 끌 수 있습니다.'
                        }
                    ]
                }
            },
            'search': {
                title: '검색',
                icon: '🔍',
                description: '종목 및 데이터 검색',
                content: {
                    title: '검색 기능',
                    description: '종목, 뉴스, 공시 등 다양한 데이터를 빠르게 검색할 수 있습니다.',
                    sections: [
                        {
                            subtitle: '종목 검색',
                            text: '차트 상단의 검색창에서 종목명이나 종목코드를 입력하여 검색할 수 있습니다. 자동완성 기능으로 빠르게 원하는 종목을 찾을 수 있습니다.',
                            tip: 'Enter 키를 눌러 검색하거나, 자동완성 목록에서 직접 선택하세요.'
                        },
                        {
                            subtitle: '검색 필터',
                            text: '검색 결과를 카테고리별로 필터링할 수 있습니다.',
                            list: [
                                '종목별 필터링',
                                '기간별 필터링',
                                '유형별 필터링 (뉴스, 공시 등)'
                            ]
                        }
                    ]
                }
            }
        };

        // 테마 전환 함수
        function toggleTheme() {
            const html = document.documentElement;
            const current = html.getAttribute('data-theme');
            const newTheme = current === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        }

        // 테마 아이콘 업데이트 함수
        function updateThemeIcon(theme) {
            const themeIcon = document.getElementById('themeIcon');
            if (theme === 'light') {
                // 라이트 모드일 때 해(sun) 아이콘 표시
                themeIcon.innerHTML = `
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                `;
            } else {
                // 다크 모드일 때 달(moon) 아이콘 표시
                themeIcon.innerHTML = `
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                `;
            }
        }

        // 알림 모달 현재 탭 상태
        let currentNotificationTab = 'all';
        let companyDropdownOpen = false;

        // 읽지 않은 알림 badge 업데이트
        function updateNotificationBadge() {
            const unreadCount = notificationData.filter(n => !n.read).length;
            const badge = document.getElementById('notificationBadge');
            if (badge) {
                if (unreadCount > 0) {
                    badge.classList.add('show');
                } else {
                    badge.classList.remove('show');
                }
            }
        }

        // 페이지 로드 시 badge 초기화
        document.addEventListener('DOMContentLoaded', function() {
            updateNotificationBadge();
        });

        // 알림 표시 함수
        function showNotifications() {
            const existing = document.getElementById('notificationModal');
            if (existing) {
                closeNotificationModal();
                return;
            }

            const iconEl = document.querySelector('.icon-sidebar-item[title="알람"]');
            const rect = iconEl.getBoundingClientRect();

            const modal = document.createElement('div');
            modal.id = 'notificationModal';
            modal.className = 'notification-modal';
            modal.style.left = (rect.right + 8) + 'px';
            modal.style.top = Math.min(rect.top, window.innerHeight - 500) + 'px';
            modal.innerHTML = renderNotificationContent('all');
            document.body.appendChild(modal);

            // 외부 클릭 시 닫기
            setTimeout(() => {
                document.addEventListener('click', handleNotificationOutsideClick);
            }, 10);
        }

        function closeNotificationModal() {
            const modal = document.getElementById('notificationModal');
            if (modal) {
                modal.remove();
            }
            document.removeEventListener('click', handleNotificationOutsideClick);
            companyDropdownOpen = false;
        }

        function handleNotificationOutsideClick(e) {
            const modal = document.getElementById('notificationModal');
            const iconEl = document.querySelector('.icon-sidebar-item[title="알람"]');
            if (modal && !modal.contains(e.target) && !iconEl.contains(e.target)) {
                closeNotificationModal();
            }
        }

        function renderNotificationContent(tab) {
            currentNotificationTab = tab;

            const unreadCount = notificationData.filter(n => !n.read).length;

            let html = `
                <div class="notification-header">
                    <h3>NOTIFICATIONS</h3>
                    <button class="notification-mark-read" onclick="markAllAsRead(event)">
                        모두 읽음 ✓
                    </button>
                </div>
                <div class="notification-tabs">
                    <div class="notification-tab ${tab === 'all' ? 'active' : ''}" onclick="switchNotificationTab(event, 'all')">전체</div>
                    <div class="notification-tab ${tab === 'company' ? 'active' : ''}" onclick="switchNotificationTab(event, 'company')">회사</div>
                    <div class="notification-tab ${tab === 'reply' ? 'active' : ''}" onclick="switchNotificationTab(event, 'reply')">답글</div>
                    <div class="notification-tab ${tab === 'settings' ? 'active' : ''}" onclick="switchNotificationTab(event, 'settings')">⚙ 설정</div>
                </div>
            `;

            if (tab === 'settings') {
                html += renderNotificationSettings();
            } else {
                html += renderNotificationList(tab);
            }

            return html;
        }

        function renderNotificationList(tab) {
            let filteredData = notificationData;

            if (tab === 'company') {
                filteredData = notificationData.filter(n => n.type === 'company');
            } else if (tab === 'reply') {
                filteredData = notificationData.filter(n => n.type === 'reply');
            }

            if (filteredData.length === 0) {
                return `
                    <div class="notification-empty">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                        </svg>
                        <h4>알림이 없습니다</h4>
                        <p>관심 회사를 등록하면<br>새로운 소식을 받아볼 수 있어요</p>
                        <button onclick="switchNotificationTab(event, 'settings')">알림 설정하기</button>
                    </div>
                `;
            }

            let html = '<div class="notification-list">';
            filteredData.forEach(item => {
                const timeAgo = formatTimeAgo(item.date);
                const isUnread = !item.read;

                let desc = '';
                if (item.type === 'company') {
                    desc = `관심 회사 업데이트 · ${item.company}`;
                } else if (item.type === 'reply') {
                    desc = `"${item.content}" - ${item.author}`;
                }

                html += `
                    <div class="notification-item ${isUnread ? 'unread' : ''}" onclick="markAsRead(event, '${item.id}')">
                        <div class="notification-item-header">
                            <div class="notification-item-title">
                                <span class="dot"></span>
                                ${item.title}
                            </div>
                            <span class="notification-item-time">${timeAgo}</span>
                        </div>
                        <div class="notification-item-desc">${desc}</div>
                    </div>
                `;
            });
            html += '</div>';

            return html;
        }

        function renderNotificationSettings() {
            return `
                <div class="notification-settings">
                    <div class="notification-settings-section">
                        <h4>게시글 알림</h4>
                        <div class="notification-toggle-item">
                            <span class="notification-toggle-label">내 글에 댓글이 달리면</span>
                            <div class="notification-toggle ${notificationSettings.postNotifications.commentOnMyPost ? 'active' : ''}" onclick="togglePostNotification(event, 'commentOnMyPost')"></div>
                        </div>
                        <div class="notification-toggle-item">
                            <span class="notification-toggle-label">내 댓글에 답글이 달리면</span>
                            <div class="notification-toggle ${notificationSettings.postNotifications.replyToMyComment ? 'active' : ''}" onclick="togglePostNotification(event, 'replyToMyComment')"></div>
                        </div>
                        <div class="notification-toggle-item">
                            <span class="notification-toggle-label">내가 멘션되면</span>
                            <div class="notification-toggle ${notificationSettings.postNotifications.mentionMe ? 'active' : ''}" onclick="togglePostNotification(event, 'mentionMe')"></div>
                        </div>
                    </div>
                    <div class="notification-settings-section">
                        <h4>알림 전달 방식</h4>
                        <div class="notification-toggle-item">
                            <span class="notification-toggle-label">이메일 알림</span>
                            <div class="notification-toggle ${notificationSettings.emailNotification ? 'active' : ''}" onclick="toggleEmailNotification(event)"></div>
                        </div>
                        <div class="notification-email-input" style="display: ${notificationSettings.emailNotification ? 'block' : 'none'};">
                            <input type="email" placeholder="이메일 주소 입력" value="${notificationSettings.emailAddress}" onchange="updateEmailAddress(event)" />
                        </div>
                    </div>
                    <div class="notification-settings-section">
                        <h4>알림 빈도</h4>
                        <div class="notification-radio-group">
                            <div class="notification-radio-item" onclick="event.stopPropagation(); updateNotificationFrequency('realtime')">
                                <input type="radio" name="notificationFrequency" value="realtime" ${notificationSettings.notificationFrequency === 'realtime' ? 'checked' : ''}>
                                <label>실시간</label>
                            </div>
                            <div class="notification-radio-item" onclick="event.stopPropagation(); updateNotificationFrequency('daily')">
                                <input type="radio" name="notificationFrequency" value="daily" ${notificationSettings.notificationFrequency === 'daily' ? 'checked' : ''}>
                                <label>매일 요약</label>
                            </div>
                            <div class="notification-radio-item" onclick="event.stopPropagation(); updateNotificationFrequency('weekly')">
                                <input type="radio" name="notificationFrequency" value="weekly" ${notificationSettings.notificationFrequency === 'weekly' ? 'checked' : ''}>
                                <label>매주 요약</label>
                            </div>
                        </div>
                    </div>
                    <div class="notification-settings-section">
                        <h4>알림음</h4>
                        <div class="notification-toggle-item">
                            <span class="notification-toggle-label">알림음 사용</span>
                            <div class="notification-toggle ${notificationSettings.soundEnabled ? 'active' : ''}" onclick="toggleSoundNotification(event)"></div>
                        </div>
                    </div>
                    <div class="notification-settings-section">
                        <h4>조용한 시간대</h4>
                        <div class="notification-toggle-item">
                            <span class="notification-toggle-label">조용한 시간대 설정</span>
                            <div class="notification-toggle ${notificationSettings.quietHoursEnabled ? 'active' : ''}" onclick="toggleQuietHours(event)"></div>
                        </div>
                        <div class="notification-quiet-hours" style="display: ${notificationSettings.quietHoursEnabled ? 'flex' : 'none'};">
                            <input type="time" value="${notificationSettings.quietHoursStart}" onchange="updateQuietHoursStart(event)" /> ~ <input type="time" value="${notificationSettings.quietHoursEnd}" onchange="updateQuietHoursEnd(event)" />
                        </div>
                    </div>
                </div>
            `;
        }

        function switchNotificationTab(event, tab) {
            event.stopPropagation();
            companyDropdownOpen = false;
            const modal = document.getElementById('notificationModal');
            if (modal) {
                modal.innerHTML = renderNotificationContent(tab);
            }
        }

        function markAsRead(event, id) {
            event.stopPropagation();
            const item = notificationData.find(n => n.id === id);
            if (item) {
                item.read = true;
                const modal = document.getElementById('notificationModal');
                if (modal) {
                    modal.innerHTML = renderNotificationContent(currentNotificationTab);
                }
                updateNotificationBadge();
            }
        }

        function markAllAsRead(event) {
            event.stopPropagation();
            notificationData.forEach(n => n.read = true);
            const modal = document.getElementById('notificationModal');
            if (modal) {
                modal.innerHTML = renderNotificationContent(currentNotificationTab);
            }
            updateNotificationBadge();
        }

        function toggleCompanyDropdown(event) {
            event.stopPropagation();
            companyDropdownOpen = !companyDropdownOpen;
            const dropdown = document.getElementById('companyDropdown');
            if (dropdown) {
                dropdown.style.display = companyDropdownOpen ? 'block' : 'none';
            }
        }

        function addCompanyToWatch(event, company) {
            event.stopPropagation();
            if (!notificationSettings.companies.hasOwnProperty(company)) {
                notificationSettings.companies[company] = true;
            }
            companyDropdownOpen = false;
            const modal = document.getElementById('notificationModal');
            if (modal) {
                modal.innerHTML = renderNotificationContent('settings');
            }
        }

        function removeCompanyFromWatch(event, company) {
            event.stopPropagation();
            if (notificationSettings.companies.hasOwnProperty(company)) {
                delete notificationSettings.companies[company];
            }
            const modal = document.getElementById('notificationModal');
            if (modal) {
                modal.innerHTML = renderNotificationContent('settings');
            }
        }

        function toggleCompanyNotification(event, company) {
            event.stopPropagation();
            if (notificationSettings.companies.hasOwnProperty(company)) {
                notificationSettings.companies[company] = !notificationSettings.companies[company];
            }
            const modal = document.getElementById('notificationModal');
            if (modal) {
                modal.innerHTML = renderNotificationContent('settings');
            }
        }

        function togglePostNotification(event, key) {
            event.stopPropagation();
            notificationSettings.postNotifications[key] = !notificationSettings.postNotifications[key];
            const modal = document.getElementById('notificationModal');
            if (modal) {
                modal.innerHTML = renderNotificationContent('settings');
            }
        }

        function toggleEmailNotification(event) {
            event.stopPropagation();
            notificationSettings.emailNotification = !notificationSettings.emailNotification;
            const modal = document.getElementById('notificationModal');
            if (modal) {
                modal.innerHTML = renderNotificationContent('settings');
            }
        }

        function updateEmailAddress(event) {
            event.stopPropagation();
            notificationSettings.emailAddress = event.target.value;
        }

        function updateNotificationFrequency(value) {
            notificationSettings.notificationFrequency = value;
            const modal = document.getElementById('notificationModal');
            if (modal) {
                modal.innerHTML = renderNotificationContent('settings');
            }
        }

        function toggleSoundNotification(event) {
            event.stopPropagation();
            notificationSettings.soundEnabled = !notificationSettings.soundEnabled;
            const modal = document.getElementById('notificationModal');
            if (modal) {
                modal.innerHTML = renderNotificationContent('settings');
            }
        }

        function toggleQuietHours(event) {
            event.stopPropagation();
            notificationSettings.quietHoursEnabled = !notificationSettings.quietHoursEnabled;
            const modal = document.getElementById('notificationModal');
            if (modal) {
                modal.innerHTML = renderNotificationContent('settings');
            }
        }

        function updateQuietHoursStart(event) {
            event.stopPropagation();
            notificationSettings.quietHoursStart = event.target.value;
        }

        function updateQuietHoursEnd(event) {
            event.stopPropagation();
            notificationSettings.quietHoursEnd = event.target.value;
        }

        function formatTimeAgo(dateStr) {
            const date = new Date(dateStr);
            const now = new Date();
            const diffMs = now - date;
            const diffMins = Math.floor(diffMs / (1000 * 60));
            const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));

            if (diffMins < 60) {
                return `${diffMins}분 전`;
            } else if (diffHours < 24) {
                return `${diffHours}시간 전`;
            } else if (diffDays < 7) {
                return `${diffDays}일 전`;
            } else {
                return date.toLocaleDateString('ko-KR', { month: 'short', day: 'numeric' });
            }
        }

        // 페이지 로드 시 저장된 테마 적용
        (function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            // DOM 로드 후 아이콘 업데이트
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', () => updateThemeIcon(savedTheme));
            } else {
                updateThemeIcon(savedTheme);
            }
        })();

        // 사용자 매뉴얼 표시 함수
        function showUserManual() {
            // 사이드바 아이콘 활성화 상태 변경
            document.querySelectorAll('.icon-sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector('.icon-sidebar-item[title="매뉴얼"]').classList.add('active');

            // 우측 패널에 목차 표시
            const rightPanel = document.querySelector('.right-panel');
            rightPanel.innerHTML = `
                <div class="manual-toc">
                    <div class="manual-toc-header">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                            <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                        </svg>
                        사용자 매뉴얼
                    </div>
                    ${Object.entries(manualData).map(([key, data]) => `
                        <div class="manual-toc-item" data-manual="${key}" onclick="showManualDetail('${key}')">
                            <div class="manual-toc-text">
                                <div class="manual-toc-title">${data.title}</div>
                                <div class="manual-toc-desc">${data.description}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;

            // 중앙 패널에 환영 메시지 표시
            const centerPanel = document.querySelector('.center-panel');
            centerPanel.innerHTML = `
                <div class="manual-welcome">
                    <div class="manual-welcome-title">사용자 매뉴얼</div>
                    <div class="manual-welcome-text">
                        우측 목록에서 항목을 선택하면<br>
                        자세한 사용법을 확인할 수 있습니다.
                    </div>
                </div>
            `;

            // 첫 번째 항목 자동 선택
            setTimeout(() => showManualDetail('getting-started'), 100);
        }

        // 세팅 페이지 표시 함수
        function showSettings() {
            // 사이드바 아이콘 활성화 상태 변경
            document.querySelectorAll('.icon-sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector('.icon-sidebar-item[title="세팅"]').classList.add('active');

            // 중앙 패널에 세팅 페이지 표시
            const centerPanel = document.querySelector('.center-panel');
            centerPanel.innerHTML = `
                <div class="manual-welcome">
                    <div class="manual-welcome-title">세팅</div>
                    <div class="manual-welcome-text">
                        설정 페이지는 준비 중입니다.
                    </div>
                </div>
            `;

            // 우측 패널 초기화
            const rightPanel = document.querySelector('.right-panel');
            rightPanel.innerHTML = '';
        }

        // My 페이지 표시 함수
        function showMyPage() {
            // 사이드바 아이콘 활성화 상태 변경
            document.querySelectorAll('.icon-sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector('.icon-sidebar-item[title="My"]').classList.add('active');

            // 중앙 패널에 My 페이지 표시
            const centerPanel = document.querySelector('.center-panel');
            centerPanel.innerHTML = `
                <div class="manual-welcome">
                    <div class="manual-welcome-title">My 페이지</div>
                    <div class="manual-welcome-text">
                        My 페이지는 준비 중입니다.
                    </div>
                </div>
            `;

            // 우측 패널 초기화
            const rightPanel = document.querySelector('.right-panel');
            rightPanel.innerHTML = '';
        }

        // 매뉴얼 상세 표시 함수
        function showManualDetail(key) {
            const data = manualData[key];
            if (!data) return;

            // 목차에서 활성 상태 변경
            document.querySelectorAll('.manual-toc-item').forEach(item => {
                item.classList.remove('active');
            });
            const activeItem = document.querySelector(`[data-manual="${key}"]`);
            if (activeItem) activeItem.classList.add('active');

            // 중앙 패널에 상세 내용 표시
            const centerPanel = document.querySelector('.center-panel');
            centerPanel.innerHTML = `
                <div class="manual-detail">
                    <div class="manual-detail-header">
                        <h1 class="manual-detail-title">${data.content.title}</h1>
                        <p class="manual-detail-desc">${data.content.description}</p>
                    </div>
                    ${data.content.sections.map(section => `
                        <div class="manual-detail-section">
                            <h2 class="manual-detail-subtitle">${section.subtitle}</h2>
                            <p class="manual-detail-text">${section.text}</p>
                            ${section.list ? `
                                <ul class="manual-detail-list">
                                    ${section.list.map(item => `<li>${item}</li>`).join('')}
                                </ul>
                            ` : ''}
                            ${section.illustration ? renderManualIllustration(section.illustration) : ''}
                            ${section.tip ? `
                                <div class="manual-tip">
                                    <div class="manual-tip-title">팁</div>
                                    <div class="manual-tip-text">${section.tip}</div>
                                </div>
                            ` : ''}
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // 매뉴얼 일러스트레이션 렌더링
        function renderManualIllustration(type) {
            const illustrations = {
                'layout': `
                    <div class="manual-illustration">
                        <svg viewBox="0 0 400 200">
                            <!-- 배경 -->
                            <rect x="0" y="0" width="400" height="200" fill="var(--bg-medium)" rx="8"/>

                            <!-- 아이콘 사이드바 -->
                            <rect x="10" y="10" width="40" height="180" fill="var(--bg-dark)" rx="4"/>
                            <circle cx="30" cy="35" r="8" fill="var(--claude-orange)" opacity="0.3"/>
                            <circle cx="30" cy="60" r="8" fill="var(--claude-orange)" opacity="0.3"/>
                            <circle cx="30" cy="85" r="8" fill="var(--claude-orange)" opacity="0.3"/>
                            <circle cx="30" cy="110" r="8" fill="var(--claude-orange)"/>
                            <text x="30" y="140" font-size="8" fill="var(--text-muted)" text-anchor="middle">사이드바</text>

                            <!-- 중앙 패널 -->
                            <rect x="60" y="10" width="200" height="180" fill="var(--bg-dark)" rx="4"/>
                            <rect x="70" y="20" width="180" height="20" fill="var(--bg-light)" rx="2"/>
                            <rect x="70" y="50" width="180" height="100" fill="var(--bg-light)" rx="2"/>
                            <polyline points="80,120 110,90 140,110 170,70 200,100 230,80" stroke="var(--claude-orange)" stroke-width="2" fill="none"/>
                            <text x="160" y="170" font-size="8" fill="var(--text-muted)" text-anchor="middle">중앙 패널</text>

                            <!-- 우측 패널 -->
                            <rect x="270" y="10" width="120" height="180" fill="var(--bg-dark)" rx="4"/>
                            <rect x="280" y="20" width="100" height="15" fill="var(--bg-light)" rx="2"/>
                            <rect x="280" y="45" width="100" height="40" fill="var(--bg-light)" rx="2"/>
                            <rect x="280" y="95" width="100" height="40" fill="var(--bg-light)" rx="2"/>
                            <text x="330" y="170" font-size="8" fill="var(--text-muted)" text-anchor="middle">우측 패널</text>
                        </svg>
                        <div class="illustration-caption">대시보드 화면 구성</div>
                    </div>
                `,
                'chart-types': `
                    <div class="manual-illustration">
                        <svg viewBox="0 0 400 150">
                            <!-- 캔들스틱 -->
                            <rect x="10" y="10" width="180" height="130" fill="var(--bg-dark)" rx="4"/>
                            <text x="100" y="30" font-size="10" fill="var(--text-primary)" text-anchor="middle">캔들스틱</text>
                            <!-- 캔들들 -->
                            <rect x="35" y="50" width="8" height="40" fill="#4ade80"/>
                            <line x1="39" y1="45" x2="39" y2="95" stroke="#4ade80" stroke-width="1"/>
                            <rect x="55" y="60" width="8" height="30" fill="#ef4444"/>
                            <line x1="59" y1="55" x2="59" y2="100" stroke="#ef4444" stroke-width="1"/>
                            <rect x="75" y="45" width="8" height="50" fill="#4ade80"/>
                            <line x1="79" y1="40" x2="79" y2="100" stroke="#4ade80" stroke-width="1"/>
                            <rect x="95" y="55" width="8" height="35" fill="#4ade80"/>
                            <line x1="99" y1="50" x2="99" y2="95" stroke="#4ade80" stroke-width="1"/>
                            <rect x="115" y="70" width="8" height="25" fill="#ef4444"/>
                            <line x1="119" y1="65" x2="119" y2="105" stroke="#ef4444" stroke-width="1"/>
                            <rect x="135" y="50" width="8" height="45" fill="#4ade80"/>
                            <line x1="139" y1="45" x2="139" y2="100" stroke="#4ade80" stroke-width="1"/>
                            <rect x="155" y="40" width="8" height="50" fill="#4ade80"/>
                            <line x1="159" y1="35" x2="159" y2="95" stroke="#4ade80" stroke-width="1"/>

                            <!-- 라인 차트 -->
                            <rect x="210" y="10" width="180" height="130" fill="var(--bg-dark)" rx="4"/>
                            <text x="300" y="30" font-size="10" fill="var(--text-primary)" text-anchor="middle">라인 차트</text>
                            <polyline points="230,90 250,70 270,80 290,50 310,60 330,45 350,55 370,40"
                                      stroke="var(--claude-orange)" stroke-width="2" fill="none"/>
                            <circle cx="230" cy="90" r="3" fill="var(--claude-orange)"/>
                            <circle cx="290" cy="50" r="3" fill="var(--claude-orange)"/>
                            <circle cx="370" cy="40" r="3" fill="var(--claude-orange)"/>
                        </svg>
                        <div class="illustration-caption">차트 유형 비교</div>
                    </div>
                `,
                'period-selector': `
                    <div class="manual-illustration">
                        <svg viewBox="0 0 400 80">
                            <rect x="0" y="0" width="400" height="80" fill="var(--bg-dark)" rx="8"/>
                            <rect x="20" y="25" width="40" height="30" fill="var(--bg-light)" rx="4"/>
                            <text x="40" y="45" font-size="10" fill="var(--text-muted)" text-anchor="middle">1일</text>
                            <rect x="70" y="25" width="40" height="30" fill="var(--bg-light)" rx="4"/>
                            <text x="90" y="45" font-size="10" fill="var(--text-muted)" text-anchor="middle">1주</text>
                            <rect x="120" y="25" width="50" height="30" fill="var(--claude-orange)" rx="4"/>
                            <text x="145" y="45" font-size="10" fill="white" text-anchor="middle">1개월</text>
                            <rect x="180" y="25" width="50" height="30" fill="var(--bg-light)" rx="4"/>
                            <text x="205" y="45" font-size="10" fill="var(--text-muted)" text-anchor="middle">3개월</text>
                            <rect x="240" y="25" width="40" height="30" fill="var(--bg-light)" rx="4"/>
                            <text x="260" y="45" font-size="10" fill="var(--text-muted)" text-anchor="middle">1년</text>
                            <rect x="290" y="25" width="40" height="30" fill="var(--bg-light)" rx="4"/>
                            <text x="310" y="45" font-size="10" fill="var(--text-muted)" text-anchor="middle">전체</text>
                        </svg>
                        <div class="illustration-caption">기간 선택 버튼</div>
                    </div>
                `,
                'industry-analysis': `
                    <div class="manual-illustration">
                        <svg viewBox="0 0 400 180">
                            <rect x="0" y="0" width="400" height="180" fill="var(--bg-dark)" rx="8"/>
                            <!-- 바 차트 -->
                            <text x="30" y="30" font-size="9" fill="var(--text-muted)">넥슨</text>
                            <rect x="80" y="20" width="200" height="16" fill="var(--claude-orange)" rx="2"/>
                            <text x="290" y="32" font-size="9" fill="var(--text-primary)">45.2조</text>

                            <text x="30" y="60" font-size="9" fill="var(--text-muted)">엔씨소프트</text>
                            <rect x="80" y="50" width="120" height="16" fill="#60a5fa" rx="2"/>
                            <text x="210" y="62" font-size="9" fill="var(--text-primary)">27.1조</text>

                            <text x="30" y="90" font-size="9" fill="var(--text-muted)">크래프톤</text>
                            <rect x="80" y="80" width="150" height="16" fill="#4ade80" rx="2"/>
                            <text x="240" y="92" font-size="9" fill="var(--text-primary)">33.8조</text>

                            <text x="30" y="120" font-size="9" fill="var(--text-muted)">넷마블</text>
                            <rect x="80" y="110" width="80" height="16" fill="#a78bfa" rx="2"/>
                            <text x="170" y="122" font-size="9" fill="var(--text-primary)">18.2조</text>

                            <text x="30" y="150" font-size="9" fill="var(--text-muted)">펄어비스</text>
                            <rect x="80" y="140" width="50" height="16" fill="#f472b6" rx="2"/>
                            <text x="140" y="152" font-size="9" fill="var(--text-primary)">11.3조</text>
                        </svg>
                        <div class="illustration-caption">산업 내 시가총액 비교</div>
                    </div>
                `,
                'calendar-filter': `
                    <div class="manual-illustration">
                        <svg viewBox="0 0 300 150">
                            <rect x="0" y="0" width="300" height="150" fill="var(--bg-dark)" rx="8"/>
                            <text x="20" y="25" font-size="11" fill="var(--text-primary)" font-weight="600">이벤트 필터</text>

                            <!-- 체크박스들 -->
                            <rect x="20" y="40" width="16" height="16" fill="var(--claude-orange)" rx="2"/>
                            <text x="22" y="52" font-size="10" fill="white">✓</text>
                            <text x="45" y="52" font-size="10" fill="var(--text-primary)">실적 발표</text>

                            <rect x="20" y="65" width="16" height="16" fill="var(--bg-light)" rx="2" stroke="var(--border-color)"/>
                            <text x="45" y="77" font-size="10" fill="var(--text-muted)">배당</text>

                            <rect x="20" y="90" width="16" height="16" fill="#4ade80" rx="2"/>
                            <text x="22" y="102" font-size="10" fill="white">✓</text>
                            <text x="45" y="102" font-size="10" fill="var(--text-primary)">게임 출시</text>

                            <rect x="20" y="115" width="16" height="16" fill="#a78bfa" rx="2"/>
                            <text x="22" y="127" font-size="10" fill="white">✓</text>
                            <text x="45" y="127" font-size="10" fill="var(--text-primary)">IR 행사</text>
                        </svg>
                        <div class="illustration-caption">이벤트 필터 옵션</div>
                    </div>
                `
            };

            return illustrations[type] || '';
        }

        // 초기화
        initChart();
        initResizers();
        initChartSearch();
        initPeriodSelector();
    </script>
</body>
</html>
